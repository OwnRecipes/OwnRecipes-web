"use strict";(self.webpackChunkownrecipes_web=self.webpackChunkownrecipes_web||[]).push([[252],{1418:function(e,n,r){r.d(n,{Z:function(){return t}});var i=r(2791);function t(e,n){(0,i.useEffect)((function(){null==n&&e()}),[e,n])}},7080:function(e,n,r){r.r(n),r.d(n,{default:function(){return Xe}});var i=r(4165),t=r(5861),a=r(2791),o=r(6871),l=r(3539),s=r(6221),u=r(5208),c=r(9656),d=r(1413),p=r(9795),f=r(7022),m=r(9743),h=r(2677),v=r(3720),g=(r(3541),r(63)),b=r(1418),x=r(1884),Z=r(557),j=r(6699),_=r(6844),C=r(184),y=["parser","formatter","name","required","isMulti","onFocus","onBlur"],w=(0,a.forwardRef)((function(e,n){var r=e.parser,i=e.formatter,t=e.name,o=e.required,s=e.isMulti,u=e.onFocus,c=e.onBlur,p=(0,Z.Z)(e,y),f=(0,l.Z)(),m=(0,a.useCallback)((function(e){return null==e?s?[]:void 0:i(e)}),[i,s]);return(0,C.jsx)(v.gN,{name:t,validate:o?j.np:void 0,validateFields:[],children:function(e){return(0,C.jsx)(_.a,(0,d.Z)((0,d.Z)({},p),{},{isMulti:s,required:o,name:e.input.name,value:m(e.input.value),errors:(0,j.fr)(f,e.meta.error||(e.meta.dirtySinceLastSubmit?void 0:e.meta.submitError)),meta:e.meta,onChange:function(n,i){e.input.onChange(r(i))},onFocus:function(n){e.input.onFocus(n),null===u||void 0===u||u(n)},onBlur:function(n){e.input.onBlur(n),null===c||void 0===c||c(n)},ref:n}))}})})),S=function(e){var n=e.name,r=e.label,i=(0,l.Z)(),t=(0,c.I0)(),o=(0,a.useCallback)((function(){return t(g.fetchTags())}),[t,u]),s=(0,c.v9)((function(e){return e.recipeGroups.tags.items}));(0,b.Z)(o,s);var d=(0,a.useMemo)((function(){return null===s||void 0===s?void 0:s.filter((function(e){return e.title.length>0})).map((function(e){return{value:e.title,label:(0,x.kT)(i,"tag.",e.title)}})).sort(x.hF)}),[s,i.locale]),p=(0,a.useCallback)((function(e){if(null!=e){var n=[];return e.forEach((function(e){var r=null===s||void 0===s?void 0:s.find((function(n){return n.title===e}));n.push(null!==r&&void 0!==r?r:{title:e})})),n}}),[s]),f=(0,a.useCallback)((function(e){return Array.isArray(e)?e.map((function(e){return e.title})):e.title}),[]);return(0,C.jsx)(w,{name:n,label:r,data:d,parser:p,formatter:f,isMulti:!0})},k=function(e){var n=e.name,r=e.label,i=(0,l.Z)(),t=(0,c.I0)(),o=(0,a.useCallback)((function(){return t(g.fetchCourses())}),[t,g]),s=(0,c.v9)((function(e){return e.recipeGroups.courses.items}));(0,b.Z)(o,s);var u=(0,a.useMemo)((function(){return null===s||void 0===s?void 0:s.map((function(e){return{value:e.title,label:(0,x.kT)(i,"course.",e.title)}})).sort(x.hF)}),[s,i.locale]),d=(0,a.useCallback)((function(e){var n;if(null!=e)return null!==(n=null===s||void 0===s?void 0:s.find((function(n){return n.title===e})))&&void 0!==n?n:{title:e}}),[s]),p=(0,a.useCallback)((function(e){return Array.isArray(e)?e.map((function(e){return e.title})):e.title}),[]);return(0,C.jsx)(w,{name:n,label:r,data:u,parser:d,formatter:p})},M=function(e){var n=e.name,r=e.label,i=(0,l.Z)(),t=(0,c.I0)(),o=(0,a.useCallback)((function(){return t(g.fetchCuisines())}),[t,u]),s=(0,c.v9)((function(e){return e.recipeGroups.cuisines.items}));(0,b.Z)(o,s);var d=(0,a.useMemo)((function(){return null===s||void 0===s?void 0:s.map((function(e){return{value:e.title,label:(0,x.kT)(i,"cuisine.",e.title)}})).sort(x.hF)}),[s,i.locale]),p=(0,a.useCallback)((function(e){var n;if(null!=e)return null!==(n=null===s||void 0===s?void 0:s.find((function(n){return n.title===e})))&&void 0!==n?n:{title:null!==e&&void 0!==e?e:""}}),[s]),f=(0,a.useCallback)((function(e){return Array.isArray(e)?e.map((function(e){return e.title})):e.title}),[]);return(0,C.jsx)(w,{name:n,label:r,data:d,parser:p,formatter:f})},N=r(5671),T=r(3144),E=r(136),R=r(2269),F=r(3360),L=r(297),q=r(7251),G=["isNew","submitting","pristine","onSubmit","onLink"],P=(0,s.vU)({submit:{id:"recipe.create.submit",description:"Submit recipe button",defaultMessage:"Submit recipe"},view:{id:"recipe.create.view",description:"View recipe button",defaultMessage:"View"}}),I=(0,a.forwardRef)((function(e,n){var r=e.isNew,i=e.submitting,t=e.pristine,o=e.onSubmit,s=e.onLink,u=(0,Z.Z)(e,G),c=(0,l.Z)().formatMessage,p=!r&&t,f=(0,a.useCallback)((function(){p?s():o()}),[p,s,o]);return(0,C.jsxs)(F.Z,(0,d.Z)((0,d.Z)({variant:"primary",type:p?"button":"submit",disabled:(0,x.s6)()&&!p,onClick:f,accessKey:p?void 0:"s"},u),{},{className:i?"disabled":void 0,ref:n,children:[(0,C.jsx)("span",{style:{visibility:i?"hidden":"initial"},children:c(p?P.view:P.submit)}),i&&(0,C.jsx)(q.Z,{style:{position:"absolute",color:"var(--primaryText)"}})]}))})),A=(0,a.forwardRef)((function(e,n){return(0,C.jsx)(v.lP,{subscription:{pristine:!0,submitting:!0},children:function(e){var r=e.submitting;return(0,C.jsx)(D,{submitting:r,ref:n})}})})),D=function(e){(0,E.Z)(r,e);var n=(0,R.Z)(r);function r(){return(0,N.Z)(this,r),n.apply(this,arguments)}return(0,T.Z)(r,[{key:"getSubmitting",value:function(){return this.props.submitting}},{key:"render",value:function(){return null}}]),r}(a.Component),U=function(){var e,n,r=(0,o.s0)(),i=(0,c.I0)(),t=(0,c.v9)((function(e){return e.recipeForm})),l=(0,a.useCallback)((function(){t.item&&i(L.MA(t.item))}),[i,t.item]),s=(0,a.useCallback)((function(){var e;return r((0,x.qC)("/recipe/".concat(null===(e=t.item)||void 0===e?void 0:e.slug)))}),[null===(e=t.item)||void 0===e?void 0:e.slug]),u=null===(n=t.item)||void 0===n?void 0:n.id,d=null==u||0===u;return(0,C.jsx)(v.lP,{subscription:{pristine:!0,submitting:!0},children:function(e){var n=e.pristine,r=e.submitting;return(0,C.jsx)(I,{isNew:d,pristine:n,submitting:r,onSubmit:l,onLink:s})}})},B=r(7547),O=r(6623),V=r(9854),W=r(7847),H=r(2265),K=r(885),Y=r(6956),z=r(9377),X=r(9410),J=r(9276),Q=r(78),$=r(4858),ee=r(6944),ne=["accept","value","onChange","name","style","tooltip","readOnly","disabled","label","className","helpText","errors","meta"],re=function(e){(0,E.Z)(r,e);var n=(0,R.Z)(r);function r(){var e;(0,N.Z)(this,r);for(var i=arguments.length,t=new Array(i),o=0;o<i;o++)t[o]=arguments[o];return(e=n.call.apply(n,[this].concat(t))).ref=(0,a.createRef)(),e.handleChange=function(n){var r,i,t;null===(r=(i=e.props).onChange)||void 0===r||r.call(i,n.target.name,null===n||void 0===n||null===(t=n.target.files)||void 0===t?void 0:t[0])},e.handleClear=function(){e.props.onChange&&(e.props.onChange(e.props.name,""),e.clearValue())},e}return(0,T.Z)(r,[{key:"clearValue",value:function(){null!=this.ref&&this.ref.current&&(this.ref.current.value="")}},{key:"focus",value:function(){return!(null==this.ref||!this.ref.current)&&(this.ref.current.focus(),!0)}},{key:"render",value:function(){var e=this.props,n=e.accept,r=e.value,i=e.onChange,t=e.name,a=e.style,o=e.tooltip,l=e.readOnly,s=e.disabled,u=(e.label,e.className,e.helpText,e.errors,e.meta,(0,Z.Z)(e,ne));return(0,C.jsx)(p.Z.Group,(0,d.Z)((0,d.Z)({},this.getGroupProps()),{},{controlId:t,className:this.getFormGroupClassNames(),style:a,children:(0,C.jsxs)(J.Z,{condition:null!=o,render:function(e){return(0,C.jsx)($.Z,{id:"".concat(t,"-tooltip"),tooltip:o,children:e})},children:[this.getLabel(),this.getHelpText(),this.getErrorMessage(),(0,C.jsxs)(X.Z,{children:[(0,C.jsx)(p.Z.Control,(0,d.Z)((0,d.Z)({type:"file",name:t,accept:n,readOnly:l,disabled:s,onChange:this.handleChange},u),{},{ref:this.ref})),!l&&!s&&i&&(r||null!=this.ref.current&&this.ref.current.value)&&(0,C.jsx)(X.Z.Text,{className:"input-adornment-end button",children:(0,C.jsx)(F.Z,{onClick:this.handleClear,children:(0,C.jsx)(Q.Z,{icon:"x",variant:"light",size:"2x"})})})]})]})}))}}]),r}(ee.Z),ie=re,te=["name","required","onChange","onFocus","onBlur"],ae=function(e){return e},oe=(0,a.forwardRef)((function(e,n){var r=e.name,i=e.required,t=e.onChange,a=e.onFocus,o=e.onBlur,s=(0,Z.Z)(e,te),u=(0,l.Z)();return(0,C.jsx)(v.gN,{name:r,validate:i?j.np:void 0,validateFields:[],parse:ae,children:function(e){var r;return(0,C.jsx)(ie,(0,d.Z)((0,d.Z)({},s),{},{required:i,name:e.input.name,value:null!==(r=e.input.value)&&void 0!==r&&r,errors:(0,j.fr)(u,e.meta.error||(e.meta.dirtySinceLastSubmit?void 0:e.meta.submitError)),meta:e.meta,onChange:function(n,r){e.input.onChange(r),null===t||void 0===t||t(n,r)},onFocus:function(n){e.input.onFocus(n),null===a||void 0===a||a(n)},onBlur:function(n){e.input.onBlur(n),null===o||void 0===o||o(n)},ref:n}))}})})),le=r(7092),se=(0,s.vU)({photo_label:{id:"recipe.create.photo_label",description:"Photo label",defaultMessage:"Photo"}}),ue=function(){var e=(0,l.Z)().formatMessage,n=(0,o.TH)().key,r=(0,a.useRef)(null),i=(0,a.useState)(void 0),t=(0,K.Z)(i,2),s=t[0],u=t[1],c=(0,a.useMemo)((function(){return(0,x.uS)()}),[]);(0,a.useEffect)((function(){r.current&&r.current.clearValue(),u(void 0)}),[n]);var d=(0,a.useCallback)((function(e,n){u(n?URL.createObjectURL(n):"")}),[]),p=(0,a.useCallback)((function(e){return null!=s?s.length>0?s:(0,x.uS)():(0,x.eE)(e||c)}),[s,c]);return(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(m.Z,{children:(0,C.jsx)(h.Z,{xs:12,lg:11,xl:10,xxl:9,style:{marginLeft:"auto",marginRight:"auto"},children:(0,C.jsx)(Y.Z,{height:66.67,width:100,children:(0,C.jsx)(le.Z,{fieldNames:["photo"],children:function(e){return(0,C.jsx)(z.Z,{src:p(e.photo),alt:"",style:{objectFit:"contain"}})}})})})}),(0,C.jsx)(m.Z,{children:(0,C.jsx)(h.Z,{xs:12,children:(0,C.jsx)(oe,{name:"photo",label:e(se.photo_label),accept:"image/*",onChange:d,ref:r})})})]})},ce=r(4421),de=r(4999),pe=r(7556);function fe(e){var n,r=e.indexOf("."),i=e.indexOf(",");return n=-1===r&&-1===i?e:-1===r?e.replace(",","."):-1===i?e:r<i?(n=e.replace(".","")).replace(",","."):e.replace(",",""),parseFloat(n)}var me=function(e){var n=-1,r=e.length;return["1","2","3","4","5","6","7","8","9","0"].forEach((function(r){e.lastIndexOf(r)>n&&(n=e.lastIndexOf(r))})),r===n+1?{amount:e,rest:""}:{amount:e.substring(0,n+1),rest:e.substring(n+1,r)}},he=function(e){return e.normalize("NFKD").split("\u2044")},ve=function(e,n){var r,i,t=n.split(" "),a=[],o=!1;for(i=0;i<t.length-1;++i){var l=t[i];if(0!==l.length){var s=o?[]:he(l[0]);if(o||Number.isNaN(parseInt(l[0]))){if(o||!s[1]){o=!0,(r=e[l.toLocaleLowerCase()])&&++i;break}if(o=!0,a.push("".concat(s[0],"/").concat(s[1])),l.length>1){(r=e[l.substring(1).toLocaleLowerCase()])&&++i;break}}else{var u=me(l),c=u.amount,d=u.rest;if(a.push(c),d){var p=he(d[0]);if(p[1]){if(o=!0,a.push("".concat(p[0],"/").concat(p[1])),!(d.length>1))continue;d=d.substring(1)}if(r=e[d.toLocaleLowerCase()]){++i;break}}a.length>=2&&(o=!0)}}}var f=function(e){var n=e.reduce((function(e,n){var r=n.split("/"),i=fe(r[0]),t=r.length>1?fe(r[1]):1;if(0===e.denominator)return{numerator:i,denominator:t};if(1===r.length){i*=e.numerator,t*=e.denominator;var a=(0,pe.b)(i,t);return{numerator:i/a,denominator:t/a}}i=e.numerator*t+e.denominator*i,t*=e.denominator;var o=(0,pe.b)(i,t);return{numerator:i/o,denominator:t/o}}),{numerator:0,denominator:0});return{numerator:n.numerator,denominator:n.denominator}}(a),m=f.numerator;return{numerator:0===m?void 0:m,denominator:f.denominator,measurement:r,title:t.slice(i).join(" ")}},ge=r(4349),be=r(6914),xe=(r(1534),["value","rows","onChange","name","style","tooltip","label","className","helpText","errors","meta"]),Ze=function(){return(0,C.jsx)("div",{className:"loading",children:"Loading..."})},je=function(e){(0,E.Z)(r,e);var n=(0,R.Z)(r);function r(){var e;(0,N.Z)(this,r);for(var i=arguments.length,t=new Array(i),o=0;o<i;o++)t[o]=arguments[o];return(e=n.call.apply(n,[this].concat(t))).ref=(0,a.createRef)(),e}return(0,T.Z)(r,[{key:"focus",value:function(){return!(null==this.ref||!this.ref.current)&&(this.ref.current.focus(),!0)}},{key:"getLabel",value:function(){return null==this.props.label?null:this.props.tooltip?(0,C.jsxs)(C.Fragment,{children:[this.props.label,"\xa0",(0,C.jsx)(Q.Z,{icon:"info-circle",className:"tooltip-icon"})]}):this.props.label}},{key:"render",value:function(){var e=this.props,n=e.value,r=void 0===n?"":n,i=e.rows,t=void 0===i?4:i,a=(e.onChange,e.name),o=e.style,l=e.tooltip,s=(e.label,e.className,e.helpText,e.errors,e.meta,(0,Z.Z)(e,xe));return(0,C.jsx)(p.Z.Group,(0,d.Z)((0,d.Z)({},this.getGroupProps()),{},{controlId:a,className:this.getFormGroupClassNames(),style:o,children:(0,C.jsxs)(J.Z,{condition:null!=l,render:function(e){return(0,C.jsx)($.Z,{id:"".concat(a,"-tooltip"),tooltip:l,children:e})},children:[this.getLabel(),this.getHelpText(),this.getErrorMessage(),(0,C.jsx)(X.Z,{children:(0,C.jsx)(be.Z,(0,d.Z)((0,d.Z)({name:a,value:r,rows:t,loadingComponent:Ze,className:"form-control",movePopupAsYouType:!0,onChange:this.handleChange},s),{},{ref:this.ref}))})]})}))}}]),r}(ee.Z),_e=["name","required","format","parse","onChange","onFocus","onBlur"],Ce=(0,a.forwardRef)((function(e,n){var r=e.name,i=e.required,t=e.format,o=e.parse,s=e.onChange,u=e.onFocus,c=e.onBlur,p=(0,Z.Z)(e,_e),f=(0,l.Z)(),m=(0,a.useMemo)((function(){var e=[];return i&&e.push(j.np),j.A3.apply(void 0,e)}),[i]);return(0,C.jsx)(v.gN,{name:r,validate:m,validateFields:[],format:t,parse:o,children:function(e){return(0,C.jsx)(je,(0,d.Z)((0,d.Z)({},p),{},{required:i,name:e.input.name,value:e.input.value,errors:(0,j.fr)(f,e.meta.error||(e.meta.dirtySinceLastSubmit?void 0:e.meta.submitError)),meta:e.meta,onChange:function(n,r){e.input.onChange(r),null===s||void 0===s||s(n,r)},onFocus:function(n){e.input.onFocus(n),null===u||void 0===u||u(n)},onBlur:function(n){e.input.onBlur(n),null===c||void 0===c||c(n)},ref:n}))}})})),ye=r(6689),we=r(1694),Se=r.n(we),ke=r(1734),Me=r(9485),Ne=(0,s.vU)({preview:{id:"recipe.create.preview",description:"Preview",defaultMessage:"Preview"}}),Te=function(e){var n=e.id,r=e.labels,i=e.errors,t=e.tooltips,o=e.initialTab,s=e.activeTab,u=e.onSelect,c=e.children,d=(0,l.Z)().formatMessage,p=Se()("content",{"has-error":!!i}),f=Se()("nav","nav-tabs",{"has-error":!!i}),m=c.slice(0,c.length-1).map((function(e,n){return(0,C.jsx)(ke.Z,{title:(0,C.jsxs)(C.Fragment,{children:[r[n],(null===t||void 0===t?void 0:t[n])&&(0,C.jsxs)(C.Fragment,{children:["\xa0",(0,C.jsx)($.Z,{id:"".concat(r[n],"-tooltip"),tooltip:t[n],children:(0,C.jsx)(Q.Z,{icon:"info-circle",className:"tooltip-icon","aria-label":t[n],"aria-describedby":void 0})})]})]}),eventKey:n.toString(),className:"editor",children:(0,C.jsx)("div",{className:p,children:e})},n.toString())})),h=(0,a.useCallback)((function(e){e&&(null===u||void 0===u||u(e))}),[u]);return(0,C.jsxs)("div",{className:"live-editor",children:[(0,C.jsxs)(Me.Z,{id:"".concat(n,"-tabs"),defaultActiveKey:o||"0",activeKey:s,onSelect:h,className:f,children:[m,(0,C.jsx)(ke.Z,{title:d(Ne.preview),className:"preview",eventKey:"preview",children:(0,C.jsx)("div",{className:p,children:c[c.length-1]})})]}),(0,C.jsx)("div",{className:"help-text error",children:i})]})},Ee=(0,s.vU)({ingredients_label:{id:"recipe.create.ingredients_label",description:"Recipe ingredients label",defaultMessage:"Ingredients"},ingredients_tooltip:{id:"recipe.create.ing.info_desc",description:"info_desc",defaultMessage:'Each Ingredient should be on its own line. You can form groups by ending the groups first line with a colon (":").'},ingredients_placeholder:{id:"recipe.create.ing.ingredients_placeholder",description:"Example for writing ingredients",defaultMessage:"Dough:\n300 g flour\n100 ml milk\n\nDip:\n100 ml olive oil\n..."},subrecipes_label:{id:"recipe.create.subrecipes_label",description:"Recipe links label",defaultMessage:"Recipe links"},subrecipes_tooltip:{id:"recipe.create.subrecipes.tooltip",description:"Subrecipes tooltip",defaultMessage:"If the recipe is made of several subrecipes, then link them here. Each Recipe Link should be on its own line."},subrecipes_placeholder:{id:"recipe.create.subrecipes.placeholder",description:"Subreceipes placeholder",defaultMessage:":dough-1\n:olive-oil-dip-1"}});function Re(e){var n=e.replace(/\t/g," ");return n=n.trim()}function Fe(e,n,r){var i="";return r&&r.filter((function(e){return e.title.trim().length>0||e.ingredients.length>0})).forEach((function(r){r.title&&(i+="".concat(r.title,":\n")),r.ingredients.forEach((function(r){var t=r.measurement?n[r.measurement]:"";i+=r.numerator?"".concat((0,de.Z)(1,1,r.numerator,r.denominator)," "):"",i+=t?"".concat(e.formatMessage({id:"measurement.".concat(t.toLocaleLowerCase())},{itemCount:r.numerator})," "):"",i+="".concat(r.title,"\n")})),i+="\n"})),i.endsWith("\n")?i.substring(0,i.length-2):i}function Le(e,n){var r;if(!n)return[];var i=[{slug:"default",title:"",ingredients:[]}],t="",a=null===(r=i.find((function(e){return""===e.title})))||void 0===r?void 0:r.ingredients;if(null==a)throw new Error("Invalid state: ings may not be null.");n&&n.split("\n").map(Re).filter((function(e){return e.length>0})).forEach((function(n){if(n.length>0)if(n.endsWith(":")&&n.length>1){var r;if(t=n.substring(0,n.length-1),i.push({slug:(0,x.lV)(t),title:t,ingredients:[]}),null==(a=null===(r=i.find((function(e){return e.title===t})))||void 0===r?void 0:r.ingredients))throw new Error("Invalid state: The create ings may not be null.")}else{if(null==a)throw new Error("Invalid state: ings may not be null.");a.push(ve(e,n))}}));return i}function qe(e,n,r){var i="";return r&&r.forEach((function(r){var t=r.measurement?n[r.measurement]:"";i+=r.numerator?"".concat((0,de.Z)(1,1,r.numerator,r.denominator)," "):"",i+=t?"".concat(e.formatMessage({id:"measurement.".concat(t.toLocaleLowerCase())},{itemCount:r.numerator})," "):"",i+="".concat(r.title,"\n")})),i.substring(0,i.length-1)}function Ge(e,n){if(!n)return[];var r=[];return n.split("\n").map(Re).filter((function(e){return e.length>1&&!e.startsWith(":")})).forEach((function(n){n.length>0&&r.push(ve(e,n))})),r}var Pe=function(e){var n=e.entity.char;return(0,C.jsx)("div",{children:n})},Ie=function(e){var n=e.igData,r=e.srData,i=(0,a.useMemo)((function(){return e=function(e){var n=(0,de.Z)(1,1,e.numerator,e.denominator);return(0,d.Z)((0,d.Z)({},e),{},{quantity:n})},n.map((function(n){return(0,d.Z)((0,d.Z)({},n),{},{ingredients:n.ingredients.map(e)})}));var e}),[n]),t=(0,a.useMemo)((function(){return r.map((function(e){var n=(0,de.Z)(1,1,e.numerator,e.denominator);return(0,d.Z)((0,d.Z)({},e),{},{quantity:n})}))}),[n]);return(0,C.jsx)("div",{className:"recipe-details",children:(0,C.jsx)("div",{className:"recipe-schema",children:(0,C.jsx)("article",{className:"ingredients-panel",children:(0,C.jsxs)("div",{className:"ingredient-groups",children:[(0,C.jsx)(ge.Z,{subRecipes:t}),(0,C.jsx)(ce.Z,{groups:i,hasSubrecipes:r.length>0})]})})})})},Ae=function(e){var n=e.nameIg,r=e.nameSub,i=e.fetchRecipeList,t=(0,l.Z)(),s=t.formatMessage,u=(0,o.TH)(),c=(0,a.useState)("0"),d=(0,K.Z)(c,2),p=d[0],f=d[1];(0,a.useEffect)((function(){u.pathname.endsWith("/".concat(ye.r2))&&f("0")}),[u.pathname]);var m=(0,a.useContext)(W.Z),h=(0,a.useCallback)((function(e,i){return!0===(null===i||void 0===i?void 0:i[n])&&null!=(null===e||void 0===e?void 0:e[n])?(0,j.fr)(t,null===e||void 0===e?void 0:e[n]):null!==i&&void 0!==i&&i[r]&&null!=(null===e||void 0===e?void 0:e[r])?(0,j.fr)(t,null===e||void 0===e?void 0:e[r]):void 0}),[t]);return(0,C.jsx)(v.lP,{subscription:{errors:!0,touched:!0,initialValues:!0},children:function(e){var t=e.errors,a=e.touched,o=e.initialValues;return(0,C.jsxs)(Te,{id:"ingredients",labels:[s(Ee.ingredients_label),s(Ee.subrecipes_label)],activeTab:p,onSelect:f,errors:h(t,a),tooltips:[s(Ee.ingredients_tooltip),s(Ee.subrecipes_tooltip)],children:[(0,C.jsx)(le.Z,{fieldNames:[r],children:function(e){return(0,C.jsx)(B.Z,{name:n,rows:8,placeholder:s(Ee.ingredients_placeholder),required:o&&!e[r]})}}),(0,C.jsx)("div",{className:"form-group",children:(0,C.jsx)(Ce,{name:r,rows:8,placeholder:s(Ee.subrecipes_placeholder),trigger:{":":{dataProvider:function(e){return i(e)},component:Pe,output:function(e){return e.char}}}})}),(0,C.jsx)(le.Z,{fieldNames:[n,r],children:function(e){return(0,C.jsx)(C.Fragment,{children:"preview"===p&&(0,C.jsx)(Ie,{igData:Le(m.parser,e[n]),srData:Ge(m.parser,e[r])})})}})]})}})},De=r(9024),Ue=(0,s.vU)({directions_label:{id:"recipe.create.directions_label",description:"Directions label",defaultMessage:"Directions"},directions_tooltip:{id:"recipe.create.dir.tooltip",description:"Directions Tooltip",defaultMessage:'Each Direction should be on its own line. You can form chapters by ending the chapters heading with a colon (":").'},directions_placeholder:{id:"recipe.create.dir.placeholder",description:"Directions Placeholder",defaultMessage:"Dough:\nPrepare the dough.\n\nDip:\nPrepare the dip.\n..."}}),Be=function(e){var n=e.directions,r=e.ingredients,i=(0,a.useMemo)((function(){return e=function(e){var n=(0,de.Z)(1,1,e.numerator,e.denominator);return(0,d.Z)((0,d.Z)({},e),{},{quantity:n})},r.map((function(n){return(0,d.Z)((0,d.Z)({},n),{},{ingredients:n.ingredients.map(e)})}));var e}),[r]),t=n.includes(":\n");return(0,C.jsx)("div",{className:"recipe-details",children:(0,C.jsx)("div",{className:"recipe-schema",children:(0,C.jsx)("article",{className:Se()("directions-panel",{"multi-directions":t}),children:(0,C.jsx)("div",{className:"direction-groups",children:(0,C.jsx)(De.Z,{directions:n,ingredients:i})})})})})},Oe=function(e){var n=e.name,r=(0,l.Z)(),i=r.formatMessage,t=(0,a.useContext)(W.Z),s=(0,o.TH)(),u=(0,a.useState)("0"),c=(0,K.Z)(u,2),d=c[0],p=c[1];return(0,a.useEffect)((function(){s.pathname.endsWith("/".concat(ye.r2))&&p("0")}),[s.pathname]),(0,C.jsx)(v.lP,{subscription:{errors:!0},children:function(e){var a=e.errors;return(0,C.jsxs)(Te,{id:"directions",labels:[i(Ue.directions_label)],activeTab:d,onSelect:p,errors:(0,j.fr)(r,null===a||void 0===a?void 0:a[n]),tooltips:[i(Ue.directions_tooltip)],children:[(0,C.jsx)(B.Z,{name:n,rows:8,placeholder:i(Ue.directions_placeholder)}),(0,C.jsx)(le.Z,{fieldNames:[n,"ingredientGroupsS"],children:function(e){var r;return(0,C.jsx)(C.Fragment,{children:"preview"===d&&(0,C.jsx)(Be,{directions:null!==(r=e[n])&&void 0!==r?r:"",ingredients:Le(t.parser,e.ingredientGroupsS)})})}})]})}})},Ve=(0,s.vU)({name_label:{id:"recipe.create.name_label",description:"Recipe name label",defaultMessage:"Recipe name"},course_label:{id:"recipe.create.course_label",description:"Course label",defaultMessage:"Course"},cuisine_label:{id:"recipe.create.cuisine_label",description:"Cuisine label",defaultMessage:"Cuisine"},tags_label:{id:"recipe.create.tags_label",description:"Tags label",defaultMessage:"Tags"},prep_time_label:{id:"recipe.create.prep_time_label",description:"Prep time label",defaultMessage:"Prep time (min)"},cooking_time_label:{id:"recipe.create.cooking_time_label",description:"Cooking time label",defaultMessage:"Cooking time (min)"},servings_label:{id:"recipe.create.servings_label",description:"Servings label",defaultMessage:"Servings"},information_label:{id:"recipe.create.information_label",description:"Recipe information label",defaultMessage:"Recipe information"},information_placeholder:{id:"recipe.create.information_placeholder",description:"Recipe information placeholder",defaultMessage:"A quick description of the recipe"},source_label:{id:"recipe.create.source_label",description:"Rating source label",defaultMessage:"Source"},source_tooltip:{id:"recipe.create.source_tooltip",description:"Rating source tooltip",defaultMessage:"Where the original recipe is from."},public_label:{id:"recipe.create.public_label",description:"Recipe set public label",defaultMessage:"Public Recipe"}}),We=function(e){var n=e.recipe,r=e.isNew,i=e.location,t=e.fetchRecipeList,o=e.onSubmit,s=(0,l.Z)(),u=s.formatMessage,c=(0,a.useContext)(W.Z),g=(0,a.useRef)(null),b=(0,a.useCallback)((function(e){var n;return null!==(n=g.current)&&void 0!==n&&n.getSubmitting()?Promise:o((0,d.Z)((0,d.Z)({},e),{},{ingredientGroups:Le(c.parser,e.ingredientGroupsS),subrecipes:Ge(c.parser,e.subrecipesS)}))}),[c.parser,g.current]),x=(0,a.useMemo)((function(){return r&&!n?{slug:"",public:!0,servings:1}:n?(0,d.Z)((0,d.Z)({},n),{},{ingredientGroupsS:Fe(s,c.formatter,n.ingredientGroups),subrecipesS:qe(s,c.formatter,n.subrecipes)}):void 0}),[n,r,i]);return(0,C.jsx)(v.l0,{initialValues:x,onSubmit:b,subscription:{submitting:!0},render:function(e){var n=e.form,r=e.handleSubmit;return(0,C.jsxs)(p.Z,{className:"recipe-form",onSubmit:r,children:[(0,C.jsx)(V.Z,{form:n,initialValues:x}),(0,C.jsx)(A,{ref:g}),(0,C.jsxs)(f.Z,{children:[(0,C.jsx)(H.Z,{}),(0,C.jsxs)(m.Z,{children:[(0,C.jsxs)(h.Z,{id:"recipe-meta",md:5,lg:4,children:[(0,C.jsx)(m.Z,{children:(0,C.jsx)(h.Z,{xs:12,children:(0,C.jsx)(B.Z,{name:"title",label:u(Ve.name_label),maxLength:250,required:!0})})}),(0,C.jsx)(ue,{}),(0,C.jsxs)(m.Z,{children:[(0,C.jsx)(h.Z,{xs:12,sm:6,children:(0,C.jsx)(k,{name:"course",label:u(Ve.course_label)})}),(0,C.jsx)(h.Z,{xs:12,sm:6,children:(0,C.jsx)(M,{name:"cuisine",label:u(Ve.cuisine_label)})}),(0,C.jsx)(h.Z,{xs:12,children:(0,C.jsx)(S,{name:"tags",label:u(Ve.tags_label)})})]}),(0,C.jsxs)(m.Z,{children:[(0,C.jsx)(h.Z,{xs:12,sm:6,children:(0,C.jsx)(B.Z,{name:"prepTime",type:"number",label:u(Ve.prep_time_label),min:1,max:999})}),(0,C.jsx)(h.Z,{xs:12,sm:6,children:(0,C.jsx)(B.Z,{name:"cookTime",type:"number",label:u(Ve.cooking_time_label)})})]}),(0,C.jsx)(m.Z,{children:(0,C.jsx)(h.Z,{xs:12,children:(0,C.jsx)(B.Z,{name:"servings",type:"number",label:u(Ve.servings_label),min:1,max:999,required:!0})})}),(0,C.jsx)(m.Z,{children:(0,C.jsx)(h.Z,{xs:12,children:(0,C.jsx)(B.Z,{name:"source",label:u(Ve.source_label),tooltip:u(Ve.source_tooltip)})})}),(0,C.jsx)(m.Z,{children:(0,C.jsx)(h.Z,{xs:12,children:(0,C.jsx)(O.Z,{name:"public",label:u(Ve.public_label)})})})]}),(0,C.jsxs)(h.Z,{id:"recipe",md:7,lg:8,children:[(0,C.jsx)(B.Z,{name:"info",rows:3,label:u(Ve.information_label),placeholder:u(Ve.information_placeholder)}),(0,C.jsx)(Ae,{nameIg:"ingredientGroupsS",nameSub:"subrecipesS",fetchRecipeList:t}),(0,C.jsx)(Oe,{name:"directions"}),(0,C.jsx)(U,{})]})]})]})]})}})},He=r(3976),Ke=r(5355),Ye=r(9511),ze=function(){var e,n=(0,o.UO)(),r=(0,o.s0)(),i=null!==(e=n.recipe)&&void 0!==e?e:"",t="create"===i,l=(0,c.v9)((function(e){return e.account})),s=(0,c.v9)((function(e){return e.recipeForm})),u=s.item,d=s.meta.pending,p=(0,a.useRef)(!1),f=l.item,m=null!=f&&(t||f.id===(null===u||void 0===u?void 0:u.author));(0,a.useEffect)((function(){null==f||d!==Ye.V.COMPLETED||null==u||m||r((0,x.qC)("/recipe/".concat(i)))}),[f,s,m]),(0,a.useEffect)((function(){null!=(null===u||void 0===u?void 0:u.slug)&&d===Ye.V.COMPLETED&&t&&p.current&&setTimeout((function(){r((0,x.qC)("/recipe/edit/".concat(u.slug)))}),250),p.current=!0}),[d]);var h=s.meta;return(0,a.useEffect)((function(){404===Ke.Z(h.error,"status")&&r((0,x.qC)("/NotFound"))}),[h.error]),null},Xe=function(){var e,n=(0,l.Z)().formatMessage,r=(0,s.vU)({new_recipe:{id:"recipe_form.new_recipe",description:"New Recipe documentTitle",defaultMessage:"New Recipe"}}),d=(0,c.I0)(),p=(0,o.UO)(),f=(0,o.TH)(),m=u.fetchRecipeList,h=(0,a.useCallback)(function(){var e=(0,t.Z)((0,i.Z)().mark((function e(n){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",u.save(d,n));case 1:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),[d]),v=null!==(e=p.recipe)&&void 0!==e?e:"",g="create"===v,b=(0,c.v9)((function(e){return e.recipeForm.item}));return(0,a.useEffect)((function(){v&&d(g?u.reset():u.load(v))}),[v,f.key]),(0,a.useEffect)((function(){return function(){d(u.reset())}}),[]),(0,C.jsxs)(He.Z,{title:g?n(r.new_recipe):null===b||void 0===b?void 0:b.title,children:[(0,C.jsx)(ze,{}),(0,C.jsx)(We,{recipe:b,isNew:g,location:f.key,fetchRecipeList:m,onSubmit:h})]})}},63:function(e,n,r){r.r(n),r.d(n,{fetchCourses:function(){return c},fetchCuisines:function(){return d},fetchTags:function(){return p}});var i=r(1413),t=r(7572),a=r(8263),o=r(7728),l=r(6879),s=r(1220),u=r(9656),c=function(){return function(e){e((0,i.Z)({},(0,u.s_)(s.pq,o.o.GET_START))),(0,t.WY)().get(a.m.course).then((function(n){e((0,i.Z)((0,i.Z)({},(0,u.s_)(s.pq,o.o.GET_SUCCESS)),{},{payload:n.body.results.filter((function(e){return"-"!==e.title})).map(l.Xi)}))})).catch((function(n){return e((0,t.S3)(n,s.pq))}))}},d=function(){return function(e){e((0,i.Z)({},(0,u.s_)(s.xv,o.o.GET_START))),(0,t.WY)().get(a.m.cuisine).then((function(n){e((0,i.Z)((0,i.Z)({},(0,u.s_)(s.xv,o.o.GET_SUCCESS)),{},{payload:n.body.results.filter((function(e){return"-"!==e.title})).map(l.dS)}))})).catch((function(n){return e((0,t.S3)(n,s.xv))}))}},p=function(){return function(e){e((0,i.Z)({},(0,u.s_)(s.ic,o.o.GET_START))),(0,t.WY)().get(a.m.tag).then((function(n){e((0,i.Z)((0,i.Z)({},(0,u.s_)(s.ic,o.o.GET_SUCCESS)),{},{payload:n.body.results.map(l.uk)}))})).catch((function(n){return e((0,t.S3)(n,s.ic))}))}}}}]);
//# sourceMappingURL=252.cad28cf9.chunk.js.map