"use strict";(self.webpackChunkownrecipes_web=self.webpackChunkownrecipes_web||[]).push([[343],{7411:function(e,n,r){r.d(n,{Z:function(){return j}});var t=r(1413),i=r(557),o=r(2791),s=r(3720),a=r(3539),l=r(6699),u=r(5671),c=r(3144),p=r(136),d=r(2269),f=r(9795),h=r(9089),m=r(2153),v=r(9276),g=r(78),b=r(184),Z=function(e){(0,p.Z)(r,e);var n=(0,d.Z)(r);function r(){var e;(0,u.Z)(this,r);for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];return(e=n.call.apply(n,[this].concat(i))).ref=(0,o.createRef)(),e.handleChange=function(){e.props.readOnly||e.props.disabled||e.props.onChange&&e.props.onChange(e.props.name,!e.props.value)},e}return(0,c.Z)(r,[{key:"focus",value:function(){return!(null==this.ref||!this.ref.current)&&(this.ref.current.focus(),!0)}},{key:"getLabel",value:function(){return null==this.props.label?null:this.props.tooltip?(0,b.jsxs)(b.Fragment,{children:[this.props.label,"\xa0",(0,b.jsx)(g.Z,{icon:"info-circle",className:"tooltip-icon"})]}):this.props.label}},{key:"render",value:function(){var e=this;return(0,b.jsx)(f.Z.Group,{controlId:this.props.name,className:this.getFormGroupClassNames(),children:(0,b.jsxs)(v.Z,{condition:null!=this.props.tooltip,render:function(n){return(0,b.jsx)(m.Z,{id:"".concat(e.props.name,"-tooltip"),tooltip:e.props.tooltip,children:n})},children:[this.getHelpText(),this.getErrorMessage(),(0,b.jsx)(f.Z.Check,{name:this.props.name,checked:this.props.value,label:this.getLabel(),required:this.props.required,readOnly:this.props.readOnly,autoComplete:this.props.autoComplete,autoFocus:this.props.autoFocus,onChange:this.handleChange,onBlur:this.props.onBlur,onFocus:this.props.onFocus,ref:this.ref})]})})}}]),r}(h.Z),x=["name","required","format","parse","onChange","onFocus","onBlur"],j=(0,o.forwardRef)((function(e,n){var r=e.name,o=e.required,u=e.format,c=e.parse,p=e.onChange,d=e.onFocus,f=e.onBlur,h=(0,i.Z)(e,x),m=(0,a.Z)();return(0,b.jsx)(s.gN,{name:r,validate:o?l.np:void 0,validateFields:[],format:u,parse:c,children:function(e){var r;return(0,b.jsx)(Z,(0,t.Z)((0,t.Z)({},h),{},{required:o,name:e.input.name,value:null!==(r=e.input.value)&&void 0!==r&&r,errors:(0,l.fr)(m,e.meta.error||(e.meta.dirtySinceLastSubmit?void 0:e.meta.submitError)),meta:e.meta,onChange:function(n,r){e.input.onChange(r),null===p||void 0===p||p(n,r)},onFocus:function(n){e.input.onFocus(n),null===d||void 0===d||d(n)},onBlur:function(n){e.input.onBlur(n),null===f||void 0===f||f(n)},ref:n}))}})}))},1418:function(e,n,r){r.d(n,{Z:function(){return i}});var t=r(2791);function i(e,n){(0,t.useEffect)((function(){null==n&&e()}),[e,n])}},4348:function(e,n,r){r.r(n),r.d(n,{default:function(){return Pe}});var t=r(4165),i=r(5861),o=r(2791),s=r(6871),a=r(6221),l=r(3539),u=r(5208),c=r(9656),p=r(1413),d=r(9795),f=r(7022),h=r(9743),m=r(2677),v=r(3720),g=(r(3541),r(63)),b=r(1418),Z=r(1884),x=r(557),j=r(6699),C=r(2982),_=r(5671),y=r(3144),w=r(136),S=r(2269),M=r(1694),F=r.n(M),N=r(5038),k=r(9089),E=r(9276),T=r(2153),R=r(184),L=function(e){return!!e};function q(e,n){return Array.isArray(n)?e.filter((function(e){return n.includes(e.value)})):null!==(r=e.find((function(e){return e.value===n})))&&void 0!==r?r:"";var r}var B=function(e){(0,w.Z)(r,e);var n=(0,S.Z)(r);function r(e){var t;return(0,_.Z)(this,r),(t=n.call(this,e)).ref=(0,o.createRef)(),t.handleChange=function(e){if(t.props.onChange){var n=null!=e&&Array.isArray(e)?e.map((function(e){return e.value})):null===e||void 0===e?void 0:e.value;t.props.onChange(t.props.name,n)}},t.handleCreate=function(e){var n={value:e,label:e};t.setState((function(e){return{options:[].concat((0,C.Z)(e.options),[n])}}),(function(){if(t.props.isMulti){var r,i,o=q((null!==(r=t.props.data)&&void 0!==r?r:[]).concat(t.state.options),[].concat((0,C.Z)(null!==(i=t.props.value)&&void 0!==i?i:[]),[e]));t.handleChange(o)}else t.handleChange(n)}))},t.state={options:[]},t}return(0,y.Z)(r,[{key:"focus",value:function(){return!(null==this.ref||!this.ref.current)&&(this.ref.current.focus(),!0)}},{key:"render",value:function(){var e,n=this,r=(null!==(e=this.props.data)&&void 0!==e?e:[]).concat(this.state.options),t=q(r,this.props.value);return(0,R.jsx)(d.Z.Group,{className:F()("form-group",this.props.className,{error:this.isErrorneous(),readonly:this.props.readOnly,required:this.props.required&&!this.props.readOnly}),children:(0,R.jsxs)(E.Z,{condition:null!=this.props.tooltip,render:function(e){return(0,R.jsx)(T.Z,{id:"".concat(n.props.name,"-tooltip"),tooltip:n.props.tooltip,children:e})},children:[this.getLabel({htmlFor:"".concat(this.props.name,"-input")}),this.getHelpText(),this.getErrorMessage(),(0,R.jsx)(N.Z,{inputId:"".concat(this.props.name,"-input"),onChange:this.handleChange,onBlur:this.props.onBlur,onFocus:this.props.onFocus,isValidNewOption:L,onCreateOption:this.handleCreate,isClearable:!0,isMulti:this.props.isMulti,value:t,className:"react-select-container",classNamePrefix:"creatable-select",options:r,placeholder:"",ref:this.ref})]})})}}],[{key:"getDerivedStateFromProps",value:function(e,n){if(null==e.data||0===e.data.length||0===n.options.length)return n;for(var r=e.data.map((function(e){return e.value})),t=(0,C.Z)(n.options),i=t.length-1;i>=0;--i)r.includes(t[i].value)&&t.splice(i,1);return n.options.length===t.length?n:(0,p.Z)((0,p.Z)({},n),{},{options:t})}}]),r}(k.Z),G=["parser","formatter","name","required","isMulti","onFocus","onBlur"],A=(0,o.forwardRef)((function(e,n){var r=e.parser,t=e.formatter,i=e.name,o=e.required,s=e.isMulti,a=e.onFocus,u=e.onBlur,c=(0,x.Z)(e,G),d=(0,l.Z)();return(0,R.jsx)(v.gN,{name:i,validate:o?j.np:void 0,validateFields:[],children:function(e){return(0,R.jsx)(B,(0,p.Z)((0,p.Z)({},c),{},{isMulti:s,required:o,name:e.input.name,value:(i=e.input.value,null==i?s?[]:void 0:t(i)),errors:(0,j.fr)(d,e.meta.error||(e.meta.dirtySinceLastSubmit?void 0:e.meta.submitError)),meta:e.meta,onChange:function(n,t){e.input.onChange(r(t))},onFocus:function(n){e.input.onFocus(n),null===a||void 0===a||a(n)},onBlur:function(n){e.input.onBlur(n),null===u||void 0===u||u(n)},ref:n}));var i}})})),O=function(e){var n=e.name,r=e.label,t=(0,l.Z)(),i=(0,c.I0)(),s=(0,o.useCallback)((function(){return i(g.fetchTags())}),[i,u]),a=(0,c.v9)((function(e){return e.recipeGroups.tags.items}));(0,b.Z)(s,a);var p=(0,o.useMemo)((function(){return null===a||void 0===a?void 0:a.filter((function(e){return e.title.length>0})).map((function(e){return{value:e.title,label:(0,Z.kT)(t,"tag.",e.title)}})).sort(Z.hF)}),[a,t.locale]);return(0,R.jsx)(A,{name:n,label:r,data:p,parser:function(e){if(null!=e){var n=[];return e.forEach((function(e){var r=null===a||void 0===a?void 0:a.find((function(n){return n.title===e}));n.push(null!==r&&void 0!==r?r:{title:e})})),n}},formatter:function(e){return Array.isArray(e)?e.map((function(e){return e.title})):e.title},isMulti:!0})},I=function(e){var n=e.name,r=e.label,t=(0,l.Z)(),i=(0,c.I0)(),s=(0,o.useCallback)((function(){return i(g.fetchCourses())}),[i,g]),a=(0,c.v9)((function(e){return e.recipeGroups.courses.items}));(0,b.Z)(s,a);var u=(0,o.useMemo)((function(){return null===a||void 0===a?void 0:a.map((function(e){return{value:e.title,label:(0,Z.kT)(t,"course.",e.title)}})).sort(Z.hF)}),[a,t.locale]);return(0,R.jsx)(A,{name:n,label:r,data:u,parser:function(e){var n;if(null!=e)return null!==(n=null===a||void 0===a?void 0:a.find((function(n){return n.title===e})))&&void 0!==n?n:{title:e}},formatter:function(e){return Array.isArray(e)?e.map((function(e){return e.title})):e.title}})},P=function(e){var n=e.name,r=e.label,t=(0,l.Z)(),i=(0,c.I0)(),s=(0,o.useCallback)((function(){return i(g.fetchCuisines())}),[i,u]),a=(0,c.v9)((function(e){return e.recipeGroups.cuisines.items}));(0,b.Z)(s,a);var p=(0,o.useMemo)((function(){return null===a||void 0===a?void 0:a.map((function(e){return{value:e.title,label:(0,Z.kT)(t,"cuisine.",e.title)}})).sort(Z.hF)}),[a,t.locale]);return(0,R.jsx)(A,{name:n,label:r,data:p,parser:function(e){var n;if(null!=e)return null!==(n=null===a||void 0===a?void 0:a.find((function(n){return n.title===e})))&&void 0!==n?n:{title:null!==e&&void 0!==e?e:""}},formatter:function(e){return Array.isArray(e)?e.map((function(e){return e.title})):e.title}})},D=r(3504),U=r(3360),V=r(297),W=function(){var e,n=(0,l.Z)().formatMessage,r=(0,a.vU)({submit:{id:"recipe.create.submit",description:"Submit recipe button",defaultMessage:"Submit recipe"},save:{id:"recipe.create.save",description:"Save recipe button",defaultMessage:"Save"},view:{id:"recipe.create.view",description:"View recipe button",defaultMessage:"View"}}),t=(0,c.I0)(),i=(0,c.v9)((function(e){return e.recipeForm})),o=function(){i.item&&t(V.MA(i.item))},s=null===(e=i.item)||void 0===e?void 0:e.id,u=null==s||0===s,p=function(e){return!u&&e};return(0,R.jsx)(v.lP,{subscription:{pristine:!0,submitting:!0},children:function(e){var t,s=e.pristine,a=e.submitting;return(0,R.jsx)(U.Z,{variant:"primary",type:p(s)?"button":"submit",disabled:a||(0,Z.s6)()&&!p(s),as:p(s)?D.rU:void 0,to:p(s)?(0,Z.xb)("/recipe/".concat(null===(t=i.item)||void 0===t?void 0:t.slug)):null,onClick:o,accessKey:p(s)?void 0:"s",children:n(p(s)?r.view:r.submit)})}})},H=r(7547),K=r(7411),Y=r(9854),z=r(7847),X=r(2265),J=r(885),Q=r(6956),$=r(9377),ee=r(9410),ne=r(78),re=function(e){(0,w.Z)(r,e);var n=(0,S.Z)(r);function r(){var e;(0,_.Z)(this,r);for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];return(e=n.call.apply(n,[this].concat(i))).ref=(0,o.createRef)(),e.handleChange=function(n){var r;e.props.onChange&&e.props.onChange(n.target.name,null===n||void 0===n||null===(r=n.target.files)||void 0===r?void 0:r[0])},e.handleClear=function(){e.props.onChange&&(e.props.onChange(e.props.name,""),e.clearValue())},e}return(0,y.Z)(r,[{key:"clearValue",value:function(){null!=this.ref&&this.ref.current&&(this.ref.current.value="")}},{key:"focus",value:function(){return!(null==this.ref||!this.ref.current)&&(this.ref.current.focus(),!0)}},{key:"render",value:function(){var e=this;return(0,R.jsx)(d.Z.Group,{controlId:this.props.name,className:this.getFormGroupClassNames(),children:(0,R.jsxs)(E.Z,{condition:null!=this.props.tooltip,render:function(n){return(0,R.jsx)(T.Z,{id:"".concat(e.props.name,"-tooltip"),tooltip:e.props.tooltip,children:n})},children:[this.getLabel(),this.getHelpText(),this.getErrorMessage(),(0,R.jsxs)(ee.Z,{children:[(0,R.jsx)(d.Z.Control,{type:"file",name:this.props.name,accept:this.props.accept,readOnly:this.props.readOnly,disabled:this.props.disabled,onChange:this.handleChange,onBlur:this.props.onBlur,onFocus:this.props.onFocus,ref:this.ref}),!this.props.readOnly&&!this.props.disabled&&this.props.onChange&&(this.props.value||null!=this.ref.current&&this.ref.current.value)&&(0,R.jsx)(ee.Z.Text,{className:"input-adornment-end button",children:(0,R.jsx)(U.Z,{onClick:this.handleClear,children:(0,R.jsx)(ne.Z,{icon:"x",variant:"light",size:"2x"})})})]})]})})}}]),r}(k.Z),te=re,ie=["name","required","onChange","onFocus","onBlur"],oe=function(e){return e},se=(0,o.forwardRef)((function(e,n){var r=e.name,t=e.required,i=e.onChange,o=e.onFocus,s=e.onBlur,a=(0,x.Z)(e,ie),u=(0,l.Z)();return(0,R.jsx)(v.gN,{name:r,validate:t?j.np:void 0,validateFields:[],parse:oe,children:function(e){var r;return(0,R.jsx)(te,(0,p.Z)((0,p.Z)({},a),{},{required:t,name:e.input.name,value:null!==(r=e.input.value)&&void 0!==r&&r,errors:(0,j.fr)(u,e.meta.error||(e.meta.dirtySinceLastSubmit?void 0:e.meta.submitError)),meta:e.meta,onChange:function(n,r){e.input.onChange(r),null===i||void 0===i||i(n,r)},onFocus:function(n){e.input.onFocus(n),null===o||void 0===o||o(n)},onBlur:function(n){e.input.onBlur(n),null===s||void 0===s||s(n)},ref:n}))}})})),ae=r(7092),le=function(){var e=(0,l.Z)().formatMessage,n=(0,a.vU)({photo_label:{id:"recipe.create.photo_label",description:"Photo label",defaultMessage:"Photo"}}),r=(0,s.TH)().key,t=(0,o.useRef)(null),i=(0,o.useState)(void 0),u=(0,J.Z)(i,2),c=u[0],p=u[1],d=(0,o.useMemo)((function(){return(0,Z.uS)()}),[]);(0,o.useEffect)((function(){t.current&&t.current.clearValue(),p(void 0)}),[r]);return(0,R.jsxs)(R.Fragment,{children:[(0,R.jsx)(h.Z,{children:(0,R.jsx)(m.Z,{xs:12,lg:11,xl:10,xxl:9,style:{marginLeft:"auto",marginRight:"auto"},children:(0,R.jsx)(Q.Z,{height:66.67,width:100,children:(0,R.jsx)(ae.Z,{fieldNames:["photo"],children:function(e){return(0,R.jsx)($.Z,{src:(n=e.photo,null!=c?c.length>0?c:(0,Z.uS)():(0,Z.eE)(n||d)),alt:"",style:{objectFit:"contain"}});var n}})})})}),(0,R.jsx)(h.Z,{children:(0,R.jsx)(m.Z,{xs:12,children:(0,R.jsx)(se,{name:"photo",label:e(n.photo_label),accept:"image/*",onChange:function(e,n){p(n?URL.createObjectURL(n):"")},ref:t})})})]})},ue=r(243),ce=r(4999),pe=r(7556);function de(e){var n,r=e.indexOf("."),t=e.indexOf(",");return n=-1===r&&-1===t?e:-1===r?e.replace(",","."):-1===t?e:r<t?(n=e.replace(".","")).replace(",","."):e.replace(",",""),parseFloat(n)}var fe=function(e){var n=-1,r=e.length;return["1","2","3","4","5","6","7","8","9","0"].forEach((function(r){e.lastIndexOf(r)>n&&(n=e.lastIndexOf(r))})),r===n+1?{amount:e,rest:""}:{amount:e.substring(0,n+1),rest:e.substring(n+1,r)}},he=function(e){return e.normalize("NFKD").split("\u2044")},me=function(e,n){var r,t,i=n.split(" "),o=[],s=!1;for(t=0;t<i.length-1;++t){var a=i[t];if(0!==a.length){var l=s?[]:he(a[0]);if(s||Number.isNaN(parseInt(a[0]))){if(s||!l[1]){s=!0,(r=e[a.toLocaleLowerCase()])&&++t;break}if(s=!0,o.push("".concat(l[0],"/").concat(l[1])),a.length>1){(r=e[a.substring(1).toLocaleLowerCase()])&&++t;break}}else{var u=fe(a),c=u.amount,p=u.rest;if(o.push(c),p){var d=he(p[0]);if(d[1]){if(s=!0,o.push("".concat(d[0],"/").concat(d[1])),!(p.length>1))continue;p=p.substring(1)}if(r=e[p.toLocaleLowerCase()]){++t;break}}o.length>=2&&(s=!0)}}}var f=function(e){var n=e.reduce((function(e,n){var r=n.split("/"),t=de(r[0]),i=r.length>1?de(r[1]):1;if(0===e.denominator)return{numerator:t,denominator:i};if(1===r.length){t*=e.numerator,i*=e.denominator;var o=(0,pe.b)(t,i);return{numerator:t/o,denominator:i/o}}t=e.numerator*i+e.denominator*t,i*=e.denominator;var s=(0,pe.b)(t,i);return{numerator:t/s,denominator:i/s}}),{numerator:0,denominator:0});return{numerator:n.numerator,denominator:n.denominator}}(o),h=f.numerator;return{numerator:0===h?void 0:h,denominator:f.denominator,measurement:r,title:i.slice(t).join(" ")}},ve=r(4349),ge=r(6914),be=(r(1534),function(){return(0,R.jsx)("div",{className:"loading",children:"Loading..."})}),Ze=function(e){(0,w.Z)(r,e);var n=(0,S.Z)(r);function r(){var e;(0,_.Z)(this,r);for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];return(e=n.call.apply(n,[this].concat(i))).ref=(0,o.createRef)(),e}return(0,y.Z)(r,[{key:"focus",value:function(){return!(null==this.ref||!this.ref.current)&&(this.ref.current.focus(),!0)}},{key:"getLabel",value:function(){return null==this.props.label?null:this.props.tooltip?(0,R.jsxs)(R.Fragment,{children:[this.props.label,"\xa0",(0,R.jsx)(ne.Z,{icon:"info-circle",className:"tooltip-icon"})]}):this.props.label}},{key:"render",value:function(){var e,n,r=this;return(0,R.jsx)(d.Z.Group,{controlId:this.props.name,className:this.getFormGroupClassNames(),children:(0,R.jsxs)(E.Z,{condition:null!=this.props.tooltip,render:function(e){return(0,R.jsx)(T.Z,{id:"".concat(r.props.name,"-tooltip"),tooltip:r.props.tooltip,children:e})},children:[this.getLabel(),this.getHelpText(),this.getErrorMessage(),(0,R.jsx)(ee.Z,{children:(0,R.jsx)(ge.Z,(0,p.Z)((0,p.Z)({},this.props),{},{name:this.props.name,value:null!==(e=this.props.value)&&void 0!==e?e:"",rows:null!==(n=this.props.rows)&&void 0!==n?n:4,required:this.props.required,readOnly:this.props.readOnly,autoComplete:this.props.autoComplete,autoFocus:this.props.autoFocus,loadingComponent:be,className:"form-control",movePopupAsYouType:!0,trigger:this.props.trigger,onChange:this.handleChange,onBlur:this.props.onBlur,onFocus:this.props.onFocus}))})]})})}}]),r}(k.Z),xe=["name","required","format","parse","onChange","onFocus","onBlur"],je=(0,o.forwardRef)((function(e,n){var r=e.name,t=e.required,i=e.format,s=e.parse,a=e.onChange,u=e.onFocus,c=e.onBlur,d=(0,x.Z)(e,xe),f=(0,l.Z)(),h=(0,o.useMemo)((function(){var e=[];return t&&e.push(j.np),j.A3.apply(void 0,e)}),[t]);return(0,R.jsx)(v.gN,{name:r,validate:h,validateFields:[],format:i,parse:s,children:function(e){return(0,R.jsx)(Ze,(0,p.Z)((0,p.Z)({},d),{},{required:t,name:e.input.name,value:e.input.value,errors:(0,j.fr)(f,e.meta.error||(e.meta.dirtySinceLastSubmit?void 0:e.meta.submitError)),meta:e.meta,onChange:function(n,r){e.input.onChange(r),null===a||void 0===a||a(n,r)},onFocus:function(n){e.input.onFocus(n),null===u||void 0===u||u(n)},onBlur:function(n){e.input.onBlur(n),null===c||void 0===c||c(n)},ref:n}))}})})),Ce=r(1734),_e=r(9485),ye=function(e){var n=e.id,r=e.labels,t=e.errors,i=e.tooltips,o=e.initialTab,s=e.activeTab,u=e.onSelect,c=e.children,p=(0,l.Z)().formatMessage,d=(0,a.vU)({preview:{id:"recipe.create.preview",description:"Preview",defaultMessage:"Preview"}}),f=F()("content",{"has-error":!!t}),h=F()("nav","nav-tabs",{"has-error":!!t}),m=c.slice(0,c.length-1).map((function(e,n){return(0,R.jsx)(Ce.Z,{title:(0,R.jsxs)(R.Fragment,{children:[r[n],(null===i||void 0===i?void 0:i[n])&&(0,R.jsxs)(R.Fragment,{children:["\xa0",(0,R.jsx)(T.Z,{id:"".concat(r[n],"-tooltip"),placement:"bottom",tooltip:i[n],children:(0,R.jsx)(ne.Z,{icon:"info-circle",className:"tooltip-icon"})})]})]}),eventKey:String(n),className:"editor",children:(0,R.jsx)("div",{className:f,children:e})},String(n))}));return(0,R.jsxs)("div",{className:"live-editor",children:[(0,R.jsxs)(_e.Z,{id:"".concat(n,"-tabs"),defaultActiveKey:o||"0",activeKey:s,onSelect:function(e){u&&e&&u(e)},className:h,children:[m,(0,R.jsx)(Ce.Z,{title:p(d.preview),className:"preview",eventKey:"preview",children:(0,R.jsx)("div",{className:f,children:c[c.length-1]})})]}),(0,R.jsx)("div",{className:"help-text error",children:t})]})};function we(e){var n=e.replace(/\t/g," ");return n=n.trim()}function Se(e,n,r){var t="";return r&&r.filter((function(e){return e.title.trim().length>0||e.ingredients.length>0})).forEach((function(r){r.title&&(t+="".concat(r.title,":\n")),r.ingredients.forEach((function(r){var i=r.measurement?n[r.measurement]:"";t+=r.numerator?"".concat((0,ce.Z)(1,1,r.numerator,r.denominator)," "):"",t+=i?"".concat(e.formatMessage({id:"measurement.".concat(i.toLocaleLowerCase())},{itemCount:r.numerator})," "):"",t+="".concat(r.title,"\n")})),t+="\n"})),t.endsWith("\n")?t.substring(0,t.length-2):t}function Me(e,n){var r;if(!n)return[];var t=[{title:"",ingredients:[]}],i="",o=null===(r=t.find((function(e){return""===e.title})))||void 0===r?void 0:r.ingredients;if(null==o)throw new Error("Invalid state: ings may not be null.");n&&n.split("\n").map((function(e){return we(e)})).filter((function(e){return e.length>0})).forEach((function(n){if(n.length>0)if(n.endsWith(":")&&n.length>1){var r;if(i=n.substring(0,n.length-1),t.push({title:i,ingredients:[]}),null==(o=null===(r=t.find((function(e){return e.title===i})))||void 0===r?void 0:r.ingredients))throw new Error("Invalid state: The create ings may not be null.")}else{if(null==o)throw new Error("Invalid state: ings may not be null.");o.push(me(e,n))}}));return t}function Fe(e,n,r){var t="";return r&&r.forEach((function(r){var i=r.measurement?n[r.measurement]:"";t+=r.numerator?"".concat((0,ce.Z)(1,1,r.numerator,r.denominator)," "):"",t+=i?"".concat(e.formatMessage({id:"measurement.".concat(i.toLocaleLowerCase())},{itemCount:r.numerator})," "):"",t+="".concat(r.title,"\n")})),t.substring(0,t.length-1)}function Ne(e,n){if(!n)return[];var r=[];return n.split("\n").map((function(e){return we(e)})).filter((function(e){return e.length>1&&!e.startsWith(":")})).forEach((function(n){n.length>0&&r.push(me(e,n))})),r}var ke=function(e){var n=e.entity.char;return(0,R.jsx)("div",{children:n})},Ee=function(e){var n=e.igData,r=e.srData,t=(0,o.useMemo)((function(){return e=function(e){var n=(0,ce.Z)(1,1,e.numerator,e.denominator);return(0,p.Z)((0,p.Z)({},e),{},{quantity:n})},n.map((function(n){return(0,p.Z)((0,p.Z)({},n),{},{ingredients:n.ingredients.map((function(n){return e(n)}))})}));var e}),[n]),i=(0,o.useMemo)((function(){return r.map((function(e){var n=(0,ce.Z)(1,1,e.numerator,e.denominator);return(0,p.Z)((0,p.Z)({},e),{},{quantity:n})}))}),[n]);return(0,R.jsx)("div",{className:"recipe-details",children:(0,R.jsx)("div",{className:"recipe-schema",children:(0,R.jsx)("article",{className:"ingredients-panel",children:(0,R.jsxs)("div",{className:"ingredient-groups",children:[(0,R.jsx)(ve.Z,{subRecipes:i}),(0,R.jsx)(ue.Z,{groups:t,hasSubrecipes:r.length>0})]})})})})},Te=function(e){var n=e.nameIg,r=e.nameSub,t=e.fetchRecipeList,i=(0,l.Z)(),u=i.formatMessage,c=(0,a.vU)({ingredients_label:{id:"recipe.create.ingredients_label",description:"Recipe ingredients label",defaultMessage:"Ingredients"},ingredients_tooltip:{id:"recipe.create.ing.info_desc",description:"info_desc",defaultMessage:'Each Ingredient should be on its own line. You can form groups by ending the groups first line with a colon (":").'},ingredients_placeholder:{id:"recipe.create.ing.ingredients_placeholder",description:"Example for writing ingredients",defaultMessage:"Dough:\n300 g flour\n100 ml milk\n\nDip:\n100 ml olive oil\n..."},subrecipes_label:{id:"recipe.create.subrecipes_label",description:"Recipe links label",defaultMessage:"Recipe links"},subrecipes_tooltip:{id:"recipe.create.subrecipes.tooltip",description:"Subrecipes tooltip",defaultMessage:"If the recipe is made of several subrecipes, then link them here. Each Recipe Link should be on its own line."},subrecipes_placeholder:{id:"recipe.create.subrecipes.placeholder",description:"Subreceipes placeholder",defaultMessage:":dough-1\n:olive-oil-dip-1"}}),p=(0,s.TH)(),d=(0,o.useState)("0"),f=(0,J.Z)(d,2),h=f[0],m=f[1];(0,o.useEffect)((function(){p.pathname.endsWith("/create")&&m("0")}),[p.pathname]);var g=(0,o.useContext)(z.Z),b=function(e,t){return!0===(null===t||void 0===t?void 0:t[n])&&null!=(null===e||void 0===e?void 0:e[n])?(0,j.fr)(i,null===e||void 0===e?void 0:e[n]):null!==t&&void 0!==t&&t[r]&&null!=(null===e||void 0===e?void 0:e[r])?(0,j.fr)(i,null===e||void 0===e?void 0:e[r]):void 0};return(0,R.jsx)(v.lP,{subscription:{errors:!0,touched:!0,initialValues:!0},children:function(e){var i=e.errors,o=e.touched,s=e.initialValues;return(0,R.jsxs)(ye,{id:"ingredients",labels:[u(c.ingredients_label),u(c.subrecipes_label)],activeTab:h,onSelect:m,errors:b(i,o),tooltips:[u(c.ingredients_tooltip),u(c.subrecipes_tooltip)],children:[(0,R.jsx)(ae.Z,{fieldNames:[r],children:function(e){return(0,R.jsx)(H.Z,{name:n,rows:8,placeholder:u(c.ingredients_placeholder),required:s&&!e[r]})}}),(0,R.jsx)("div",{className:"form-group",children:(0,R.jsx)(je,{name:r,rows:8,placeholder:u(c.subrecipes_placeholder),trigger:{":":{dataProvider:function(e){return t(e)},component:ke,output:function(e){return e.char}}}})}),(0,R.jsx)(ae.Z,{fieldNames:[n,r],children:function(e){return(0,R.jsx)(R.Fragment,{children:"preview"===h&&(0,R.jsx)(Ee,{igData:Me(g.parser,e[n]),srData:Ne(g.parser,e[r])})})}})]})}})},Re=r(9024),Le=function(e){var n=e.directions,r=e.ingredients,t=(0,o.useMemo)((function(){return e=function(e){var n=(0,ce.Z)(1,1,e.numerator,e.denominator);return(0,p.Z)((0,p.Z)({},e),{},{quantity:n})},r.map((function(n){return(0,p.Z)((0,p.Z)({},n),{},{ingredients:n.ingredients.map((function(n){return e(n)}))})}));var e}),[r]),i=n.includes(":\n");return(0,R.jsx)("div",{className:"recipe-details",children:(0,R.jsx)("div",{className:"recipe-schema",children:(0,R.jsx)("article",{className:F()("directions-panel",{"multi-directions":i}),children:(0,R.jsx)("div",{className:"direction-groups",children:(0,R.jsx)(Re.Z,{directions:n,ingredients:t})})})})})},qe=function(e){var n=e.name,r=(0,l.Z)(),t=r.formatMessage,i=(0,a.vU)({directions_label:{id:"recipe.create.directions_label",description:"Directions label",defaultMessage:"Directions"},directions_tooltip:{id:"recipe.create.dir.tooltip",description:"Directions Tooltip",defaultMessage:'Each Direction should be on its own line. You can form chapters by ending the chapters heading with a colon (":").'},directions_placeholder:{id:"recipe.create.dir.placeholder",description:"Directions Placeholder",defaultMessage:"Dough:\nPrepare the dough.\n\nDip:\nPrepare the dip.\n..."}}),u=(0,o.useContext)(z.Z),c=(0,s.TH)(),p=(0,o.useState)("0"),d=(0,J.Z)(p,2),f=d[0],h=d[1];return(0,o.useEffect)((function(){c.pathname.endsWith("/create")&&h("0")}),[c.pathname]),(0,R.jsx)(v.lP,{subscription:{errors:!0},children:function(e){var o=e.errors;return(0,R.jsxs)(ye,{id:"directions",labels:[t(i.directions_label)],activeTab:f,onSelect:h,errors:(0,j.fr)(r,null===o||void 0===o?void 0:o[n]),tooltips:[t(i.directions_tooltip)],children:[(0,R.jsx)(H.Z,{name:n,rows:8,placeholder:t(i.directions_placeholder)}),(0,R.jsx)(ae.Z,{fieldNames:[n,"ingredientGroupsS"],children:function(e){var r;return(0,R.jsx)(R.Fragment,{children:"preview"===f&&(0,R.jsx)(Le,{directions:null!==(r=e[n])&&void 0!==r?r:"",ingredients:Me(u.parser,e.ingredientGroupsS)})})}})]})}})},Be=function(e){var n=e.recipe,r=e.isNew,t=e.location,i=e.fetchRecipeList,s=e.onSubmit,u=(0,l.Z)(),c=u.formatMessage,g=(0,a.vU)({name_label:{id:"recipe.create.name_label",description:"Recipe name label",defaultMessage:"Recipe name"},course_label:{id:"recipe.create.course_label",description:"Course label",defaultMessage:"Course"},cuisine_label:{id:"recipe.create.cuisine_label",description:"Cuisine label",defaultMessage:"Cuisine"},tags_label:{id:"recipe.create.tags_label",description:"Tags label",defaultMessage:"Tags"},prep_time_label:{id:"recipe.create.prep_time_label",description:"Prep time label",defaultMessage:"Prep time (min)"},cooking_time_label:{id:"recipe.create.cooking_time_label",description:"Cooking time label",defaultMessage:"Cooking time (min)"},servings_label:{id:"recipe.create.servings_label",description:"Servings label",defaultMessage:"Servings"},information_label:{id:"recipe.create.information_label",description:"Recipe information label",defaultMessage:"Recipe information"},information_placeholder:{id:"recipe.create.information_placeholder",description:"Recipe information placeholder",defaultMessage:"A quick description of the recipe"},source_label:{id:"recipe.create.source_label",description:"Rating source label",defaultMessage:"Source"},source_tooltip:{id:"recipe.create.source_tooltip",description:"Rating source tooltip",defaultMessage:"Where the original recipe is from."},public_label:{id:"recipe.create.public_label",description:"Recipe set public label",defaultMessage:"Public Recipe"}}),b=(0,o.useContext)(z.Z),Z=(0,o.useMemo)((function(){return r&&!n?{slug:"",public:!0,servings:1}:n?(0,p.Z)((0,p.Z)({},n),{},{ingredientGroupsS:Se(u,b.formatter,n.ingredientGroups),subrecipesS:Fe(u,b.formatter,n.subrecipes)}):void 0}),[n,r,t]);return(0,R.jsx)(v.l0,{initialValues:Z,onSubmit:function(e){return s((0,p.Z)((0,p.Z)({},e),{},{ingredientGroups:Me(b.parser,e.ingredientGroupsS),subrecipes:Ne(b.parser,e.subrecipesS)}))},subscription:{},render:function(e){var n=e.form,r=e.handleSubmit;return(0,R.jsxs)(d.Z,{className:"recipe-form",onSubmit:r,children:[(0,R.jsx)(X.Z,{}),(0,R.jsx)(Y.Z,{form:n,initialValues:Z}),(0,R.jsx)(f.Z,{children:(0,R.jsxs)(h.Z,{children:[(0,R.jsxs)(m.Z,{id:"recipe-meta",md:5,lg:4,children:[(0,R.jsx)(h.Z,{children:(0,R.jsx)(m.Z,{xs:12,children:(0,R.jsx)(H.Z,{name:"title",label:c(g.name_label),required:!0})})}),(0,R.jsx)(le,{}),(0,R.jsxs)(h.Z,{children:[(0,R.jsx)(m.Z,{xs:12,sm:6,children:(0,R.jsx)(I,{name:"course",label:c(g.course_label)})}),(0,R.jsx)(m.Z,{xs:12,sm:6,children:(0,R.jsx)(P,{name:"cuisine",label:c(g.cuisine_label)})}),(0,R.jsx)(m.Z,{xs:12,children:(0,R.jsx)(O,{name:"tags",label:c(g.tags_label)})})]}),(0,R.jsxs)(h.Z,{children:[(0,R.jsx)(m.Z,{xs:12,sm:6,children:(0,R.jsx)(H.Z,{name:"prepTime",type:"number",label:c(g.prep_time_label),min:1,max:999})}),(0,R.jsx)(m.Z,{xs:12,sm:6,children:(0,R.jsx)(H.Z,{name:"cookTime",type:"number",label:c(g.cooking_time_label)})})]}),(0,R.jsx)(h.Z,{children:(0,R.jsx)(m.Z,{xs:12,children:(0,R.jsx)(H.Z,{name:"servings",type:"number",label:c(g.servings_label),min:1,max:999,required:!0})})}),(0,R.jsx)(h.Z,{children:(0,R.jsx)(m.Z,{xs:12,children:(0,R.jsx)(H.Z,{name:"source",label:c(g.source_label),tooltip:c(g.source_tooltip)})})}),(0,R.jsx)(h.Z,{children:(0,R.jsx)(m.Z,{xs:12,children:(0,R.jsx)(K.Z,{name:"public",label:c(g.public_label)})})})]}),(0,R.jsxs)(m.Z,{id:"recipe",md:7,lg:8,children:[(0,R.jsx)(H.Z,{name:"info",rows:3,label:c(g.information_label),placeholder:c(g.information_placeholder)}),(0,R.jsx)(Te,{nameIg:"ingredientGroupsS",nameSub:"subrecipesS",fetchRecipeList:i}),(0,R.jsx)(qe,{name:"directions"}),(0,R.jsx)(W,{})]})]})})]})}})},Ge=r(3976),Ae=r(5355),Oe=r(9511),Ie=function(){var e,n=(0,s.UO)(),r=(0,s.s0)(),t=null!==(e=n.recipe)&&void 0!==e?e:"",i="create"===t,a=(0,c.v9)((function(e){return e.account})),l=(0,c.v9)((function(e){return e.recipeForm})),u=l.item,p=l.meta.pending,d=(0,o.useRef)(!1),f=a.item,h=null!=f&&(i||f.id===(null===u||void 0===u?void 0:u.author));(0,o.useEffect)((function(){null==f||p!==Oe.V.COMPLETED||null==u||h||r((0,Z.xb)("/recipe/".concat(t)))}),[f,l,h]),(0,o.useEffect)((function(){null!=(null===u||void 0===u?void 0:u.slug)&&p===Oe.V.COMPLETED&&i&&d.current&&setTimeout((function(){r((0,Z.xb)("/recipe/edit/".concat(u.slug)))}),250),d.current=!0}),[p]);var m=l.meta;return(0,o.useEffect)((function(){404===Ae.Z(m.error,"status")&&r((0,Z.xb)("/NotFound"))}),[m.error]),null},Pe=function(){var e,n=(0,l.Z)(),r=(0,a.vU)({new_recipe:{id:"recipe_form.new_recipe",description:"New Recipe documentTitle",defaultMessage:"New Recipe"}}),p=(0,c.I0)(),d=(0,s.UO)(),f=(0,s.TH)(),h=u.fetchRecipeList,m=(0,o.useCallback)(function(){var e=(0,i.Z)((0,t.Z)().mark((function e(n){return(0,t.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",u.save(p,n));case 1:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),[p]),v=null!==(e=d.recipe)&&void 0!==e?e:"",g="create"===v,b=(0,c.v9)((function(e){return e.recipeForm.item}));return(0,o.useEffect)((function(){v&&(window.scrollTo(0,0),p("create"===v?u.reset():u.load(v)))}),[v,f.key]),(0,o.useEffect)((function(){return function(){p(u.reset())}}),[]),(0,R.jsxs)(Ge.Z,{title:g?n.formatMessage(r.new_recipe):null===b||void 0===b?void 0:b.title,children:[(0,R.jsx)(Ie,{}),(0,R.jsx)(Be,{recipe:b,isNew:g,location:f.key,fetchRecipeList:h,onSubmit:m})]})}},63:function(e,n,r){r.r(n),r.d(n,{fetchCourses:function(){return c},fetchCuisines:function(){return p},fetchTags:function(){return d}});var t=r(1413),i=r(7572),o=r(8263),s=r(7728),a=r(1818),l=r(1220),u=r(9656),c=function(){return function(e){e((0,t.Z)({},(0,u.s_)(l.pq,s.o.GET_START))),(0,i.WY)().get(o.m.course).then((function(n){e((0,t.Z)((0,t.Z)({},(0,u.s_)(l.pq,s.o.GET_SUCCESS)),{},{payload:n.body.results.filter((function(e){return"-"!==e.title})).map((function(e){return(0,a.Xi)(e)}))}))})).catch((function(n){return e((0,i.S3)(n,l.pq))}))}},p=function(){return function(e){e((0,t.Z)({},(0,u.s_)(l.xv,s.o.GET_START))),(0,i.WY)().get(o.m.cuisine).then((function(n){e((0,t.Z)((0,t.Z)({},(0,u.s_)(l.xv,s.o.GET_SUCCESS)),{},{payload:n.body.results.filter((function(e){return"-"!==e.title})).map((function(e){return(0,a.dS)(e)}))}))})).catch((function(n){return e((0,i.S3)(n,l.xv))}))}},d=function(){return function(e){e((0,t.Z)({},(0,u.s_)(l.ic,s.o.GET_START))),(0,i.WY)().get(o.m.tag).then((function(n){e((0,t.Z)((0,t.Z)({},(0,u.s_)(l.ic,s.o.GET_SUCCESS)),{},{payload:n.body.results.map((function(e){return(0,a.uk)(e)}))}))})).catch((function(n){return e((0,i.S3)(n,l.ic))}))}}}}]);
//# sourceMappingURL=343.c7935341.chunk.js.map