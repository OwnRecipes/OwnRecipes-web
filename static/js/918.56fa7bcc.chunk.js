"use strict";(self.webpackChunkownrecipes_web=self.webpackChunkownrecipes_web||[]).push([[918],{8437:function(e,n,t){t.d(n,{Z:function(){return h}});var i=t(2791),r=t(3504),s=t(2677),o=t(9140),a=t(9743),c=t(1694),l=t.n(c),u=t(92),d=t(1884),p=t(4858),f=t(184);function g(e){if(e.photoThumbnail)return e.photoThumbnail;var n=["fish","fried-eggs","pizza","soup","steak"];return(0,d.xb)("/images/".concat(n[Math.floor(Math.random()*n.length)],".jpg"))}var h=function(e){var n=e.data,t=e.onOpenRecipe,c=(0,i.useMemo)((function(){return(0,d.uS)()}),[]),h=null===n||void 0===n?void 0:n.map((function(e){var n=(0,d.qC)("/recipe/".concat(e.slug));return(0,f.jsx)(s.Z,{children:(0,f.jsx)(o.Z,{className:l()("recipe"),children:(0,f.jsxs)(r.rU,{to:n,onClick:function(){return t(e)},children:[(0,f.jsx)(o.Z.Img,{variant:"top",src:g(e),alt:"",placeholder:c}),(0,f.jsx)(o.Z.Title,{as:"h3",children:(0,f.jsx)(p.Z,{id:e.slug,tooltip:e.title,placement:"bottom",className:"card-title-tooltip",children:e.title})}),(0,f.jsx)("div",{children:(0,f.jsx)(u.Z,{stars:e.rating})}),(0,f.jsx)(o.Z.Text,{children:e.info})]})})},e.id)}));return(0,f.jsx)(a.Z,{xs:1,sm:2,lg:4,className:"g-4 recipes-list",children:h})}},6693:function(e,n,t){t.d(n,{Z:function(){return j}});var i=t(2791),r=t(6871),s=t(6221),o=t(3539),a=(t(4658),t(78)),c=t(1728),l=t(9656),u=t(297),d=t(8437),p=t(1413),f=t(7572),g=t(8263),h=t(5926),m=t(7728),v=t(6879),x=function(e){return function(n){n((0,p.Z)({},(0,l.s_)(h.S,m.o.GET_START))),(0,f.WY)().get("".concat(g.m.mini_browse).concat(e?"&".concat(e):"")).then((function(e){var t;n((0,p.Z)((0,p.Z)({},(0,l.s_)(h.S,m.o.GET_SUCCESS)),{},{payload:null===(t=e.body.results)||void 0===t?void 0:t.map(v.Nd)}))})).catch((function(e){return n((0,f.S3)(e,h.S))}))}},Z=t(184),b=(0,s.vU)({shuffleSuggestionsButton:{id:"browse.shuffle_suggestions_button_title",description:"Title/tooltip of the icon button to shuffle the suggestions.",defaultMessage:"Shuffle suggestions"}});function _(e,n){var t=new URLSearchParams(n);return t.append("limit",e.toString()),t.toString()}var j=function(e){var n,t=e.heading,s=e.count,p=e.filters,f=(0,o.Z)().formatMessage,g=(0,l.I0)(),h=(0,r.TH)(),m=(0,r.UO)(),v=m.recipe,j=(0,l.v9)((function(e){return e.browse.browserMini.items})),k=(0,i.useMemo)((function(){return null===j||void 0===j?void 0:j.filter((function(e){return e.slug!==v}))}),[v,j]),w=null!==(n=m.recipe)&&void 0!==n?n:"";(0,i.useEffect)((function(){g(x(_(s,p)))}),[h]);var S=(0,i.useCallback)((function(){g(x(_(s,p)))}),[g,_,s,p]),C=(0,i.useCallback)((function(e){w!==e.slug&&g(u.MA(e))}),[w,g]);return null!=k&&0===k.length?null:(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)("h2",{id:"suggestions-heading",children:t}),(0,Z.jsx)(c.Z,{id:"shuffle-suggestions-button",variant:"outline-primary",onClick:S,className:"print-hidden",tooltip:f(b.shuffleSuggestionsButton),children:(0,Z.jsx)(a.Z,{icon:"arrow-repeat",variant:"light"})}),(0,Z.jsx)(d.Z,{data:k,onOpenRecipe:C})]})}},1728:function(e,n,t){var i=t(1413),r=t(557),s=t(2791),o=t(3360),a=(t(2467),t(9276)),c=t(4858),l=t(184),u=["id","tooltip","tooltipPlacement","children"],d=(0,s.forwardRef)((function(e,n){var t=e.id,s=e.tooltip,d=e.tooltipPlacement,p=e.children,f=(0,r.Z)(e,u);return(0,l.jsx)(a.Z,{condition:Boolean(s),render:function(e){return(0,l.jsx)(c.Z,{id:"".concat(t,"-tooltip"),tooltip:s,placement:d,children:e})},children:(0,l.jsx)(o.Z,(0,i.Z)((0,i.Z)({id:t,"aria-label":s||void 0,"aria-describedby":void 0},f),{},{ref:n,children:p}))})}));n.Z=d},9827:function(e,n,t){var i=t(9551),r=t(184);n.Z=function(e){var n=e.message;return(0,r.jsxs)("div",{className:"spinner",children:[n&&(0,r.jsx)("h3",{className:"no-results",children:n}),(0,r.jsx)(i.Z,{})]})}},4138:function(e,n,t){t.d(n,{h:function(){return x}});var i=t(1413),r=t(557),s=t(2791),o=t(6221),a=t(3539),c=t(3360),l=t(5316),u=t(1694),d=t.n(u),p=(t(7493),t(78)),f=t(2605),g=t(184),h=["onClose","className"],m=["show","title","acceptTitle","closeTitle","onAccept","onClose","noCloseButton","size","acceptButtonProps","children"],v=(0,o.vU)({accept:{id:"modal.accept",description:"Default modal accept button",defaultMessage:"Accept"},close:{id:"modal.close",description:"Default modal close button",defaultMessage:"Close"}}),x=(0,s.forwardRef)((function(e,n){var t=e.onClose,s=e.className,o=(0,r.Z)(e,h),l=(0,a.Z)().formatMessage;return(0,g.jsx)(c.Z,(0,i.Z)((0,i.Z)({type:"button",onClick:t,variant:"transparent",className:d()("close-button",s),"aria-label":l(v.close)},o),{},{ref:n,children:(0,g.jsx)(p.Z,{icon:"x",variant:"light",size:"2x"})}))})),Z=(0,s.forwardRef)((function(e,n){var t=e.show,o=e.title,u=e.acceptTitle,d=e.closeTitle,p=e.onAccept,h=e.onClose,Z=e.noCloseButton,b=e.size,_=void 0===b?"lg":b,j=e.acceptButtonProps,k=e.children,w=(0,r.Z)(e,m),S=(0,a.Z)().formatMessage,C=(0,s.useCallback)((function(){null===h||void 0===h||h(!1)}),[h]),y=(0,s.useCallback)((function(){null===h||void 0===h||h(!0),null===p||void 0===p||p()}),[h,p]),M=null!=p||null!=h&&!Z;return(0,g.jsxs)(l.Z,(0,i.Z)((0,i.Z)({show:t,backdrop:"static",size:_,centered:!0,onHide:C,keyboard:!1},w),{},{ref:n,children:[(0,g.jsxs)(l.Z.Header,{children:[(0,g.jsx)(l.Z.Title,{children:o}),null!=h&&(0,g.jsx)(x,{onClose:C})]}),(0,g.jsx)(l.Z.Body,{children:(0,g.jsx)(f.Z,{verbose:!0,printStack:!0,children:k})}),M&&(0,g.jsxs)(l.Z.Footer,{children:[null!=h&&!Z&&(0,g.jsx)(c.Z,{variant:"outline-primary",onClick:C,children:null!==d&&void 0!==d?d:S(v.close)}),null!=p&&(0,g.jsx)(c.Z,(0,i.Z)((0,i.Z)({variant:"primary",onClick:y},j),{},{children:null!==u&&void 0!==u?u:S(v.accept)}))]})]}))}));n.Z=Z},1104:function(e,n,t){var i=t(1413),r=t(557),s=t(2791),o=t(3360),a=t(3504),c=t(9276),l=t(4858),u=t(184),d=["id","to","tooltip","children"],p=(0,s.forwardRef)((function(e,n){var t=e.id,s=e.to,p=e.tooltip,f=e.children,g=(0,r.Z)(e,d);return(0,u.jsx)(c.Z,{condition:Boolean(p),render:function(e){return(0,u.jsx)(l.Z,{id:"".concat(t,"-tooltip"),tooltip:p,children:e})},children:(0,u.jsx)(o.Z,(0,i.Z)((0,i.Z)({type:"button",as:a.rU,to:s,"aria-label":p},g),{},{ref:n,children:f}))})}));n.Z=p},8393:function(e,n,t){t.d(n,{Ap:function(){return v},Od:function(){return h},Ue:function(){return f},Vx:function(){return g},mc:function(){return x},zD:function(){return p}});var i=t(4165),r=t(5861),s=t(1413),o=t(7572),a=t(8263),c=t(2697),l=t(9656),u=t(7728),d=t(9492),p=function(e){return function(n){n((0,s.Z)({},(0,l.s_)(c.iD,u.o.GET_START))),(0,o.WY)().get("".concat(a.m.list).concat(e,"/")).then((function(e){var t;n((t=(0,c.m3)(e.body),(0,s.Z)((0,s.Z)({},(0,l.s_)(c.iD,u.o.GET_SUCCESS)),{},{payload:t})))})).catch((function(e){return n((0,o.S3)(e,c.iD))}))}},f=function(){var e=(0,r.Z)((0,i.Z)().mark((function e(n,t){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n((0,s.Z)({},(0,l.s_)(c.iD,u.o.CREATE_START))),e.abrupt("return",(0,o.WY)().post(a.m.list).send(t).then((function(e){var t=(0,c.m3)(e.body);n((0,s.Z)((0,s.Z)({},(0,l.s_)(c.iD,u.o.CREATE_SUCCESS)),{},{payload:t}))})).catch((function(e){return(0,o.Hn)(n,e,c.iD)})));case 2:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}(),g=function(){var e=(0,r.Z)((0,i.Z)().mark((function e(n,t,r){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n((0,s.Z)({},(0,l.s_)(c.iD,u.o.UPDATE_START))),e.abrupt("return",(0,o.WY)().patch("".concat(a.m.list).concat(t,"/")).send(r).then((function(e){var t=(0,c.m3)(e.body);n((0,s.Z)((0,s.Z)({},(0,l.s_)(c.iD,u.o.UPDATE_SUCCESS)),{},{payload:t}))})).catch((function(e){return(0,o.Hn)(n,e,c.iD)})));case 2:case"end":return e.stop()}}),e)})));return function(n,t,i){return e.apply(this,arguments)}}(),h=function(e,n){return function(t){t((0,s.Z)({},(0,l.s_)(c.iD,u.o.DELETE_START))),(0,o.WY)().delete("".concat(a.m.list).concat(n,"/")).then((function(){t((0,s.Z)((0,s.Z)({},(0,l.s_)(c.iD,u.o.DELETE_SUCCESS)),{},{payload:{id:e}}))})).catch((function(e){return t((0,o.S3)(e,c.iD))}))}};function m(e,n){return[e.quantity&&"0"!==e.quantity?e.quantity:void 0,n(e.measurement,e.quantity),e.title].filter(Boolean).join(" ")}var v=function(){var e=(0,r.Z)((0,i.Z)().mark((function e(n,t,r,p){var f,g,h;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(f=r.ingredientGroups.flatMap((function(e){return e.ingredients.map((function(e){return{list:t,title:m(e,p)}}))})),g=r.subrecipes.map((function(e){return{list:t,title:m(e,p)}})),!((h=f.concat(g)).length>0)){e.next=8;break}return n((0,s.Z)({},(0,l.s_)(c.iD,u.o.UPDATE_START))),e.abrupt("return",(0,o.WY)().post(a.m.bulk_list_item).send(h).then((function(e){n((0,s.Z)((0,s.Z)({},(0,l.s_)(c.iD,c.ri.BULK_ADD)),{},{payload:e.body.map((function(e){return(0,d.g7)(t,e)}))})),n((0,s.Z)({},(0,l.s_)(c.iD,u.o.UPDATE_SUCCESS)))})).catch((function(e){return n((0,o.S3)(e,c.iD))})));case 8:return e.abrupt("return",null);case 9:case"end":return e.stop()}}),e)})));return function(n,t,i,r){return e.apply(this,arguments)}}(),x=function(){return function(e){e((0,s.Z)({},(0,l.s_)(c.iD,u.o.RESET)))}}},92:function(e,n,t){t.d(n,{Z:function(){return d}});var i=t(2791),r=t(3539),s=t(6221),o=t(3360),a=t(78),c=t(9276),l=t(184),u=function(e){var n=e.stars,t=e.num,u=e.onChange,d=(0,r.Z)().formatMessage,p=(0,s.vU)({star_alt:{id:"rating_comments.star_alt",description:"Alt text for star button, for screen reader.",defaultMessage:"Select to rate item {stars, plural, one {# star} other {# stars}}"}}),f=(0,i.useCallback)((function(){null===u||void 0===u||u(t)}),[u,t]),g=n>t-1&&n<t,h=g?"star-half":"star",m=t>n||g?"light":"filled";return(0,l.jsx)(c.Z,{condition:null!=u,render:function(e){return(0,l.jsx)(o.Z,{variant:"transparent",className:"rating",onClick:f,children:e})},children:(0,l.jsx)(a.Z,{icon:h,variant:m,size:null!=u?"2x":"1x",ariaLabel:u?d(p.star_alt,{stars:t}):void 0},t)},t)},d=function(e){var n=e.stars,t=e.onChange,i=(0,r.Z)().formatMessage,o=(0,s.vU)({stars_alt:{id:"rating_comments.stars_alt",description:"Alt text for read-only stars (view).",defaultMessage:"{stars} out of 5 stars"}}),a=n;n>5?a=5:n<0&&(a=0);var c=Array.from({length:5},(function(e,n){return n+1})).map((function(e){return(0,l.jsx)(u,{stars:a,num:e,onChange:t},e)}));return(0,l.jsxs)("div",{className:"rating-stars",children:[(0,l.jsx)("span",{"aria-hidden":!0,children:c}),(0,l.jsx)("span",{className:"sr-only",children:i(o.stars_alt,{stars:a})})]})}},8182:function(e,n,t){t.r(n),t.d(n,{default:function(){return fn}});var i=t(2791),r=t(6871),s=t(5355),o=t(9656),a=t(4165),c=t(5861),l=t(885),u=t(9140),d=t(2290),p=t(3539),f=t(6221),g=t(9743),h=t(2677),m=t(1127),v=t(9511),x=t(9551),Z=t(3504),b=t(1694),_=t.n(b),j=t(78),k=t(4138),w=t(5139),S=t(92),C=t(1728),y=t(184),M=function(e){var n=e.rating,t=(0,p.Z)().locale;return n.updateDate&&new Date(n.updateDate).getTime()>0?(0,y.jsx)(Z.rU,{className:"rating-timestamp",to:"#rating-".concat(n.id),children:new Date(n.updateDate).toLocaleString(t)}):n.pubDate&&new Date(n.pubDate).getTime()>0?(0,y.jsx)(Z.rU,{className:"rating-timestamp",to:"#rating-".concat(n.id),children:new Date(n.pubDate).toLocaleString(t)}):null},N=function(e){var n=e.rating,t=[];return n.comment.split("\n").filter(Boolean).forEach((function(e,n){t.push((0,y.jsx)(m.Z,{children:e},"".concat(n,"-p")))})),(0,y.jsx)(y.Fragment,{children:t})},E=(0,f.vU)({delete_button:{id:"rating_comments.delete_button",description:"Label of the delete comment icon button",defaultMessage:"Delete comment"},confirm_delete_message:{id:"rating_comments.confirm_delete",description:"Are you sure you want to delete this comment?",defaultMessage:"Are you sure you want to delete this comment?"}}),T=function(e){var n=e.rating,t=e.onDelete,s=(0,p.Z)(),o=s.formatMessage,a=(0,r.TH)().hash,c=(null!==a&&void 0!==a?a:"").replace("#",""),u=(0,i.useState)(),d=(0,l.Z)(u,2),f=d[0],m=d[1],v=(0,i.useCallback)((function(e){m(e)}),[]),x=(0,i.useCallback)((function(){null===t||void 0===t||t(null!==f&&void 0!==f?f:0)}),[f]),Z=(0,i.useCallback)((function(){m(void 0)}),[]),b="rating-".concat(n.id);return(0,y.jsxs)("div",{id:b,className:_()("rating-comment",{"perma-link-active":b===c}),children:[(0,y.jsx)(w.Z,{uriFragmentId:b}),(0,y.jsxs)(g.Z,{children:[(0,y.jsxs)(h.Z,{xs:!0,children:[(0,y.jsx)(S.Z,{stars:n.rating||0}),(0,y.jsx)("div",{className:"rating-username",children:n.userName})]}),(0,y.jsxs)(h.Z,{xs:"auto",className:"d-flex",style:{alignItems:"start"},children:[(0,y.jsx)(M,{rating:n}),t&&(0,y.jsx)(C.Z,{id:"delete-".concat(n.id),variant:"outline-danger",className:"rating-delete-button",size:"sm",tooltip:o(E.delete_button),onClick:function(){return v(n.id)},children:(0,y.jsx)(j.Z,{icon:"trash"})})]})]}),(0,y.jsx)(g.Z,{children:(0,y.jsx)(h.Z,{xs:12,children:(0,y.jsx)(N,{rating:n})})}),(0,y.jsx)(k.Z,{show:null!=f,title:s.messages["recipe.confirm_delete_title"],acceptTitle:s.messages["recipe.confirm_delete_accept"],onAccept:x,onClose:Z,acceptButtonProps:{variant:"danger"},children:o(E.confirm_delete_message)})]})},R=function(e){var n,t=e.recipeSlug,r=e.ratings,s=e.userId,o=e.pending,a=e.removeRating,c=(0,p.Z)().formatMessage,l=(0,f.vU)({no_comments:{id:"rating_comments.no_comments",description:"Placeholder for no comments",defaultMessage:"(No comments yet. Be the first!)"}}),u=(0,i.useCallback)((function(e){return a(t,e)}),[a,t]),d=null!==(n=null===r||void 0===r?void 0:r.map((function(e){return(0,y.jsx)(T,{rating:e,onDelete:e.userId===s?u:void 0},e.id)})))&&void 0!==n?n:[];return(0,y.jsxs)(y.Fragment,{children:[o===v.V.LOADING&&(0,y.jsx)(x.Z,{variant:"three-bounce"}),0===d.length&&(0,y.jsx)(g.Z,{children:(0,y.jsx)(h.Z,{children:(0,y.jsx)(m.Z,{className:"placeholder",children:c(l.no_comments)})})},"be-the-first"),d]})},A=t(9795),D=t(3360),I=t(3720),U=t(9854),L=t(7547),F=t(6699),V=t(2265),B=function(e){var n=e.show,t=e.recipeSlug,r=e.userId,s=e.addRating,o=e.onAddRatingSuccess,u=(0,p.Z)().formatMessage,d=(0,f.vU)({new_rating_title:{id:"newRating.create.title",description:"Fieldset legend for creating a new rating",defaultMessage:"Your new rating"},rating_placeholder:{id:"newRating.create.rating_placeholder",description:"Rating placeholder",defaultMessage:"Rate this recipe from 0 to 5"},rating_label:{id:"newRating.create.rating_label",description:"Rating label",defaultMessage:"Rating"},rating_comment_placeholder:{id:"newRating.create.rating_comment_placeholder",description:"Rating placeholder",defaultMessage:"Leave a comment!"},rating_comment_label:{id:"newRating.create.rating_comment_label",description:"Rating label",defaultMessage:"Comments"},submit:{id:"newRating.create.submit",description:"Submit recipe button",defaultMessage:"Comment"}}),m=(0,i.useState)({rating:0,comment:""}),v=(0,l.Z)(m,1)[0],x=(0,i.useCallback)(function(){var e=(0,c.Z)((0,a.Z)().mark((function e(n){var i;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i={rating:n.rating,comment:n.comment,userId:r},e.abrupt("return",s(t,i));case 2:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),[t,r,s]);return n?(0,y.jsx)(I.l0,{initialValues:v,onSubmit:x,subscription:{},render:function(e){var n=e.form,t=e.handleSubmit;return(0,y.jsxs)(A.Z,{onSubmit:t,className:"new-rating",children:[(0,y.jsx)(V.Z,{onSubmitSuccess:o}),(0,y.jsx)(U.Z,{form:n,initialValues:v}),(0,y.jsxs)("fieldset",{children:[(0,y.jsx)("legend",{className:"new-rating-heading",children:u(d.new_rating_title)}),(0,y.jsx)(g.Z,{children:(0,y.jsxs)(h.Z,{className:"form-group required",children:[(0,y.jsx)("div",{className:"form-label",children:u(d.rating_label)}),(0,y.jsx)(I.gN,{name:"rating",validate:F.np,validateFields:[],children:function(e){return(0,y.jsx)(S.Z,{stars:e.input.value,onChange:function(n){e.input.onChange(n)}})}})]})}),(0,y.jsx)(g.Z,{children:(0,y.jsx)(h.Z,{children:(0,y.jsx)(L.Z,{name:"comment",rows:4,label:u(d.rating_comment_label),placeholder:u(d.rating_comment_placeholder),maxLength:1e3,required:!0})})}),(0,y.jsx)(g.Z,{children:(0,y.jsx)(h.Z,{xs:12,className:"toolbar",children:(0,y.jsx)(I.lP,{subscription:{values:!0,submitting:!0},children:function(e){var n=e.values,t=e.submitting;return(0,y.jsx)(D.Z,{type:"submit",variant:"primary",disabled:!n.rating||!n.comment||t,children:u(d.submit)})}})})})]})]})}}):null},P=t(9634),O=function(e){var n=e.userRole,t=e.showNewRating,i=e.onShowNewRating,r=(0,p.Z)().formatMessage,s=(0,f.vU)({title:{id:"recipe.comments.title",description:"Comments heading",defaultMessage:"Comments"},new_rating_button:{id:"recipe.comments.new_rating",description:"Label for the new rating button",defaultMessage:"New rating"}});return(0,y.jsx)(u.Z.Header,{children:(0,y.jsxs)(g.Z,{children:[(0,y.jsx)(h.Z,{className:"ratings-heading-col",children:(0,y.jsxs)("h2",{id:"ratings-heading",children:[r(s.title),(0,y.jsx)(P.Z,{linkFor:"ratings-heading"})]})}),!t&&null!=n&&[d.Z.USER,d.Z.STAFF,d.Z.ADMIN].includes(n)&&(0,y.jsx)(h.Z,{xs:"auto",children:(0,y.jsx)(D.Z,{variant:"outline-primary",onClick:i,children:r(s.new_rating_button)})})]})})},z=function(e){var n=e.recipeSlug,t=e.ratings,r=e.userId,s=e.userRole,o=e.pending,a=e.addRating,c=e.removeRating,p=(0,i.useState)(!1),f=(0,l.Z)(p,2),g=f[0],h=f[1],m=(0,i.useCallback)((function(){h(!1)}),[]);return(0,y.jsxs)(u.Z,{className:"rating-panel",as:"article",children:[(0,y.jsx)(O,{userRole:s,showNewRating:g,onShowNewRating:function(){return h(!0)}}),(0,y.jsxs)(u.Z.Body,{children:[null!=r&&null!=s&&[d.Z.USER,d.Z.STAFF,d.Z.ADMIN].includes(s)&&(0,y.jsx)(B,{show:g,recipeSlug:n,userId:r,addRating:a,onAddRatingSuccess:m}),(0,y.jsx)(R,{recipeSlug:n,ratings:t,pending:o,userId:r,removeRating:c})]})]})},G=t(1413),q=t(8869),H=t(7572),W=t(8263),Y=t(7728),K=function(){var e=(0,c.Z)((0,a.Z)().mark((function e(n,t,i){return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n((0,G.Z)({},(0,o.s_)(q.oh,Y.o.CREATE_START))),e.abrupt("return",(0,H.WY)().post(W.m.ratings).send({recipe:t,rating:i.rating,comment:i.comment,author:i.userId}).then((function(e){return n((0,G.Z)((0,G.Z)({},(0,o.s_)(q.oh,Y.o.CREATE_SUCCESS)),{},{payload:{recipe:t,rating:(0,q.IV)(e.body)}})),null})).catch((function(e){return(0,H.Hn)(n,e,q.RV)})));case 2:case"end":return e.stop()}}),e)})));return function(n,t,i){return e.apply(this,arguments)}}(),Q=t(2605),J=function(){var e=(0,o.I0)(),n=(0,o.v9)((function(e){return e.account.item})),t=(0,o.v9)((function(e){return e.recipe.item})),r=(0,o.v9)((function(e){return e.ratings})),s=null===t||void 0===t?void 0:t.slug,l=null===t||void 0===t?void 0:t.rating,u=(0,i.useCallback)(function(){var n=(0,c.Z)((0,a.Z)().mark((function n(t,i){return(0,a.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",K(e,t,i));case 1:case"end":return n.stop()}}),n)})));return function(e,t){return n.apply(this,arguments)}}(),[e]),d=(0,i.useCallback)((function(n,t){return e(function(e,n){return function(t){t((0,G.Z)({},(0,o.s_)(q.oh,Y.o.DELETE_START))),(0,H.WY)().delete("".concat(W.m.ratings).concat(n,"/")).then((function(){return t((0,G.Z)((0,G.Z)({},(0,o.s_)(q.oh,Y.o.DELETE_SUCCESS)),{},{payload:{ratingId:n,recipe:e}}))})).catch((function(e){return t((0,H.S3)(e,q.RV))}))}}(n,t))}),[e]);if((0,i.useEffect)((function(){null!=s&&null!=l&&0!==l&&e(function(e){return function(n){n((0,G.Z)({},(0,o.s_)(q.RV,Y.o.GET_START))),(0,H.WY)().get("".concat(W.m.ratings,"?recipe__slug=").concat(e)).then((function(t){return n((0,G.Z)((0,G.Z)({},(0,o.s_)(q.RV,Y.o.GET_SUCCESS)),{},{id:e,payload:Y.Z.transformEntities(t.body.results,q.IV)}))})).catch((function(e){return n((0,H.S3)(e,q.RV))}))}}(s))}),[s,l]),null==s)return null;var p=null!=s&&null!=r.items?r.items[s]:void 0;return(0,y.jsx)(Q.Z,{verbose:!0,printStack:!0,children:(0,y.jsx)(z,{recipeSlug:s,userId:null===n||void 0===n?void 0:n.id,userRole:null===n||void 0===n?void 0:n.role,ratings:p,pending:r.meta.pending,addRating:u,removeRating:d})})},X=t(3976),$=t(6693);function ee(e){var n={};return e.course&&(n.course__slug=e.course.title),e.cuisine&&(n.cuisine__slug=e.cuisine.title),Object.keys(n).length>0?n:void 0}var ne=function(e){var n=e.recipe,t=(0,p.Z)(),i=(0,o.v9)((function(e){return e.browse.browserMini.meta}));return i.hasConnection&&!i.error&&null!==n&&void 0!==n&&n.author?(0,y.jsxs)(Q.Z,{verbose:!0,printStack:!0,children:[(0,y.jsx)("hr",{}),(0,y.jsx)("article",{className:"recipe-footer",children:(0,y.jsx)($.Z,{heading:t.messages["nav.home.recommended_recipes_title"],count:4,filters:ee(n)})})]}):null},te=t(1884),ie=t(297),re=(t(3541),t(9827)),se=(t(1420),t(4349)),oe=t(4421),ae=(0,f.vU)({ingredients:{id:"recipe.ingredients",description:"Ingredients",defaultMessage:"Ingredients"},ingredients_for_servings:{id:"recipe.ingredients_for_servings",description:"Ingredients for[ n servings]",defaultMessage:"Ingredients for"},servings:{id:"recipe.servings",description:"Servings",defaultMessage:"Servings"},servings_input_tooltip:{id:"recipe.servings_input_tooltip",description:"Accessible tooltip for the (change) servings input",defaultMessage:"Amount of servings"},servings_update_button:{id:"recipe.servings_update_button",description:"Label for the button to change the servings",defaultMessage:"Update servings"}}),ce=function(e){var n,t,r=e.recipe,s=e.recipeMeta,o=e.updateServings,l=(0,p.Z)().formatMessage,u=null===r||void 0===r?void 0:r.customServings,d=(0,i.useCallback)(function(){var e=(0,c.Z)((0,a.Z)().mark((function e(n){return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",o(n.servings));case 1:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),[o]),f=(0,i.useMemo)((function(){return{servings:u}}),[u]),g=s.pending,h=null!==(n=null===r||void 0===r?void 0:r.customServings)&&void 0!==n?n:0,m=g===v.V.COMPLETED&&null!=(null===r||void 0===r?void 0:r.subrecipes)&&0===r.subrecipes.length&&null!=(null===r||void 0===r?void 0:r.ingredientGroups)&&0===r.ingredientGroups.length;return(0,y.jsxs)(y.Fragment,{children:[(m||0===h)&&(0,y.jsxs)("h2",{id:"ingredients-heading",children:[l(ae.ingredients),(0,y.jsx)(P.Z,{linkFor:"ingredients-heading"})]}),!m&&h>0&&(0,y.jsxs)("div",{className:"ingredients-for-servings-row",children:[(0,y.jsxs)("h2",{id:"ingredients-heading",children:[l(ae.ingredients_for_servings),(0,y.jsx)(P.Z,{linkFor:"ingredients-heading"}),(0,y.jsx)("span",{className:"print-only",children:": ".concat(null!==(t=null===r||void 0===r?void 0:r.customServings)&&void 0!==t?t:""," ").concat(l(ae.servings))})]}),(0,y.jsx)("div",{className:"custom-servings print-hidden",children:(0,y.jsx)(I.l0,{initialValues:f,onSubmit:d,subscription:{},render:function(e){var n=e.form,t=e.handleSubmit;return(0,y.jsxs)(A.Z,{onSubmit:t,className:"custom-servings",children:[(0,y.jsx)(U.Z,{form:n,initialValues:f}),(0,y.jsx)(L.Z,{name:"servings",type:"number","aria-label":l(ae.servings_input_tooltip),min:0,max:1e3,autoComplete:"off"}),(0,y.jsxs)(D.Z,{type:"submit",variant:"primary","aria-label":l(ae.servings_update_button),children:[(0,y.jsx)(j.Z,{icon:"arrow-repeat",variant:"light"}),l(ae.servings)]})]})}})})]})]})},le=t(9276),ue=t(2982),de=t(6569),pe=t(2951),fe=t(9263),ge=t(8393),he=t(557),me=t(6844),ve=["name","required","data","format","parse","onChange","onFocus","onBlur"],xe=(0,i.forwardRef)((function(e,n){var t=e.name,i=e.required,r=e.data,s=e.format,o=e.parse,a=e.onChange,c=e.onFocus,l=e.onBlur,u=(0,he.Z)(e,ve),d=(0,p.Z)();return(0,y.jsx)(I.gN,{name:t,validate:i?F.np:void 0,validateFields:[],format:s,parse:o,children:function(e){return(0,y.jsx)(me.P,(0,G.Z)((0,G.Z)({},u),{},{required:i,name:e.input.name,value:e.input.value,data:r,errors:(0,F.fr)(d,e.meta.error||(e.meta.dirtySinceLastSubmit?void 0:e.meta.submitError)),meta:e.meta,onChange:function(n,t){e.input.onChange(t),null===a||void 0===a||a(n,t)},onFocus:function(n){e.input.onFocus(n),null===c||void 0===c||c(n)},onBlur:function(n){e.input.onBlur(n),null===l||void 0===l||l(n)},ref:n}))}})})),Ze=t(7847),be=t(7812);function _e(e){var n={};return e.forEach((function(e){n[e]=!0})),n}function je(e){var n={};return e.forEach((function(e){n[e.slug]=(0,G.Z)({},_e(e.ingredients.flatMap((function(e){return"cb-".concat(e.id)}))))})),n}var ke=(0,i.forwardRef)((function(e,n){var t=e.lists,r=e.subrecipes,s=e.ingredients,o=e.onSubmit,u=e.onSubmitSuccess,d=e.onAddList,p=e.submitRef,f=(0,pe.Z)(),m=(0,i.useState)({list:t.length>0?t[t.length-1].id.toString():void 0,ingredients:je(s),subrecipes:(0,G.Z)({},_e(r.flatMap((function(e){return"cb-".concat(e.child_recipe_id)}))))}),v=(0,l.Z)(m,1)[0],x=(0,i.useCallback)(function(){var e=(0,c.Z)((0,a.Z)().mark((function e(n){var t,i,r,c;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=[],Object.keys(n.subrecipes).forEach((function(e){n.subrecipes[e]&&i.push(parseInt(e.substring(e.indexOf("-")+1)))})),r=[],Object.keys(null!==(t=n.ingredients)&&void 0!==t?t:{}).forEach((function(e){var t=new Set,i=s.find((function(n){return n.slug===e}));if(i){var o=n.ingredients[e];Object.keys(o).forEach((function(e){o[e]&&t.add(parseInt(e.substring(e.indexOf("-")+1)))})),Object.keys(o).length>0&&r.push({slug:i.slug,title:i.title,ingredients:Array.from(t)})}else f('Invalid state: There is not IngredientGroup for slug "'.concat(e,'"'))})),c={list:parseInt(n.list),ingredients:r,subrecipes:(a=i,Array.from(new Set(a)))},e.abrupt("return",o(c));case 6:case"end":return e.stop()}var a}),e)})));return function(n){return e.apply(this,arguments)}}(),[s,o]);return(0,y.jsx)(I.l0,{initialValues:v,onSubmit:x,subscription:{},render:function(e){var i=e.form,o=e.handleSubmit;return(0,y.jsxs)(A.Z,{onSubmit:o,ref:n,children:[(0,y.jsx)(V.Z,{onSubmitSuccess:u}),(0,y.jsx)(U.Z,{form:i,initialValues:v}),(0,y.jsx)(Se,{lists:t,form:i,onAddList:d}),t.length>0&&(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(g.Z,{className:"additional-checkbox-row",children:(0,y.jsx)(h.Z,{children:(0,y.jsx)(Ce,{name:"toggle-all",form:i})})}),(0,y.jsx)(g.Z,{className:"ingredients-and-subrecipes",children:(0,y.jsxs)(h.Z,{children:[(0,y.jsx)(se.Z,{subRecipes:r,selectable:!0}),(0,y.jsx)(oe.Z,{groups:s,hasSubrecipes:null!=r&&r.length>0,selectable:!0})]})})]}),(0,y.jsx)("button",{type:"submit",ref:p,className:"visibility-hidden",children:"Submit"})]})}})})),we=(0,f.vU)({list:{id:"grocery_list.form.list",defaultMessage:"List"},new_text:{id:"grocery_list.item.new_text",defaultMessage:"Create a new grocery list to get started."},new_list_title:{id:"grocery_list.item.new_title",defaultMessage:"My grocery list"}}),Se=function(e){var n=e.lists,t=e.form,r=e.onAddList,s=(0,p.Z)(),o=s.formatMessage,a=(0,i.useState)(!1),c=(0,l.Z)(a,2),u=c[0],d=c[1],f=(0,i.useRef)(),v=(0,i.useCallback)((function(){var e="".concat(o(we.new_list_title)),t=n.filter((function(n){return n.title.startsWith(e)})).map((function(n){return parseInt(n.title.substring(e.length))})).filter((function(e){return!Number.isNaN(e)||e<0})).sort((function(e,n){return e-n})),i=t.length>0?t[t.length-1]+1:1;f.current=n.map((function(e){return e.id})),r({title:"".concat(e," ").concat(i)}).then((function(){d(!0)}))}),[n,r,o]);return(0,i.useEffect)((function(){if(null!=f.current){var e=n.map((function(e){return e.id})).find((function(e){var n;return!(null!==(n=f.current)&&void 0!==n&&n.includes(e))}));e&&(t.change("list",e.toString()),f.current=[])}}),[n]),(0,y.jsx)(g.Z,{children:(0,y.jsxs)(h.Z,{className:"input-with-button",children:[0===n.length&&(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(m.Z,{children:o(we.new_text)}),(0,y.jsx)(C.Z,{id:"add-list-button",type:"button",onClick:v,variant:"primary",className:"add-list-button",children:s.messages["nav.grocery_list_create"]})]}),n.length>0&&(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(xe,{name:"list",label:o(we.list),data:n.map((function(e){return{value:e.id.toString(),label:e.title}})),readOnly:0===n.length,disabled:0===n.length}),!u&&(0,y.jsx)(C.Z,{id:"add-list-button",type:"button",onClick:v,variant:"transparent",className:"add-list-button",tooltip:s.messages["nav.grocery_list_create"],children:(0,y.jsx)(j.Z,{icon:"plus-lg",variant:"light",size:"2x"})})]})]})})},Ce=function(e){var n=e.name,t=e.form,r=(0,p.Z)(),s=(0,i.useState)(!0),o=(0,l.Z)(s,2),a=o[0],c=o[1],u=(0,i.useCallback)((function(e,n){c(n);var i=t.getRegisteredFields(),r=i.filter((function(e){return e.startsWith("ingredients.")&&e.includes("cb-")})),s=i.filter((function(e){return e.startsWith("subrecipes.")&&e.includes("cb-")}));[].concat((0,ue.Z)(r),(0,ue.Z)(s)).forEach((function(e){t.change(e,n)}))}),[t]);return(0,y.jsx)(de.Z,{name:n,label:r.messages["grocery_list.items.toggle_all"],value:a,onChange:u})},ye=function(e){var n=e.show,t=e.subrecipes,r=e.ingredients,s=e.onSaveSuccess,l=e.onClose,u=(0,p.Z)(),d=(0,o.I0)(),f=(0,i.useContext)(Ze.Z),g=(0,i.useCallback)((function(e,n){return(0,be.Q)(u,f,e,n)}),[f,u]),h=(0,i.useCallback)(function(){var e=(0,c.Z)((0,a.Z)().mark((function e(n,t){return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",ge.Ap(d,n,t,g));case 1:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}(),[d]),m=(0,i.useCallback)(function(){var e=(0,c.Z)((0,a.Z)().mark((function e(n){return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",ge.Ue(d,n));case 1:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),[d]),x=(0,o.v9)((function(e){return e.groceryLists})).items;(0,i.useEffect)((function(){d(fe.z())}),[]);var Z=(0,o.v9)((function(e){return e.groceryList.meta.pending})),b=(0,i.useRef)(null),_=(0,i.useCallback)((function(){var e;null===(e=b.current)||void 0===e||e.click()}),[b.current]),j=(0,i.useCallback)(function(){var e=(0,c.Z)((0,a.Z)().mark((function e(n){var i,s,o,c,l,u;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=null!==(i=null===r||void 0===r?void 0:r.flatMap((function(e){return e.ingredients})))&&void 0!==i?i:[],o=null!=t?(0,ue.Z)(t):[],c=[],n.ingredients.forEach((function(e){var n=e.ingredients.map((function(e){return s.find((function(n){return n.id===e}))})).filter(Boolean);e.ingredients.length>0&&c.push({slug:e.slug,title:e.title,ingredients:n})})),l=o.filter((function(e){return n.subrecipes.includes(e.child_recipe_id)})),u={ingredientGroups:c,subrecipes:l},e.abrupt("return",h(n.list,u));case 7:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),[r,t,h]),w=(0,i.useCallback)((function(){s(),l()}),[s,l]),S=(0,i.useCallback)((function(e){e||l()}),[l]);return n&&null!=x&&null!=t&&null!=r?(0,y.jsx)(k.Z,{show:n,title:u.messages["recipe.recipe_ingredient_button.add_groceries"],onAccept:_,acceptButtonProps:{disabled:0===x.length||Z===v.V.SAVING},onClose:S,className:"add-to-grocery-list-modal",children:(0,y.jsx)(ke,{lists:x,subrecipes:t,ingredients:r,onSubmit:j,onSubmitSuccess:w,onAddList:m,submitRef:b})}):null},Me=t(3847),Ne=(0,f.vU)({add_groceries:{id:"recipe.recipe_ingredient_button.add_groceries",description:"Add groceries to list",defaultMessage:"Add to grocery list"},add_groceries_success_toast:{id:"recipe.recipe_ingredient_button.success_toast",description:"Add groceries to list success toast",defaultMessage:"Groceries added to the list."}}),Ee=function(e){var n=e.isAuthenticated,t=e.subrecipes,r=e.ingredients,s=(0,p.Z)().formatMessage,o=(0,i.useState)(!1),a=(0,l.Z)(o,2),c=a[0],u=a[1],d=(0,i.useCallback)((function(){u(!0)}),[]),f=(0,i.useCallback)((function(){u(!1)}),[]),g=(0,i.useState)(!1),h=(0,l.Z)(g,2),m=h[0],v=h[1],x=(0,i.useCallback)((function(){v(!0)}),[]),b=(0,i.useCallback)((function(){v(!1)}),[]);return(0,y.jsxs)("div",{className:"ingredients-footer print-hidden",children:[(0,y.jsx)(le.Z,{condition:!n,render:function(e){return(0,y.jsx)(Z.rU,{to:(0,te.qC)("/login"),children:e})},children:(0,y.jsxs)(D.Z,{onClick:d,variant:"primary",disabled:(0,te.s6)(),children:[(0,y.jsx)(j.Z,{icon:"clipboard2-check"}),s(Ne.add_groceries)]})}),(0,y.jsx)(ye,{show:c,subrecipes:t,ingredients:r,onClose:f,onSaveSuccess:x}),(0,y.jsx)(Me.Z,{show:m,variant:"success",anchorOrigin:{horizontal:"center",vertical:"bottom"},onClose:b,children:s(Ne.add_groceries_success_toast)})]})},Te=(0,f.vU)({no_ingredients:{id:"recipe.recipe_ingredient_button.no_ingredients",description:"No ingredients provided message",defaultMessage:"(This recipe has no ingredients.)"}}),Re=function(e){var n=e.recipe,t=e.recipeMeta,i=e.userId,r=e.updateServings,s=(0,p.Z)().formatMessage,o=t.pending,a=o===v.V.COMPLETED&&null!=(null===n||void 0===n?void 0:n.subrecipes)&&0===n.subrecipes.length&&null!=(null===n||void 0===n?void 0:n.ingredientGroups)&&0===n.ingredientGroups.length;return(0,y.jsxs)("article",{className:"ingredients-panel",children:[(0,y.jsx)(ce,{recipe:n,recipeMeta:t,updateServings:r}),o===v.V.LOADING&&null==(null===n||void 0===n?void 0:n.ingredientGroups)&&(0,y.jsx)(re.Z,{}),a&&(0,y.jsx)(m.Z,{className:"placeholder",children:s(Te.no_ingredients)}),!a&&(0,y.jsxs)(y.Fragment,{children:[(0,y.jsxs)("div",{className:"ingredient-groups",children:[(0,y.jsx)(se.Z,{withHeaderLink:!0,subRecipes:null===n||void 0===n?void 0:n.subrecipes}),(0,y.jsx)(oe.Z,{withHeaderLink:!0,groups:null===n||void 0===n?void 0:n.ingredientGroups,hasSubrecipes:null!=(null===n||void 0===n?void 0:n.subrecipes)&&(null===n||void 0===n?void 0:n.subrecipes.length)>0})]}),(0,y.jsx)(Ee,{subrecipes:null===n||void 0===n?void 0:n.subrecipes,ingredients:null===n||void 0===n?void 0:n.ingredientGroups,isAuthenticated:null!=i})]})]})},Ae=function(e){var n,t=e.recipe,r=e.recipeMeta,s=e.userId,a=(0,o.I0)(),c=(0,Z.lr)(),u=(0,l.Z)(c,2),d=u[0],p=u[1],f=null!==(n=null===t||void 0===t?void 0:t.slug)&&void 0!==n?n:"",g=(0,i.useCallback)((function(e){return p((0,G.Z)((0,G.Z)({},d),{},{servings:String(e)})),a((0,ie.ln)(f,e))}),[d,f,a]),h=(0,i.useMemo)((function(){var e=d.get("servings");if(e){var n=Number.parseFloat(e);if(!Number.isNaN(n))return n}}),[d]),m=null===t||void 0===t?void 0:t.customServings;return(0,i.useEffect)((function(){h&&h!==m&&g(h)}),[g,h,m]),(0,y.jsx)(Re,{recipe:t,recipeMeta:r,userId:s,updateServings:g})},De=t(6814),Ie=t(6956),Ue=t(9377),Le=t(5316),Fe=["className","children"],Ve=["onClose","children"],Be=(0,i.forwardRef)((function(e,n){var t=e.className,r=e.children,s=(0,he.Z)(e,Fe),o=(0,i.useState)(!1),a=(0,l.Z)(o,2),c=a[0],u=a[1],d=(0,i.useCallback)((function(){u(!0)}),[]),p=(0,i.useCallback)((function(){u(!1)}),[]);return(0,y.jsxs)(Q.Z,{verbose:!1,printStack:!1,children:[(0,y.jsx)(D.Z,(0,G.Z)((0,G.Z)({type:"button",className:_()("image-viewer",t),onClick:d},s),{},{ref:n,children:r})),(0,y.jsx)(Le.Z,{show:c,fullscreen:!0,onHide:p,className:"image-viewer-dialog",children:(0,y.jsx)(Q.Z,{verbose:!0,printStack:!0,children:(0,y.jsx)(Pe,{onClose:p,children:r})})})]})})),Pe=(0,i.forwardRef)((function(e,n){var t=e.onClose,r=e.children,s=(0,he.Z)(e,Ve),o="";i.Children.forEach(r,(function(e){if((0,i.isValidElement)(e)){var n=e.props.src;o=n}}));var a=o.includes("/")?o.substring(o.lastIndexOf("/")+1):o;return(0,y.jsxs)(y.Fragment,{children:[(0,y.jsxs)(Le.Z.Header,(0,G.Z)((0,G.Z)({},s),{},{ref:n,children:[(0,y.jsx)(Le.Z.Title,{children:a}),(0,y.jsx)("a",{title:a,download:a,href:o,className:"btn btn-transparent close-button download-button",children:(0,y.jsx)(j.Z,{icon:"download",variant:"light",size:"2x"})}),(0,y.jsx)(k.h,{onClose:t})]})),(0,y.jsx)(Le.Z.Body,{children:r})]})})),Oe=Be,ze=(0,i.createContext)(null),Ge=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.onError,t=e.onRequest,r=e.onRelease,s=(0,i.useState)(),o=(0,l.Z)(s,2),u=o[0],d=o[1],p=(0,i.useRef)(null),f="undefined"!==typeof window&&"wakeLock"in navigator,g=(0,i.useCallback)((0,c.Z)((0,a.Z)().mark((function e(){var i,s,o,c=arguments;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=c.length>0&&void 0!==c[0]?c[0]:"screen",s=null!=p.current,f){e.next=5;break}return console.warn('Calling the "request" function has no effect, Wake Lock Screen API isn\'t supported.'),e.abrupt("return");case 5:if(!s){e.next=8;break}return console.warn('Calling "request" multiple times without "release" has no effect.'),e.abrupt("return");case 8:return e.prev=8,e.next=11,navigator.wakeLock.request(i);case 11:p.current=e.sent,p.current.onrelease=function(e){var n;d(null===(n=p.current&&p.current.released)||void 0===n||n),r&&r(e),p.current=null},null===t||void 0===t||t(),d(null!==(o=p.current&&p.current.released)&&void 0!==o&&o),e.next=20;break;case 17:e.prev=17,e.t0=e.catch(8),n?n(e.t0):console.error(null===e.t0||void 0===e.t0?void 0:e.t0.message);case 20:case"end":return e.stop()}}),e,null,[[8,17]])}))),[f,t,n,r]),h=(0,i.useCallback)((0,c.Z)((0,a.Z)().mark((function e(){var n;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=null==p.current,f){e.next=4;break}return console.warn('Calling the "release" function has no effect, Wake Lock Screen API isn\'t supported.'),e.abrupt("return");case 4:if(!n){e.next=7;break}return console.warn("Calling `release` before `request` has no effect."),e.abrupt("return");case 7:if(!p.current){e.next=10;break}return e.next=10,p.current.release();case 10:case"end":return e.stop()}}),e)}))),[f]);return{isSupported:f,request:g,released:u,release:h,type:p.current&&p.current.type||void 0}},qe=(0,f.vU)({activate_cooking_mode_tooltip:{id:"recipe.activate_cooking_mode_tooltip",description:"Tooltip displayed when hovering the activate cooking mode button",defaultMessage:"Keep display awake."},deactivate_cooking_mode_tooltip:{id:"recipe.deactivate_cooking_mode_tooltip",description:"Tooltip displayed when hovering the deactivate cooking mode button",defaultMessage:"Release the display wake lock."}}),He=function(){var e,n=(0,p.Z)().formatMessage,t=Ge().isSupported,r=(0,i.useContext)(ze),s=null!==(e=null===r||void 0===r?void 0:r.cookingMode)&&void 0!==e&&e,o=(0,i.useCallback)((function(){null===r||void 0===r||r.setCookingMode(!s)}),[null===r||void 0===r?void 0:r.setCookingMode,s]);return t?(0,y.jsx)(C.Z,{id:"cooking-mode-toggle",variant:s?"primary":"outline-primary",onClick:o,tooltip:n(s?qe.deactivate_cooking_mode_tooltip:qe.activate_cooking_mode_tooltip),children:(0,y.jsx)(j.Z,{icon:"stopwatch",variant:s?"filled":"light"})}):null},We=t(1104),Ye=(0,f.vU)({edit_tooltip:{id:"recipe.edit_tooltip",description:"Tooltip displayed when hovering the edit recipe icon button",defaultMessage:"Edit this recipe"},delete_tooltip:{id:"recipe.delete_tooltip",description:"Tooltip displayed when hovering the delete recipe icon button",defaultMessage:"Delete this recipe"},print_tooltip:{id:"recipe.print_tooltip",description:"Tooltip displayed when hovering the print icon button",defaultMessage:"Print this recipe"},recipe_comments:{id:"recipe.comments",description:"Button to comments",defaultMessage:"Comments"},prep_time:{id:"recipe.prep_time",description:"Preparation time",defaultMessage:"Prep time"},cooking_time:{id:"recipe.cooking_time",description:"Cooking time",defaultMessage:"Cooking time"},minutes:{id:"recipe.minutes",description:"minutes",defaultMessage:"minutes"},source:{id:"recipe.source",description:"Source of the recipe",defaultMessage:"Source"},created_by:{id:"recipe.created_by",description:"Created by",defaultMessage:"Created by"},last_updated:{id:"recipe.last_updated",description:"Last Updated",defaultMessage:"Last Updated"},confirm_delete_title:{id:"recipe.confirm_delete_title",description:"Confirm deletion - dialog title",defaultMessage:"Confirm deletion"},confirm_delete_message:{id:"recipe.confirm_delete",description:"Are you sure you want to delete this recipe?",defaultMessage:"Are you sure you want to delete this recipe?"},confirm_delete_accept:{id:"recipe.confirm_delete_accept",description:"Confirm deletion - Accept button title",defaultMessage:"Delete"}}),Ke=function(e){var n,t,r,s=e.recipe,o=e.userIsAuthor,a=e.onEditRecipe,c=e.deleteRecipe,u=(0,p.Z)(),d=u.formatMessage,f=(0,i.useCallback)((function(){a()}),[a]),v=(0,i.useState)(!1),x=(0,l.Z)(v,2),Z=x[0],b=x[1],_=(0,i.useCallback)((function(){b(!0)}),[]),w=(0,i.useCallback)((function(){c()}),[c]),M=(0,i.useCallback)((function(){b(!1)}),[]),N=o?(0,y.jsx)(We.Z,{id:"edit-recipe-button",variant:"outline-primary",tooltip:d(Ye.edit_tooltip),to:(0,te.qC)("/recipe/edit/".concat(null===s||void 0===s?void 0:s.slug)),onClick:f,size:"sm",children:(0,y.jsx)(j.Z,{icon:"pencil"})}):null,E=o?(0,y.jsx)(C.Z,{id:"trash-recipe-button",variant:"outline-danger",size:"sm",onClick:_,tooltip:d(Ye.delete_tooltip),children:(0,y.jsx)(j.Z,{icon:"trash"})}):null,T=(0,i.useMemo)((function(){if(null!==s&&void 0!==s&&s.source){var e="";if(null!==s&&void 0!==s&&s.source&&s.source.match(/(http(s)?:\/\/.)?(www\.)?[-a-zA-Z0-9@:%._+~#=]{2,256}\.[a-z]{2,6}\b([-a-zA-Z0-9@:%_+.~#?&//=]*)/g)){var n=document.createElement("a");n.href=s.source,e=n.hostname}return(0,y.jsxs)("div",{children:["".concat(d(Ye.source),": "),e.length>0&&(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)("a",{href:s.source,target:"_blank",rel:"noreferrer",className:"print-hidden",children:e}),(0,y.jsx)("a",{href:s.source,target:"_blank",rel:"noreferrer",className:"print-only",children:s.source})]}),0===e.length&&s.source]})}return null}),[null===s||void 0===s?void 0:s.source]),R=(0,y.jsx)(C.Z,{id:"print-recipe-button",variant:"outline-primary",onClick:window.print,tooltip:d(Ye.print_tooltip),children:(0,y.jsx)(j.Z,{icon:"printer"})}),A=(0,y.jsx)("div",{className:"options print-hidden",children:(0,y.jsxs)("div",{className:"options-wrapper",children:[o&&(0,y.jsxs)(y.Fragment,{children:[N,E]}),(0,y.jsx)(He,{}),R]})}),D=null!=s?(0,y.jsxs)(y.Fragment,{children:[(0,y.jsxs)("div",{className:"recipe-header-chips",children:[null!=s.prepTime&&s.prepTime>0&&(0,y.jsxs)(De.Z,{variant:"secondary",children:[(0,y.jsx)(j.Z,{icon:"clock"}),"".concat(d(Ye.prep_time),": "),s.prepTime," ".concat(d(Ye.minutes))]}),null!=s.cookTime&&s.cookTime>0&&(0,y.jsxs)(De.Z,{variant:"secondary",children:[(0,y.jsx)(j.Z,{icon:"clock"}),"".concat(d(Ye.cooking_time),": "),s.cookTime," ".concat(d(Ye.minutes))]}),null!=s.course&&null!=s.course.title&&s.course.title.length>0&&(0,y.jsxs)(De.Z,{variant:"secondary",children:[(0,y.jsx)(j.Z,{icon:"bar-chart"}),(0,te.kT)(u,"course.",s.course.title)]}),null!=s.cuisine&&null!=s.cuisine.title&&s.cuisine.title.length>0&&(0,y.jsxs)(De.Z,{variant:"secondary",children:[(0,y.jsx)(j.Z,{icon:"globe",variant:"light"}),(0,te.kT)(u,"cuisine.",s.cuisine.title)]})]}),(0,y.jsxs)("div",{className:"recipe-header-chips",children:[(0,y.jsxs)(De.Z,{variant:"secondary",children:[(0,y.jsx)(j.Z,{icon:"calendar"}),(null===s||void 0===s?void 0:s.updateDate)&&new Date(s.updateDate).toLocaleDateString(u.locale)]}),(0,y.jsxs)(De.Z,{variant:"secondary",children:[(0,y.jsx)(j.Z,{icon:"person"}),null!==(n=null===s||void 0===s?void 0:s.username)&&void 0!==n?n:""]})]}),null!=s.tags&&s.tags.length>0&&(0,y.jsx)("div",{className:"recipe-header-chips",children:s.tags.map((function(e){return(0,y.jsx)(De.Z,{variant:"secondary",children:(0,te.kT)(u,"tag.",e.title)},String(e.title))}))})]}):null;return(0,y.jsxs)(y.Fragment,{children:[(0,y.jsxs)("article",{className:"recipe-header",children:[(0,y.jsx)("h1",{className:"d-block d-xl-none",children:null===s||void 0===s?void 0:s.title}),(0,y.jsxs)(g.Z,{className:"flex-row-reverse justify-content-center",children:[null!=s&&s.photo&&(0,y.jsxs)(y.Fragment,{children:[(0,y.jsxs)(h.Z,{xl:6,lg:12,className:"img-wrapper print-hidden",children:[(0,y.jsx)(Ie.Z,{height:66.67,width:100,children:(0,y.jsx)(Oe,{children:(0,y.jsx)(Ue.Z,{src:s.photo,alt:"",className:"img-responsive print-hidden"})})}),A]}),(0,y.jsx)(h.Z,{sm:7,xs:12,className:"col-sm-push-5 print-only",children:(0,y.jsx)(Ie.Z,{height:66.67,width:100,className:"print-only print-image",children:(0,y.jsx)(Oe,{children:(0,y.jsx)(Ue.Z,{src:null!==(t=s.photoThumbnail)&&void 0!==t?t:s.photo,alt:""})})})})]}),null!=s&&!s.photo&&A,(0,y.jsxs)(h.Z,{xl:6,lg:12,className:"info-wrapper",children:[(0,y.jsx)("h1",{className:"d-none d-xl-block",children:null===s||void 0===s?void 0:s.title}),(0,y.jsx)(m.Z,{children:null===s||void 0===s?void 0:s.info}),(0,y.jsx)(S.Z,{stars:null!==(r=null===s||void 0===s?void 0:s.rating)&&void 0!==r?r:0}),D,T]})]})]}),(0,y.jsx)(k.Z,{show:Z,title:d(Ye.confirm_delete_title),acceptTitle:d(Ye.confirm_delete_accept),acceptButtonProps:{variant:"danger"},onAccept:w,onClose:M,className:"delete",children:d(Ye.confirm_delete_message)})]})},Qe=(t(4786),t(9024)),Je=(0,f.vU)({directions:{id:"recipe.directions",description:"Directions",defaultMessage:"Directions"},no_directions:{id:"recipe.directions.no_directions",description:"No directions provided message",defaultMessage:"(This recipe has no directions.)"}}),Xe=function(e){var n=e.directions,t=e.recipeMeta,i=e.ingredients,r=(0,p.Z)().formatMessage,s=t.pending,o=s===v.V.COMPLETED&&n.trim().length<=1,a=n.includes(":\n");return(0,y.jsxs)("article",{className:_()("directions-panel",{"multi-directions":a}),children:[(0,y.jsxs)("h2",{id:"directions-heading",children:[r(Je.directions),(0,y.jsx)(P.Z,{linkFor:"directions-heading"})]}),s===v.V.LOADING&&""===n&&(0,y.jsx)(re.Z,{}),o&&(0,y.jsx)(m.Z,{className:"placeholder",children:r(Je.no_directions)}),!o&&(0,y.jsx)("div",{className:"direction-groups",children:(0,y.jsx)(Qe.Z,{directions:n,ingredients:i})})]})},$e=function(e){var n,t,i=e.recipe,r=e.recipeMeta,s=e.userId,o=e.onEditRecipe,a=e.deleteRecipe;return(0,y.jsxs)("div",{className:"recipe-details",children:[(0,y.jsx)(Ke,{recipe:i,userIsAuthor:null!=s&&s===(null===i||void 0===i?void 0:i.author),onEditRecipe:o,deleteRecipe:a}),(0,y.jsx)("hr",{}),(0,y.jsxs)(g.Z,{children:[(0,y.jsx)(h.Z,{xl:4,lg:12,children:(0,y.jsx)(Ae,{recipe:i,recipeMeta:r,userId:s})}),(0,y.jsx)("hr",{className:"d-block d-xl-none"}),(0,y.jsx)(h.Z,{xl:8,lg:12,children:(0,y.jsx)(Xe,{directions:null!==(n=null===i||void 0===i?void 0:i.directions)&&void 0!==n?n:"",recipeMeta:r,ingredients:null!==(t=null===i||void 0===i?void 0:i.ingredientGroups)&&void 0!==t?t:[]})})]})]})},en=t(5208),nn=function(e){var n=e.children,t=(0,i.useState)(!1),r=(0,l.Z)(t,2),s=r[0],o=r[1],a=(0,i.useCallback)((function(e){o(e)}),[]),c=(0,i.useMemo)((function(){return{cookingMode:s,setCookingMode:a}}),[s]);return(0,y.jsx)(ze.Provider,{value:c,children:n})},tn="undefined"!==typeof document,rn=[{hidden:"hidden",event:"visibilitychange",state:"visibilityState"},{hidden:"webkitHidden",event:"webkitvisibilitychange",state:"webkitVisibilityState"},{hidden:"mozHidden",event:"mozvisibilitychange",state:"mozVisibilityState"},{hidden:"msHidden",event:"msvisibilitychange",state:"msVisibilityState"},{hidden:"oHidden",event:"ovisibilitychange",state:"oVisibilityState"}],sn=tn&&Boolean(document.addEventListener),on=function(){var e;return sn&&null!==(e=rn.find((function(e){return e.hidden in document})))&&void 0!==e?e:null}(),an=function(){if(!on)return[!0,"visible"];var e=on.hidden,n=on.state;return[!document[e],document[n]]},cn=sn&&on,ln=function(){var e=an(),n=(0,l.Z)(e,1)[0],t=(0,i.useState)(n),r=(0,l.Z)(t,2),s=r[0],o=r[1];return(0,i.useEffect)((function(){if(cn&&on){document.addEventListener(on.event,(function(){var e=an(),n=(0,l.Z)(e,1)[0];o(n)}))}return function(){if(cn&&on){document.removeEventListener(on.event,(function(){var e=an(),n=(0,l.Z)(e,1)[0];o(n)}))}}}),[]),s},un=(0,f.vU)({activated_cooking_mode_toast:{id:"recipe.activated_cooking_mode_toast",description:"Toast displayed when activating the cooking mode button",defaultMessage:"Your display will stay awake now.\nHappy cooking!"},still_cooking_modal_title:{id:"recipe.still_cooking_modal_title",description:"Title of the modal to ask to continue keeping the display awake.",defaultMessage:"Still cooking?"},still_cooking_modal_text:{id:"recipe.still_cooking_modal_text",description:"Body text of the modal to ask to continue keeping the display awake.",defaultMessage:"Do you want to continue keeping the display awake?"},still_cooking_modal_yes:{id:"recipe.still_cooking_modal_yes",description:"Yes button.",defaultMessage:"Yes"},still_cooking_modal_no:{id:"recipe.still_cooking_modal_no",description:"no button.",defaultMessage:"No"}}),dn=function(){var e,n,t=(0,p.Z)().formatMessage,r=(0,i.useContext)(ze),s=null!==(e=null===r||void 0===r?void 0:r.cookingMode)&&void 0!==e&&e,o=(0,i.useState)(!1),a=(0,l.Z)(o,2),c=a[0],u=a[1],d=(0,i.useState)(!1),f=(0,l.Z)(d,2),g=f[0],h=f[1],m=Ge(),v=m.isSupported,x=m.request,Z=m.release,b=m.released,_=ln();(0,i.useEffect)((function(){v&&s&&(_?x():!1===b&&Z())}),[_]),(0,i.useEffect)((function(){s?v&&x().then((function(){j(),setTimeout((function(){u(!0)}),1)})):(w(),!1===b&&Z())}),[s]),(0,i.useEffect)((function(){return function(){w(!1),!1===b&&Z()}}),[]);var j=function(){w(),n=setTimeout((function(){Z(),h(!0)}),18e5)},w=function(){(!(arguments.length>0&&void 0!==arguments[0])||arguments[0])&&(u(!1),h(!1)),null!=n&&clearTimeout(n)},S=(0,i.useCallback)((function(){x().then((function(){j()}))}),[x,j]),C=(0,i.useCallback)((function(e){e||null===r||void 0===r||r.setCookingMode(!1)}),[null===r||void 0===r?void 0:r.setCookingMode]);return(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(Me.Z,{show:s&&c,autoHide:1e4,anchorOrigin:{horizontal:"center",vertical:"bottom"},onClose:function(){return u(!1)},children:t(un.activated_cooking_mode_toast)}),(0,y.jsx)(k.Z,{show:g,title:t(un.still_cooking_modal_title),acceptTitle:t(un.still_cooking_modal_yes),closeTitle:t(un.still_cooking_modal_no),onAccept:S,onClose:C,children:t(un.still_cooking_modal_text)})]})},pn=function(){var e=(0,o.I0)(),n=(0,r.s0)(),t=(0,pe.Z)(),s=(0,o.v9)((function(e){var n;return null===(n=e.account.item)||void 0===n?void 0:n.id})),a=(0,o.v9)((function(e){return e.recipe})),c=a.item,u=a.meta,d=(0,i.useRef)(),p=(0,i.useState)(!1),f=(0,l.Z)(p,2),g=f[0],h=f[1],m=(0,i.useCallback)((function(){null!=c?e(en.preload(c)):t("Invalid state: recipe may not be null")}),[c,e]),v=(0,i.useCallback)((function(){null!=c?(h(!0),e(ie.eI(c.id,c.slug))):t("Invalid state: recipe may not be null")}),[c,e]);return(0,i.useEffect)((function(){null==d.current?d.current=c:g&&null!=d.current&&null==c&&n((0,te.qC)("/browser"))}),[c]),null!=c?(0,y.jsxs)(nn,{children:[(0,y.jsx)($e,{recipe:c,recipeMeta:u,userId:s,onEditRecipe:m,deleteRecipe:v}),(0,y.jsx)(dn,{})]}):(0,y.jsx)(re.Z,{message:"Loading"})},fn=function(){var e,n,t,a,c=(0,r.UO)(),l=(0,r.s0)(),u=(0,o.I0)(),d=(0,o.v9)((function(e){return e.recipe})),p=d.meta,f=c.recipe;(0,i.useEffect)((function(){f&&u(ie.zD(f))}),[f]),(0,i.useEffect)((function(){404===s.Z(p.error,"status")&&l((0,te.xb)("/NotFound"))}),[p.error]),(0,i.useEffect)((function(){return function(){u(ie.mc())}}),[]);var g=(0,i.useMemo)((function(){return(0,y.jsx)(J,{})}),[null===(e=d.item)||void 0===e?void 0:e.id,d.meta.pending]),h=(0,i.useMemo)((function(){return(0,y.jsx)(ne,{recipe:d.item})}),[null===(n=d.item)||void 0===n?void 0:n.id,null===(t=d.item)||void 0===t?void 0:t.author]);return(0,y.jsxs)(X.Z,{title:null===(a=d.item)||void 0===a?void 0:a.title,children:[(0,y.jsx)(pn,{}),d.meta.pending===v.V.COMPLETED&&g,d.meta.pending===v.V.COMPLETED&&h]})}},4658:function(){},7493:function(){}}]);
//# sourceMappingURL=918.56fa7bcc.chunk.js.map