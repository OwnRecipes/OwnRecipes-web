"use strict";(self.webpackChunkownrecipes_web=self.webpackChunkownrecipes_web||[]).push([[976],{9724:(e,t,i)=>{i.d(t,{c:()=>_});var s=i(9060),n=i(1112),a=i(7640),r=i(3988),c=i(4120),o=i(264),l=i.n(o),d=i(768),u=i(5404),g=i(8330),p=i(1012),m=i(2496);const h=[{tag:"easy",icon:"bar-chart",variant:"light"},{tag:"vegetarian",icon:"tree",variant:"light"},{tag:"vegan",icon:"tree",variant:"filled"}],v=e=>{let{recipe:t}=e;const i=(0,d.c)(),n=(0,s.useMemo)((()=>{if(!t.oTags)return[];const e=[],s={...t.oTags};return s.vegetarian&&s.vegan&&delete s.vegetarian,h.forEach((n=>{null!==s&&void 0!==s&&s[n.tag]&&e.push((0,m.jsxs)(p.c,{children:[(0,m.jsx)(u.c,{icon:n.icon,variant:n.variant}),(0,g.$Q)(i,"tag.",n.tag)]},"".concat(t.id,"-").concat(n.tag)))})),e}),[t.oTags,i.locale]);return 0===n.length?null:(0,m.jsx)("div",{className:"tags-list",children:n})};var x=i(56),f=i(6240);function b(e){var t;if(e.photoThumbnail)return null!==(t=e.photoThumbnail)&&void 0!==t?t:(0,g.eQ)();{const t=["fish","fried-eggs","pizza","soup","steak"],i=Math.abs(function(e){let t=0;for(let i=0;i<e.length;++i)t=(t<<5)-t+e.charCodeAt(i),t&=t;return t}(e.title));return(0,g.oB)("/images/".concat(t[i%5],".jpg"))}}const _=e=>{let{data:t,lg:i=4,onOpenRecipe:o}=e;const d=(0,s.useMemo)((()=>(0,g.eQ)()),[]),u=(0,s.useMemo)((()=>({background:"url(".concat(d,") 100% center / cover")})),[d]),p=null===t||void 0===t?void 0:t.map((e=>{const t=(0,g.sL)("/recipe/".concat(e.slug));return(0,m.jsx)(a.c,{children:(0,m.jsx)(r.c,{className:l()("recipe"),children:(0,m.jsxs)(n.cH,{to:t,onClick:()=>o(e),children:[(0,m.jsx)(r.c.Img,{variant:"top",src:b(e),alt:"",style:u}),(0,m.jsx)(x.c,{stars:e.rating,count:e.ratingCount,collapsed:!0}),(0,m.jsx)(r.c.Title,{as:"h3",children:(0,m.jsx)(f.c,{id:e.slug,tooltip:e.title,placement:"bottom",className:"card-title-tooltip",children:e.title})}),e.oTags&&(0,m.jsx)(v,{recipe:e}),(0,m.jsx)(r.c.Text,{children:e.info})]})})},e.id)}));return(0,m.jsx)(c.c,{xs:1,sm:2,lg:i,className:"g-3 recipes-list",children:p})}},2812:(e,t,i)=>{i.d(t,{c:()=>y});var s=i(9060),n=i(6936),a=i(8224),r=i(768),c=(i(144),i(5404)),o=i(4712),l=i(7804),d=i(9340),u=i(9724),g=i(1480),p=i(2672),m=i(6320),h=i(3536),v=i(8936),x=i(7296);const f=e=>t=>{t({...(0,l.gB)(x.C,m.y.GET_START)}),(0,g.cp)().get("".concat(p.Q.mini_browse).concat(e?"&".concat(e):"")).then((e=>{var i;t({...(0,l.gB)(x.C,m.y.GET_SUCCESS),payload:null===(i=e.body.results)||void 0===i?void 0:i.map(v.eK)})})).catch((e=>t((0,h.GW)(e,x.C))))};var b=i(2496);const _=(0,a.Os)({shuffleSuggestionsButton:{id:"browse.shuffle_suggestions_button_title",description:"Title/tooltip of the icon button to shuffle the suggestions.",defaultMessage:"Shuffle suggestions"}});function j(e,t){const i=new URLSearchParams(t);return i.append("limit",e.toString()),i.toString()}const y=e=>{var t;let{heading:i,count:a,filters:g}=e;const{formatMessage:p}=(0,r.c)(),m=(0,l.OY)(),h=(0,n.IT)(),v=(0,n.W4)(),x=v.recipe,y=(0,l.w1)((e=>e.browse.browserMini.items)),C=(0,s.useMemo)((()=>null===y||void 0===y?void 0:y.filter((e=>e.slug!==x))),[x,y]),k=null!==(t=v.recipe)&&void 0!==t?t:"";(0,s.useEffect)((()=>{m(f(j(a,g)))}),[h]);const w=(0,s.useCallback)((()=>{m(f(j(a,g)))}),[j,a,g]),S=(0,s.useCallback)((e=>{k!==e.slug&&m(d.Wm(e))}),[k]);return null!=C&&0===C.length?null:(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("h2",{id:"suggestions-heading",children:i}),(0,b.jsx)(o.c,{id:"shuffle-suggestions-button",variant:"outline-primary",onClick:w,className:"print-hidden",tooltip:p(_.shuffleSuggestionsButton),children:(0,b.jsx)(c.c,{icon:"arrow-repeat",variant:"light"})}),(0,b.jsx)(u.c,{data:C,onOpenRecipe:S})]})}},4712:(e,t,i)=>{i.d(t,{c:()=>o});var s=i(9060),n=i(2136),a=(i(7272),i(4748)),r=i(6240),c=i(2496);const o=(0,s.forwardRef)(((e,t)=>{let{id:i,tooltip:s,tooltipPlacement:o,children:l,...d}=e;return(0,c.jsx)(a.c,{condition:Boolean(s),render:e=>(0,c.jsx)(r.c,{id:"".concat(i,"-tooltip"),tooltip:s,placement:o,children:e}),children:(0,c.jsx)(n.c,{id:i,"aria-label":s||void 0,"aria-describedby":void 0,...d,ref:t,children:l})})}))},8676:(e,t,i)=>{i.d(t,{c:()=>a});var s=i(6776),n=i(2496);const a=e=>{let{message:t}=e;return(0,n.jsxs)("div",{className:"spinner",children:[t&&(0,n.jsx)("h3",{className:"no-results",children:t}),(0,n.jsx)(s.c,{})]})}},8716:(e,t,i)=>{i.d(t,{AJ:()=>d,Ap:()=>h,Jr:()=>g,Su:()=>u,aE:()=>p,a_:()=>v});var s=i(1480),n=i(2672),a=i(7804),r=i(6320),c=i(3536),o=i(9228),l=i(8168);const d=e=>t=>{t({...(0,a.gB)(o.aK,r.y.GET_START)}),(0,s.cp)().get("".concat(n.Q.list).concat(e,"/")).then((e=>{var i;t((i=(0,o.qq)(e.body),{...(0,a.gB)(o.aK,r.y.GET_SUCCESS),payload:i}))})).catch((e=>t((0,c.GW)(e,o.aK))))},u=async(e,t)=>(e({...(0,a.gB)(o.aK,r.y.CREATE_START)}),(0,s.cp)().post(n.Q.list).send(t).then((t=>{const i=(0,o.qq)(t.body);e({...(0,a.gB)(o.aK,r.y.CREATE_SUCCESS),payload:i})})).catch((t=>(0,c.iu)(e,t,o.aK)))),g=async(e,t,i)=>(e({...(0,a.gB)(o.aK,r.y.UPDATE_START)}),(0,s.cp)().patch("".concat(n.Q.list).concat(t,"/")).send(i).then((t=>{const i=(0,o.qq)(t.body);e({...(0,a.gB)(o.aK,r.y.UPDATE_SUCCESS),payload:i})})).catch((t=>(0,c.iu)(e,t,o.aK)))),p=(e,t)=>i=>{i({...(0,a.gB)(o.aK,r.y.DELETE_START)}),(0,s.cp)().delete("".concat(n.Q.list).concat(t,"/")).then((()=>{i({...(0,a.gB)(o.aK,r.y.DELETE_SUCCESS),payload:{id:e}})})).catch((e=>i((0,c.GW)(e,o.aK))))};function m(e,t){return[e.quantity&&"0"!==e.quantity?e.quantity:void 0,t(e.measurement,e.quantity),e.title].filter(Boolean).join(" ")}const h=async(e,t,i,d)=>{const u=i.ingredientGroups.flatMap((e=>e.ingredients.map((e=>({list:t,title:m(e,d)}))))),g=i.subrecipes.map((e=>({list:t,title:m(e,d)}))),p=u.concat(g);return p.length>0?(e({...(0,a.gB)(o.aK,r.y.UPDATE_START)}),(0,s.cp)().post(n.Q.bulk_list_item).send(p).then((i=>{e({...(0,a.gB)(o.aK,o.mK.BULK_ADD),payload:i.body.map((e=>(0,l.qO)(t,e)))}),e({...(0,a.gB)(o.aK,r.y.UPDATE_SUCCESS)})})).catch((t=>e((0,c.GW)(t,o.aK))))):null},v=()=>e=>{e({...(0,a.gB)(o.aK,r.y.RESET)})}},56:(e,t,i)=>{i.d(t,{c:()=>h});var s=i(9060),n=i(8224),a=i(768),r=i(264),c=i.n(r),o=i(2136),l=i(5404),d=i(4748),u=i(2496);const g=(0,n.Os)({star_alt:{id:"rating_comments.star_alt",description:"Alt text for star button, for screen reader.",defaultMessage:"Select to rate item {stars, plural, one {# star} other {# stars}}"},stars_alt:{id:"rating_comments.stars_alt",description:"Alt text for read-only stars (view).",defaultMessage:"{stars} out of 5 stars"},rating_count:{id:"rating_comments.rating_count",description:"Rating count (view).",defaultMessage:"{count} ratings"}}),p=e=>{let{stars:t,num:i,onChange:n}=e;const{formatMessage:r}=(0,a.c)(),c=(0,s.useCallback)((()=>{null===n||void 0===n||n(i)}),[n,i]),p=t>i-1&&t<i,m=p?"star-half":"star",h=i>t||p?"light":"filled";return(0,u.jsx)(d.c,{condition:null!=n,render:e=>(0,u.jsx)(o.c,{variant:"transparent",className:"rating",onClick:c,children:e}),children:(0,u.jsx)(l.c,{icon:m,variant:h,size:null!=n?"2x":"1x",ariaLabel:n?r(g.star_alt,{stars:i}):void 0},i)},i)},m=e=>{let{stars:t}=e;const i=t>0&&t<4,s=i?"star-half":"star",n=0===t||i?"light":"filled";return(0,u.jsx)(l.c,{icon:s,variant:n,size:"1x"},t)},h=e=>{let{stars:t,count:i,showCount:n=!0,collapsed:r=!1,onChange:o}=e;const{formatMessage:l}=(0,a.c)();let d=t;t>5?d=5:t<0&&(d=0);const h=(0,s.useMemo)((()=>r?(0,u.jsx)(m,{stars:d}):Array.from({length:5},((e,t)=>t+1)).map((e=>(0,u.jsx)(p,{stars:d,num:e,onChange:o},e)))),[d,r,o]),v=t>0?"".concat(t,"/5"):"",x=!n||0!==t&&!i||o?void 0:null!==i&&void 0!==i?i:0;return(0,u.jsxs)("div",{className:"rating-stars",children:[(0,u.jsx)("span",{className:c()("stars-icons",{active:t>0}),"aria-hidden":!0,children:h}),v&&(0,u.jsx)("span",{className:"rating-text","aria-hidden":!0,children:v}),(0,u.jsx)("span",{className:"sr-only",children:l(g.stars_alt,{stars:d})}),null!=x&&(0,u.jsx)("span",{className:"rating-count",children:"(".concat(r?x:l(g.rating_count,{count:x}),")")})]})}},9908:(e,t,i)=>{i.r(t),i.d(t,{default:()=>ot});var s=i(9060),n=i(6936),a=i(8712),r=i(7804),c=i(3988),o=i(100),l=i(8224),d=i(768),u=i(4120),g=i(7640),p=i(1560),m=i(2124),h=i(6776),v=i(264),x=i.n(v),f=i(5888),b=i(880),_=i(2136),j=i(3152),y=i(1700),C=i(8364),k=i(7352),w=i(7136),S=i(56),N=i(1112),M=i(5404),E=i(4712),T=i(6240),R=i(5600),A=i(1808),L=i(2496);const O=(0,l.Os)({edited_by:{id:"rating.edited_by",description:"The rating was edited by ...",defaultMessage:"Edited by"},edit_button:{id:"rating_comments.edit_button",description:"Label of the edit comment icon button",defaultMessage:"Edit comment"},delete_button:{id:"rating_comments.delete_button",description:"Label of the delete comment icon button",defaultMessage:"Delete comment"},confirm_delete_message:{id:"rating_comments.confirm_delete",description:"Are you sure you want to delete this comment?",defaultMessage:"Are you sure you want to delete this comment?"}}),D=e=>{let{rating:t}=e;const{formatMessage:i,locale:s}=(0,d.c)();if(t.update_date&&new Date(t.update_date).getTime()>0&&t.update_username){const e="".concat(i(O.edited_by),": ").concat(t.update_username),n=new Date(t.update_date).toLocaleString(s),a=(0,L.jsxs)("div",{className:"d-flex-column",children:[(0,L.jsx)("div",{children:e}),(0,L.jsx)("div",{children:n})]});return(0,L.jsx)(T.c,{id:"".concat(t.id,"-editor-tooltip"),tooltip:a,children:(0,L.jsx)(M.c,{icon:"pencil",className:"subtitle2",size:"1x",style:{marginLeft:"5px"},ariaLabel:"".concat(i(O.edited_by),": ").concat(t.update_username,". ").concat(n)})})}return null},B=e=>{let{rating:t}=e;const{locale:i}=(0,d.c)();return t.update_date&&new Date(t.update_date).getTime()>0&&t.update_username===t.pub_username?(0,L.jsx)(N.cH,{className:"subtitle2 rating-timestamp",to:"#rating-".concat(t.id),children:new Date(t.update_date).toLocaleString(i)}):t.pub_date&&new Date(t.pub_date).getTime()>0?(0,L.jsx)(N.cH,{className:"subtitle2 rating-timestamp",to:"#rating-".concat(t.id),children:new Date(t.pub_date).toLocaleString(i)}):null},F=e=>{let{rating:t}=e;const i=[];return t.comment.split("\n").filter(Boolean).forEach(((e,t)=>{i.push((0,L.jsx)(p.c,{children:e},"".concat(t,"-p")))})),(0,L.jsx)(L.Fragment,{children:i})},I=e=>{let{rating:t,onEdit:i,onDelete:n,className:a,...r}=e;const c=(0,d.c)(),{formatMessage:o}=c,[l,u]=(0,s.useState)(!1),g=(0,s.useCallback)((()=>{u(!0)}),[]),p=(0,s.useCallback)((()=>{u(!1)}),[]),m=(0,s.useCallback)((()=>{null===n||void 0===n||n()}),[]);return(0,L.jsxs)(L.Fragment,{children:[(0,L.jsxs)(A.Y,{position:"end",className:x()("rating-toolbar",a),...r,children:[i&&(0,L.jsx)(E.c,{id:"edit-".concat(t.id),variant:"outline-primary",className:"rating-edit-button",size:"sm",tooltip:o(O.edit_button),onClick:i,children:(0,L.jsx)(M.c,{icon:"pencil"})}),n&&(0,L.jsx)(E.c,{id:"delete-".concat(t.id),variant:"outline-danger",className:"rating-delete-button",size:"sm",tooltip:o(O.delete_button),onClick:g,children:(0,L.jsx)(M.c,{icon:"trash"})})]}),(0,L.jsx)(R.c,{show:l,title:c.messages["recipe.confirm_delete_title"],acceptTitle:c.messages["recipe.confirm_delete_accept"],onAccept:m,onClose:p,acceptButtonProps:{variant:"danger"},children:o(O.confirm_delete_message)})]})},P=e=>{let{rating:t}=e;return(0,L.jsxs)(L.Fragment,{children:[(0,L.jsxs)(u.c,{className:"rating-header",children:[(0,L.jsxs)(g.c,{xs:!0,children:[(0,L.jsx)(S.c,{stars:t.rating||0}),(0,L.jsx)("div",{className:"rating-username",children:t.pub_username})]}),(0,L.jsxs)(g.c,{xs:"auto",children:[(0,L.jsx)(B,{rating:t}),(0,L.jsx)(D,{rating:t})]})]}),(0,L.jsx)(u.c,{children:(0,L.jsx)(g.c,{xs:12,children:(0,L.jsx)(F,{rating:t})})})]})},K=(0,l.Os)({edit_rating_title:{id:"rating.form.edit.title",description:"Fieldset legend for editing a rating",defaultMessage:"Comment by {username}"},new_rating_title:{id:"rating.form.create.title",description:"Fieldset legend for creating a new rating",defaultMessage:"Your new rating"},rating_label:{id:"rating.form.rating_label",description:"Rating label",defaultMessage:"Rating"},rating_comment_label:{id:"rating.form.rating_comment_label",description:"Rating label",defaultMessage:"Comments"},rating_comment_placeholder:{id:"rating.form.rating_comment_placeholder",description:"Rating placeholder",defaultMessage:"Leave a comment."},submit:{id:"rating.form.submit",description:"Submit recipe button",defaultMessage:"Comment"}}),q=e=>{let{rating:t,addRating:i,editRating:n,onSubmitSuccess:a,onCancel:r}=e;const c=(0,d.c)(),{formatMessage:o}=c,[l]=(0,s.useState)(null!==t&&void 0!==t?t:{rating:0,comment:""}),p=(0,s.useCallback)((async e=>{if(t){const i={...e,id:t.id};return null===n||void 0===n?void 0:n(i)}return null===i||void 0===i?void 0:i(e)}),[i,null===t||void 0===t?void 0:t.id]);return(0,L.jsx)(j.QF,{initialValues:l,onSubmit:p,subscription:{},render:e=>{let{form:i,handleSubmit:s}=e;return(0,L.jsxs)(b.c,{onSubmit:s,className:x()("rating-form",{create:!t,edit:t}),children:[(0,L.jsx)(w.c,{onSubmitSuccess:a}),(0,L.jsx)(y.c,{form:i,initialValues:l}),t&&(0,L.jsxs)("div",{className:"d-flex",style:{alignItems:"center",justifyContent:"end"},children:[(0,L.jsx)(B,{rating:t}),(0,L.jsx)(D,{rating:t})]}),(0,L.jsxs)("fieldset",{children:[(0,L.jsxs)("legend",{className:"rating-form-heading",children:[!t&&o(K.new_rating_title),t&&o(K.edit_rating_title,{username:t.pub_username})]}),(0,L.jsx)(u.c,{children:(0,L.jsxs)(g.c,{className:"form-group required",children:[(0,L.jsx)("div",{className:"form-label",children:o(K.rating_label)}),(0,L.jsx)(j.IN,{name:"rating",validate:k.o0,validateFields:[],children:e=>(0,L.jsx)(S.c,{stars:e.input.value,onChange:t=>{e.input.onChange(t)}})})]})}),(0,L.jsx)(u.c,{children:(0,L.jsx)(g.c,{children:(0,L.jsx)(C.c,{name:"comment",rows:4,label:o(K.rating_comment_label),placeholder:o(K.rating_comment_placeholder),maxLength:1e3,required:!0})})}),(0,L.jsx)(u.c,{children:(0,L.jsx)(g.c,{xs:12,children:(0,L.jsxs)(A.Y,{children:[(0,L.jsx)(j.Wu,{subscription:{values:!0,submitting:!0},children:e=>{let{values:t,submitting:i}=e;return(0,L.jsx)(_.c,{type:"submit",variant:"primary",disabled:!t.rating||!t.comment||i,children:o(K.submit)})}}),(0,L.jsx)(_.c,{variant:"outline-primary",onClick:r,children:c.messages["modal.close"]})]})})})]})]})}})};var G=i(8330);const U=e=>{let{rating:t,onEdit:i,onDelete:a}=e;const{hash:r}=(0,n.IT)(),c=(null!==r&&void 0!==r?r:"").replace("#",""),[o,l]=(0,s.useState)(!1),d=(0,s.useCallback)((()=>{l(!1)}),[]),u=(0,s.useCallback)((()=>{l(!0)}),[]),g=(0,s.useCallback)((()=>null===a||void 0===a?void 0:a(t.id)),[t.id]),p="rating-".concat(t.id);return(0,L.jsxs)("div",{id:p,className:x()("rating-comment",{"perma-link-active":p===c}),children:[(0,L.jsx)(f.c,{uriFragmentId:p}),!o&&(0,L.jsx)(P,{rating:t}),o&&(0,L.jsx)(q,{rating:t,editRating:i,onSubmitSuccess:d,onCancel:d}),!o&&!(0,G.wL)()&&(0,L.jsx)(I,{rating:t,onEdit:i?u:void 0,onDelete:a?g:void 0})]})},Q=(0,l.Os)({no_comments:{id:"rating_comments.no_comments",description:"Placeholder for no comments",defaultMessage:"(No comments yet. Be the first!)"}}),z=e=>{var t;let{ratings:i,userId:n,userRole:a,pending:r,editRating:c,removeRating:l}=e;const{formatMessage:v}=(0,d.c)(),x=(0,s.useCallback)((e=>c(e)),[c]),f=(0,s.useCallback)((e=>l(e)),[l]),b=null!=a&&[o.c.STAFF,o.c.ADMIN].includes(a),_=null!==(t=null===i||void 0===i?void 0:i.map((e=>(0,L.jsx)(U,{rating:e,onEdit:e.author===n||b?x:void 0,onDelete:e.author===n||b?f:void 0},e.id))))&&void 0!==t?t:[];return(0,L.jsxs)(L.Fragment,{children:[r===m.A.LOADING&&(0,L.jsx)(h.c,{variant:"three-bounce"}),0===_.length&&(0,L.jsx)(u.c,{children:(0,L.jsx)(g.c,{children:(0,L.jsx)(p.c,{className:"placeholder",children:v(Q.no_comments)})})},"be-the-first"),_]})};var H=i(1760);const W=(0,l.Os)({title:{id:"recipe.comments.title",description:"Comments heading",defaultMessage:"Comments ({count})"},new_rating_button:{id:"recipe.comments.new_rating",description:"Label for the new rating button",defaultMessage:"New rating"}}),Y=e=>{let{commentsCount:t,userRole:i,showNewRating:s,onShowNewRating:n}=e;const{formatMessage:a}=(0,d.c)();return(0,L.jsx)(c.c.Header,{children:(0,L.jsxs)(u.c,{children:[(0,L.jsx)(g.c,{className:"ratings-heading-col",children:(0,L.jsxs)("h2",{id:"ratings-heading",children:[a(W.title,{count:t}),(0,L.jsx)(H.c,{linkFor:"ratings-heading"})]})}),null!=i&&[o.c.USER,o.c.STAFF,o.c.ADMIN].includes(i)&&(0,L.jsx)(g.c,{xs:"auto",style:s?{visibility:"hidden"}:void 0,children:(0,L.jsx)(_.c,{variant:"outline-primary",onClick:n,children:a(W.new_rating_button)})})]})})},V=e=>{var t;let{ratings:i,userId:n,userRole:a,pending:r,addRating:l,editRating:d,removeRating:u}=e;const[g,p]=(0,s.useState)(!1),m=(0,s.useCallback)((()=>{p(!1)}),[]);return(0,L.jsxs)(c.c,{className:"rating-panel",as:"article",children:[(0,L.jsx)(Y,{commentsCount:null!==(t=null===i||void 0===i?void 0:i.length)&&void 0!==t?t:0,userRole:a,showNewRating:g,onShowNewRating:()=>p(!0)}),(0,L.jsxs)(c.c.Body,{children:[g&&null!=a&&[o.c.USER,o.c.STAFF,o.c.ADMIN].includes(a)&&(0,L.jsx)(q,{addRating:l,editRating:d,onSubmitSuccess:m,onCancel:m}),(0,L.jsx)(z,{ratings:i,pending:r,userId:n,userRole:a,editRating:d,removeRating:u})]})]})};var $=i(1480),J=i(2672),Z=i(6320),X=i(3536),ee=i(7323);var te=i(8684);const ie=()=>{const e=(0,r.OY)(),t=(0,r.w1)((e=>e.account.item)),i=(0,r.w1)((e=>e.recipe.item)),n=(0,r.w1)((e=>e.ratings)),a=null===i||void 0===i?void 0:i.slug,c=null===i||void 0===i?void 0:i.rating,o=(0,s.useCallback)((async t=>(async(e,t,i)=>(e({...(0,r.gB)(ee.C_,Z.y.CREATE_START)}),(0,$.cp)().post(J.Q.ratings).send({recipe:t,rating:i.rating,comment:i.comment}).then((i=>(e({...(0,r.gB)(ee.C_,Z.y.CREATE_SUCCESS),payload:{recipe:t,rating:(0,ee.Ou)(i.body)}}),null))).catch((t=>(0,X.iu)(e,t,ee.qy)))))(e,null!==a&&void 0!==a?a:"",t)),[a]),l=(0,s.useCallback)((async t=>(async(e,t,i)=>(e({...(0,r.gB)(ee.C_,Z.y.UPDATE_START)}),(0,$.cp)().patch("".concat(J.Q.ratings).concat(i.id,"/")).send({rating:i.rating,comment:i.comment}).then((i=>(e({...(0,r.gB)(ee.C_,Z.y.UPDATE_SUCCESS),payload:{recipe:t,rating:(0,ee.Ou)(i.body)}}),null))).catch((t=>(0,X.iu)(e,t,ee.qy)))))(e,null!==a&&void 0!==a?a:"",t)),[a]),d=(0,s.useCallback)((t=>e(((e,t)=>i=>{i({...(0,r.gB)(ee.C_,Z.y.DELETE_START)}),(0,$.cp)().delete("".concat(J.Q.ratings).concat(t,"/")).then((()=>i({...(0,r.gB)(ee.C_,Z.y.DELETE_SUCCESS),payload:{ratingId:t,recipe:e}}))).catch((e=>i((0,X.GW)(e,ee.qy))))})(null!==a&&void 0!==a?a:"",t))),[a]);if((0,s.useEffect)((()=>{null!=a&&null!=c&&0!==c&&e((e=>t=>{t({...(0,r.gB)(ee.qy,Z.y.GET_START)}),(0,$.cp)().get("".concat(J.Q.ratings,"?recipe__slug=").concat(e)).then((i=>t({...(0,r.gB)(ee.qy,Z.y.GET_SUCCESS),id:e,payload:Z.c.transformEntities(i.body.results,ee.Ou)}))).catch((e=>t((0,X.GW)(e,ee.qy))))})(a))}),[a,c]),null==a)return null;const u=null!=a&&null!=n.items?n.items[a]:void 0;return(0,L.jsx)(te.c,{verbose:!0,printStack:!0,children:(0,L.jsx)(V,{userId:null===t||void 0===t?void 0:t.id,userRole:null===t||void 0===t?void 0:t.role,ratings:u,pending:n.meta.pending,addRating:o,editRating:l,removeRating:d})})};var se=i(7173),ne=i(2812);function ae(e){const t={};return e.course&&(t.course__slug=e.course.title),e.cuisine&&(t.cuisine__slug=e.cuisine.title),Object.keys(t).length>0?t:void 0}const re=e=>{let{recipe:t}=e;const i=(0,d.c)(),s=(0,r.w1)((e=>e.browse.browserMini.meta)),n=(0,r.w1)((e=>e.settings.disableRecipeDiscovery))||(0,G.yx)("REACT_APP_DISABLE_RECIPE_DISCOVERY")||!1;return!s.hasConnection||s.error||n||null===t||void 0===t||!t.author?null:(0,L.jsxs)(te.c,{verbose:!0,printStack:!0,children:[(0,L.jsx)("hr",{}),(0,L.jsx)("article",{className:"recipe-footer",children:(0,L.jsx)(ne.c,{heading:i.messages["nav.home.recommended_recipes_title"],count:4,filters:ae(t)})})]})};var ce=i(9340),oe=(i(3688),i(8676)),le=(i(8944),i(5388)),de=i(8436);const ue=(0,l.Os)({ingredients:{id:"recipe.ingredients",description:"Ingredients",defaultMessage:"Ingredients"},ingredients_for_servings:{id:"recipe.ingredients_for_servings",description:"Ingredients for[ n servings]",defaultMessage:"Ingredients for"},servings:{id:"recipe.servings",description:"Servings",defaultMessage:"Servings"},servings_input_tooltip:{id:"recipe.servings_input_tooltip",description:"Accessible tooltip for the (change) servings input",defaultMessage:"Amount of servings"},servings_update_button:{id:"recipe.servings_update_button",description:"Label for the button to change the servings",defaultMessage:"Update servings"}}),ge=e=>{var t,i;let{recipe:n,recipeMeta:a,updateServings:r}=e;const{formatMessage:c}=(0,d.c)(),o=null===n||void 0===n?void 0:n.customServings,l=(0,s.useCallback)((async e=>r(e.servings)),[r]),u=(0,s.useMemo)((()=>({servings:o})),[o]),g=a.pending,p=null!==(t=null===n||void 0===n?void 0:n.customServings)&&void 0!==t?t:0,h=g===m.A.COMPLETED&&null!=(null===n||void 0===n?void 0:n.subrecipes)&&0===n.subrecipes.length&&null!=(null===n||void 0===n?void 0:n.ingredientGroups)&&0===n.ingredientGroups.length;return(0,L.jsxs)(L.Fragment,{children:[(h||0===p)&&(0,L.jsxs)("h2",{id:"ingredients-heading",children:[c(ue.ingredients),(0,L.jsx)(H.c,{linkFor:"ingredients-heading"})]}),!h&&p>0&&(0,L.jsxs)("div",{className:"ingredients-for-servings-row",children:[(0,L.jsxs)("h2",{id:"ingredients-heading",children:[c(ue.ingredients_for_servings),(0,L.jsx)(H.c,{linkFor:"ingredients-heading"}),(0,L.jsx)("span",{className:"print-only",children:": ".concat(null!==(i=null===n||void 0===n?void 0:n.customServings)&&void 0!==i?i:""," ").concat(c(ue.servings))})]}),(0,L.jsx)("div",{className:"custom-servings print-hidden",children:(0,L.jsx)(j.QF,{initialValues:u,onSubmit:l,subscription:{},render:e=>{let{form:t,handleSubmit:i}=e;return(0,L.jsxs)(b.c,{onSubmit:i,className:"custom-servings",children:[(0,L.jsx)(y.c,{form:t,initialValues:u}),(0,L.jsx)(C.c,{name:"servings",type:"number","aria-label":c(ue.servings_input_tooltip),min:0,max:1e3,autoComplete:"off"}),(0,L.jsxs)(_.c,{type:"submit",variant:"primary","aria-label":c(ue.servings_update_button),children:[(0,L.jsx)(M.c,{icon:"arrow-repeat",variant:"light"}),c(ue.servings)]})]})}})})]})]})};var pe=i(4748),me=i(6330),he=i(6272),ve=i(559),xe=i(8716),fe=i(5016);const be=(0,s.forwardRef)(((e,t)=>{let{name:i,required:s,data:n,format:a,parse:r,onChange:c,onFocus:o,onBlur:l,...u}=e;const g=(0,d.c)();return(0,L.jsx)(j.IN,{name:i,validate:s?k.o0:void 0,validateFields:[],format:a,parse:r,children:e=>(0,L.jsx)(fe.M,{...u,required:s,name:e.input.name,value:e.input.value,data:n,errors:(0,k.MZ)(g,e.meta.error||(e.meta.dirtySinceLastSubmit?void 0:e.meta.submitError)),meta:e.meta,onChange:(t,i)=>{e.input.onChange(i),null===c||void 0===c||c(t,i)},onFocus:t=>{e.input.onFocus(t),null===o||void 0===o||o(t)},onBlur:t=>{e.input.onBlur(t),null===l||void 0===l||l(t)},ref:t})})}));var _e=i(2068),je=i(1772);function ye(e){const t={};return e.forEach((e=>{t[e]=!0})),t}function Ce(e){const t={};return e.forEach((e=>{t[e.slug]={...ye(e.ingredients.flatMap((e=>"cb-".concat(e.id))))}})),t}const ke=(0,s.forwardRef)(((e,t)=>{let{lists:i,subrecipes:n,ingredients:a,onSubmit:r,onSubmitSuccess:c,onAddList:o,submitRef:l}=e;const d=(0,he.c)(),[p]=(0,s.useState)({list:i.length>0?i[i.length-1].id.toString():void 0,ingredients:Ce(a),subrecipes:{...ye(n.flatMap((e=>"cb-".concat(e.child_recipe_id))))}}),m=(0,s.useCallback)((async e=>{var t;const i=[];Object.keys(e.subrecipes).forEach((t=>{e.subrecipes[t]&&i.push(parseInt(t.substring(t.indexOf("-")+1)))}));const s=[];Object.keys(null!==(t=e.ingredients)&&void 0!==t?t:{}).forEach((t=>{const i=new Set,n=a.find((e=>e.slug===t));if(!n)return void d('Invalid state: There is not IngredientGroup for slug "'.concat(t,'"'));const r=e.ingredients[t];Object.keys(r).forEach((e=>{r[e]&&i.add(parseInt(e.substring(e.indexOf("-")+1)))})),Object.keys(r).length>0&&s.push({slug:n.slug,title:n.title,ingredients:Array.from(i)})}));const n={list:parseInt(e.list),ingredients:s,subrecipes:(c=i,Array.from(new Set(c)))};var c;return r(n)}),[a,r]);return(0,L.jsx)(j.QF,{initialValues:p,onSubmit:m,subscription:{},render:e=>{let{form:s,handleSubmit:r}=e;return(0,L.jsxs)(b.c,{onSubmit:r,ref:t,children:[(0,L.jsx)(w.c,{onSubmitSuccess:c}),(0,L.jsx)(y.c,{form:s,initialValues:p}),(0,L.jsx)(Se,{lists:i,form:s,onAddList:o}),i.length>0&&(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)(u.c,{className:"additional-checkbox-row",children:(0,L.jsx)(g.c,{children:(0,L.jsx)(Ne,{name:"toggle-all",form:s})})}),(0,L.jsx)(u.c,{className:"ingredients-and-subrecipes",children:(0,L.jsxs)(g.c,{children:[(0,L.jsx)(le.c,{subRecipes:n,selectable:!0}),(0,L.jsx)(de.c,{groups:a,hasSubrecipes:null!=n&&n.length>0,selectable:!0})]})})]}),(0,L.jsx)("button",{type:"submit",ref:l,className:"visibility-hidden",children:"Submit"})]})}})})),we=(0,l.Os)({list:{id:"grocery_list.form.list",defaultMessage:"List"},new_text:{id:"grocery_list.item.new_text",defaultMessage:"Create a new grocery list to get started."},new_list_title:{id:"grocery_list.item.new_title",defaultMessage:"My grocery list"}}),Se=e=>{let{lists:t,form:i,onAddList:n}=e;const a=(0,d.c)(),{formatMessage:r}=a,[c,o]=(0,s.useState)(!1),l=(0,s.useRef)(),m=(0,s.useCallback)((()=>{const e="".concat(r(we.new_list_title)),i=t.filter((t=>t.title.startsWith(e))).map((t=>parseInt(t.title.substring(e.length)))).filter((e=>!Number.isNaN(e)||e<0)).sort(((e,t)=>e-t)),s=i.length>0?i[i.length-1]+1:1;l.current=t.map((e=>e.id)),n({title:"".concat(e," ").concat(s)}).then((()=>{o(!0)}))}),[t,n,r]);return(0,s.useEffect)((()=>{if(null==l.current)return;const e=t.map((e=>e.id)).find((e=>{var t;return!(null!==(t=l.current)&&void 0!==t&&t.includes(e))}));e&&(i.change("list",e.toString()),l.current=[])}),[t]),(0,L.jsx)(u.c,{children:(0,L.jsxs)(g.c,{className:"input-with-button",children:[0===t.length&&(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)(p.c,{children:r(we.new_text)}),(0,L.jsx)(E.c,{id:"add-list-button",type:"button",onClick:m,variant:"primary",className:"add-list-button",children:a.messages["nav.grocery_list_create"]})]}),t.length>0&&(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)(be,{name:"list",label:r(we.list),data:t.map((e=>({value:e.id.toString(),label:e.title}))),readOnly:0===t.length,disabled:0===t.length}),!c&&(0,L.jsx)(E.c,{id:"add-list-button",type:"button",onClick:m,variant:"transparent",className:"add-list-button",tooltip:a.messages["nav.grocery_list_create"],children:(0,L.jsx)(M.c,{icon:"plus-lg",variant:"light",size:"2x"})})]})]})})},Ne=e=>{let{name:t,form:i}=e;const n=(0,d.c)(),[a,r]=(0,s.useState)(!0),c=(0,s.useCallback)(((e,t)=>{r(t);const s=i.getRegisteredFields();[...s.filter((e=>e.startsWith("ingredients.")&&e.includes("cb-"))),...s.filter((e=>e.startsWith("subrecipes.")&&e.includes("cb-")))].forEach((e=>{i.change(e,t)}))}),[i]);return(0,L.jsx)(me.c,{name:t,label:n.messages["grocery_list.items.toggle_all"],value:a,onChange:c})},Me=e=>{let{show:t,subrecipes:i,ingredients:n,onSaveSuccess:a,onClose:c}=e;const o=(0,d.c)(),l=(0,r.OY)(),u=(0,s.useContext)(_e.c),g=(0,s.useCallback)(((e,t)=>(0,je.y)(o,u,e,t)),[u,o]),p=(0,s.useCallback)((async(e,t)=>xe.Ap(l,e,t,g)),[]),h=(0,s.useCallback)((async e=>xe.Su(l,e)),[]),v=(0,r.w1)((e=>e.groceryLists)),{items:x}=v;(0,s.useEffect)((()=>{(0,G.wL)()||l(ve.A())}),[]);const f=(0,r.w1)((e=>e.groceryList.meta.pending)),b=(0,s.useRef)(null),_=(0,s.useCallback)((()=>{var e;null===(e=b.current)||void 0===e||e.click()}),[b.current]),j=(0,s.useCallback)((async e=>{var t;const s=null!==(t=null===n||void 0===n?void 0:n.flatMap((e=>e.ingredients)))&&void 0!==t?t:[],a=null!=i?[...i]:[],r=[];e.ingredients.forEach((e=>{const t=e.ingredients.map((e=>s.find((t=>t.id===e)))).filter(Boolean);e.ingredients.length>0&&r.push({slug:e.slug,title:e.title,ingredients:t})}));const c=a.filter((t=>e.subrecipes.includes(t.child_recipe_id))),o={ingredientGroups:r,subrecipes:c};return p(e.list,o)}),[n,i,p]),y=(0,s.useCallback)((()=>{a(),c()}),[a,c]),C=(0,s.useCallback)((e=>{e||c()}),[c]);return t&&null!=x&&null!=i&&null!=n?(0,L.jsx)(R.c,{show:t,title:o.messages["recipe.recipe_ingredient_button.add_groceries"],onAccept:_,acceptButtonProps:{disabled:0===x.length||f===m.A.SAVING},onClose:C,className:"add-to-grocery-list-modal",children:(0,L.jsx)(ke,{lists:x,subrecipes:i,ingredients:n,onSubmit:j,onSubmitSuccess:y,onAddList:h,submitRef:b})}):null};var Ee=i(8162);const Te=(0,l.Os)({add_groceries:{id:"recipe.recipe_ingredient_button.add_groceries",description:"Add groceries to list",defaultMessage:"Add to grocery list"},add_groceries_success_toast:{id:"recipe.recipe_ingredient_button.success_toast",description:"Add groceries to list success toast",defaultMessage:"Groceries added to the list."}}),Re=e=>{let{isAuthenticated:t,subrecipes:i,ingredients:n}=e;const{formatMessage:a}=(0,d.c)(),[r,c]=(0,s.useState)(!1),o=(0,s.useCallback)((()=>{c(!0)}),[]),l=(0,s.useCallback)((()=>{c(!1)}),[]),[u,g]=(0,s.useState)(!1),p=(0,s.useCallback)((()=>{g(!0)}),[]),m=(0,s.useCallback)((()=>{g(!1)}),[]);return(0,L.jsxs)("div",{className:"ingredients-footer print-hidden",children:[(0,L.jsx)(pe.c,{condition:!t,render:e=>(0,L.jsx)(N.cH,{to:(0,G.sL)("/login"),children:e}),children:(0,L.jsxs)(_.c,{onClick:o,variant:"primary",disabled:(0,G.wL)(),children:[(0,L.jsx)(M.c,{icon:"clipboard2-check"}),a(Te.add_groceries)]})}),(0,L.jsx)(Me,{show:r,subrecipes:i,ingredients:n,onClose:l,onSaveSuccess:p}),(0,L.jsx)(Ee.c,{show:u,variant:"success",anchorOrigin:{horizontal:"center",vertical:"bottom"},onClose:m,children:a(Te.add_groceries_success_toast)})]})},Ae=(0,l.Os)({no_ingredients:{id:"recipe.recipe_ingredient_button.no_ingredients",description:"No ingredients provided message",defaultMessage:"(This recipe has no ingredients.)"}}),Le=e=>{let{recipe:t,recipeMeta:i,userId:s,updateServings:n}=e;const{formatMessage:a}=(0,d.c)(),r=i.pending,c=r===m.A.COMPLETED&&null!=(null===t||void 0===t?void 0:t.subrecipes)&&0===t.subrecipes.length&&null!=(null===t||void 0===t?void 0:t.ingredientGroups)&&0===t.ingredientGroups.length;return(0,L.jsxs)("article",{className:"ingredients-panel",children:[(0,L.jsx)(ge,{recipe:t,recipeMeta:i,updateServings:n}),r===m.A.LOADING&&null==(null===t||void 0===t?void 0:t.ingredientGroups)&&(0,L.jsx)(oe.c,{}),c&&(0,L.jsx)(p.c,{className:"placeholder",children:a(Ae.no_ingredients)}),!c&&(0,L.jsxs)(L.Fragment,{children:[(0,L.jsxs)("div",{className:"ingredient-groups",children:[(0,L.jsx)(le.c,{withHeaderLink:!0,subRecipes:null===t||void 0===t?void 0:t.subrecipes}),(0,L.jsx)(de.c,{withHeaderLink:!0,groups:null===t||void 0===t?void 0:t.ingredientGroups,hasSubrecipes:null!=(null===t||void 0===t?void 0:t.subrecipes)&&(null===t||void 0===t?void 0:t.subrecipes.length)>0})]}),(0,L.jsx)(Re,{subrecipes:null===t||void 0===t?void 0:t.subrecipes,ingredients:null===t||void 0===t?void 0:t.ingredientGroups,isAuthenticated:null!=s})]})]})},Oe=e=>{var t;let{recipe:i,recipeMeta:n,userId:a}=e;const c=(0,r.OY)(),[o,l]=(0,N.k5)(),d=null!==(t=null===i||void 0===i?void 0:i.slug)&&void 0!==t?t:"",u=(0,s.useCallback)((e=>(l({...o,servings:String(e)}),c((0,ce.Se)(d,e)))),[o,d]),g=(0,s.useMemo)((()=>{const e=o.get("servings");if(!e)return;const t=Number.parseFloat(e);return Number.isNaN(t)?void 0:t}),[o]),p=null===i||void 0===i?void 0:i.customServings;return(0,s.useEffect)((()=>{g&&g!==p&&u(g)}),[u,g,p]),(0,L.jsx)(Le,{recipe:i,recipeMeta:n,userId:a,updateServings:u})};var De=i(1012),Be=i(8680),Fe=i(9448),Ie=i(6718);const Pe=(0,s.forwardRef)(((e,t)=>{let{className:i,children:n,...a}=e;const[r,c]=(0,s.useState)(!1),o=(0,s.useCallback)((()=>{c(!0)}),[]),l=(0,s.useCallback)((()=>{c(!1)}),[]);return(0,L.jsxs)(te.c,{verbose:!1,printStack:!1,children:[(0,L.jsx)(_.c,{type:"button",className:x()("image-viewer",i),onClick:o,...a,ref:t,children:n}),(0,L.jsx)(Ie.c,{show:r,fullscreen:!0,onHide:l,className:"image-viewer-dialog",children:(0,L.jsx)(te.c,{verbose:!0,printStack:!0,children:(0,L.jsx)(Ke,{onClose:l,children:n})})})]})})),Ke=(0,s.forwardRef)(((e,t)=>{let{onClose:i,children:n,...a}=e,r="";s.Children.forEach(n,(e=>{if(!(0,s.isValidElement)(e))return;const{src:t}=e.props;r=t}));const c=r.includes("/")?r.substring(r.lastIndexOf("/")+1):r;return(0,L.jsxs)(L.Fragment,{children:[(0,L.jsxs)(Ie.c.Header,{...a,ref:t,children:[(0,L.jsx)(Ie.c.Title,{children:c}),(0,L.jsx)("a",{title:c,download:c,href:r,className:"btn btn-transparent close-button download-button","aria-label":"Download",children:(0,L.jsx)(M.c,{icon:"download",variant:"light",size:"2x"})}),(0,L.jsx)(R.S,{onClose:i})]}),(0,L.jsx)(Ie.c.Body,{children:n})]})})),qe=Pe;var Ge=i(9751);const Ue=(0,s.createContext)(null),Qe=function(){let{onError:e,onRequest:t,onRelease:i}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const[n,a]=(0,s.useState)(),r=(0,s.useRef)(null),c="undefined"!==typeof window&&"wakeLock"in navigator,o=(0,s.useCallback)((async function(){let s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"screen";const n=null!=r.current;if(c)if(n)console.warn('Calling "request" multiple times without "release" has no effect.');else try{var o;r.current=await navigator.wakeLock.request(s),r.current.onrelease=e=>{var t;a(null===(t=r.current&&r.current.released)||void 0===t||t),i&&i(e),r.current=null},null===t||void 0===t||t(),a(null!==(o=r.current&&r.current.released)&&void 0!==o&&o)}catch(l){e?e(l):console.error(null===l||void 0===l?void 0:l.message)}else console.warn('Calling the "request" function has no effect, Wake Lock Screen API isn\'t supported.')}),[c,t,e,i]),l=(0,s.useCallback)((async()=>{const e=null==r.current;c?e?console.warn("Calling `release` before `request` has no effect."):r.current&&await r.current.release():console.warn('Calling the "release" function has no effect, Wake Lock Screen API isn\'t supported.')}),[c]);return{isSupported:c,request:o,released:n,release:l,type:r.current&&r.current.type||void 0}},ze=(0,l.Os)({activate_cooking_mode_tooltip:{id:"recipe.activate_cooking_mode_tooltip",description:"Tooltip displayed when hovering the activate cooking mode button",defaultMessage:"Keep display awake."},deactivate_cooking_mode_tooltip:{id:"recipe.deactivate_cooking_mode_tooltip",description:"Tooltip displayed when hovering the deactivate cooking mode button",defaultMessage:"Release the display wake lock."}}),He=()=>{var e;const{formatMessage:t}=(0,d.c)(),{isSupported:i}=Qe(),n=(0,s.useContext)(Ue),a=null!==(e=null===n||void 0===n?void 0:n.cookingMode)&&void 0!==e&&e,r=(0,s.useCallback)((()=>{null===n||void 0===n||n.setCookingMode(!a)}),[null===n||void 0===n?void 0:n.setCookingMode,a]);return i?(0,L.jsx)(E.c,{id:"cooking-mode-toggle",variant:a?"primary":"outline-primary",onClick:r,tooltip:t(a?ze.deactivate_cooking_mode_tooltip:ze.activate_cooking_mode_tooltip),children:(0,L.jsx)(M.c,{icon:"stopwatch",variant:a?"filled":"light"})}):null},We=(0,l.Os)({edited_by:{id:"recipe.edited_by",description:"The recipe was edited by ...",defaultMessage:"Edited by"}}),Ye=e=>{let{recipe:t}=e;const{formatMessage:i,locale:s}=(0,d.c)();if(t.update_date&&new Date(t.update_date).getTime()>0&&t.update_username){const e="".concat(i(We.edited_by),": ").concat(t.update_username),n=new Date(t.update_date).toLocaleString(s),a=(0,L.jsxs)("div",{className:"d-flex-column",children:[(0,L.jsx)("div",{children:e}),(0,L.jsx)("div",{children:n})]});return(0,L.jsx)(T.c,{id:"".concat(t.id,"-editor-tooltip"),tooltip:a,children:(0,L.jsx)(M.c,{icon:"pencil",size:"1x",style:{marginLeft:"5px",marginRight:0},ariaLabel:"".concat(i(We.edited_by),": ").concat(t.update_username,". ").concat(n)})})}return null},Ve=e=>{let{recipe:t}=e;const{locale:i}=(0,d.c)();return t.update_date&&new Date(t.update_date).getTime()>0&&t.update_username===t.pub_username?(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)(M.c,{icon:"calendar"}),new Date(t.update_date).toLocaleDateString(i)]}):(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)(M.c,{icon:"calendar"}),new Date(t.pub_date).toLocaleDateString(i)]})},$e=(0,l.Os)({edit_tooltip:{id:"recipe.edit_tooltip",description:"Tooltip displayed when hovering the edit recipe icon button",defaultMessage:"Edit this recipe"},delete_tooltip:{id:"recipe.delete_tooltip",description:"Tooltip displayed when hovering the delete recipe icon button",defaultMessage:"Delete this recipe"},print_tooltip:{id:"recipe.print_tooltip",description:"Tooltip displayed when hovering the print icon button",defaultMessage:"Print this recipe"},recipe_comments:{id:"recipe.comments",description:"Button to comments",defaultMessage:"Comments"},prep_time:{id:"recipe.prep_time",description:"Preparation time",defaultMessage:"Prep time"},cooking_time:{id:"recipe.cooking_time",description:"Cooking time",defaultMessage:"Cooking time"},minutes:{id:"recipe.minutes",description:"minutes",defaultMessage:"{count, plural, one {# minute} other {# minutes}}"},source:{id:"recipe.source",description:"Source of the recipe",defaultMessage:"Source"},created_by:{id:"recipe.created_by",description:"Created by",defaultMessage:"Created by"},last_updated:{id:"recipe.last_updated",description:"Last Updated",defaultMessage:"Last Updated"},confirm_delete_title:{id:"recipe.confirm_delete_title",description:"Confirm deletion - dialog title",defaultMessage:"Confirm deletion"},confirm_delete_message:{id:"recipe.confirm_delete",description:"Are you sure you want to delete this recipe?",defaultMessage:"Are you sure you want to delete this recipe?"},confirm_delete_accept:{id:"recipe.confirm_delete_accept",description:"Confirm deletion - Accept button title",defaultMessage:"Delete"}}),Je=e=>{var t,i,n;let{recipe:a,editable:r,onEditRecipe:c,deleteRecipe:o}=e;const l=(0,d.c)(),{formatMessage:m}=l,h=(0,s.useCallback)((()=>{c()}),[c]),[v,x]=(0,s.useState)(!1),f=(0,s.useCallback)((()=>{x(!0)}),[]),b=(0,s.useCallback)((()=>{o()}),[o]),_=(0,s.useCallback)((()=>{x(!1)}),[]),j=r?(0,L.jsx)(Ge.c,{id:"edit-recipe-button",variant:"outline-primary",tooltip:m($e.edit_tooltip),to:(0,G.sL)("/recipe/edit/".concat(null===a||void 0===a?void 0:a.slug)),onClick:h,size:"sm",children:(0,L.jsx)(M.c,{icon:"pencil"})}):null,y=r?(0,L.jsx)(E.c,{id:"trash-recipe-button",variant:"outline-danger",size:"sm",onClick:f,tooltip:m($e.delete_tooltip),children:(0,L.jsx)(M.c,{icon:"trash"})}):null,C=(0,s.useMemo)((()=>{if(null!==a&&void 0!==a&&a.source){let e="";if(null!==a&&void 0!==a&&a.source&&a.source.match(/(http(s)?:\/\/.)?(www\.)?[-a-zA-Z0-9@:%._+~#=]{2,256}\.[a-z]{2,6}\b([-a-zA-Z0-9@:%_+.~#?&//=]*)/g)){const t=document.createElement("a");t.href=a.source,e=t.hostname}return(0,L.jsxs)("div",{children:["".concat(m($e.source),": "),e.length>0&&(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)("a",{href:a.source,target:"_blank",rel:"noreferrer",className:"print-hidden",children:e}),(0,L.jsx)("a",{href:a.source,target:"_blank",rel:"noreferrer",className:"print-only",children:a.source})]}),0===e.length&&a.source]})}return null}),[null===a||void 0===a?void 0:a.source]),k=(0,L.jsx)(E.c,{id:"print-recipe-button",variant:"outline-primary",onClick:window.print,tooltip:m($e.print_tooltip),children:(0,L.jsx)(M.c,{icon:"printer"})}),w=(0,L.jsx)("div",{className:"options print-hidden",children:(0,L.jsxs)(A.Y,{position:"end",children:[r&&(0,L.jsxs)(L.Fragment,{children:[j,y]}),(0,L.jsx)(He,{}),k]})}),N=null!=a?(0,L.jsxs)(L.Fragment,{children:[(0,L.jsxs)("div",{className:"recipe-header-chips",children:[null!=a.prepTime&&a.prepTime>0&&(0,L.jsxs)(De.c,{color:"secondary",children:[(0,L.jsx)(M.c,{icon:"clock"}),"".concat(m($e.prep_time),": ")," ".concat(m($e.minutes,{count:a.prepTime}))]}),null!=a.cookTime&&a.cookTime>0&&(0,L.jsxs)(De.c,{color:"secondary",children:[(0,L.jsx)(M.c,{icon:"clock"}),"".concat(m($e.cooking_time),": ")," ".concat(m($e.minutes,{count:a.cookTime}))]}),null!=a.course&&null!=a.course.title&&a.course.title.length>0&&(0,L.jsxs)(De.c,{color:"secondary",children:[(0,L.jsx)(M.c,{icon:"bar-chart"}),(0,G.$Q)(l,"course.",a.course.title)]}),null!=a.cuisine&&null!=a.cuisine.title&&a.cuisine.title.length>0&&(0,L.jsxs)(De.c,{color:"secondary",children:[(0,L.jsx)(M.c,{icon:"globe",variant:"light"}),(0,G.$Q)(l,"cuisine.",a.cuisine.title)]})]}),(0,L.jsxs)("div",{className:"recipe-header-chips",children:[(0,L.jsxs)(De.c,{color:"secondary",children:[(0,L.jsx)(Ve,{recipe:a}),(0,L.jsx)(Ye,{recipe:a})]}),(0,L.jsxs)(De.c,{color:"secondary",children:[(0,L.jsx)(M.c,{icon:"person"}),null!==(t=null===a||void 0===a?void 0:a.pub_username)&&void 0!==t?t:""]})]}),null!=a.tags&&a.tags.length>0&&(0,L.jsx)("div",{className:"recipe-header-chips",children:a.tags.map((e=>(0,L.jsx)(De.c,{color:"secondary",children:(0,G.$Q)(l,"tag.",e.title)},String(e.title))))})]}):null;return(0,L.jsxs)(L.Fragment,{children:[(0,L.jsxs)("article",{className:"recipe-header",children:[(0,L.jsx)("h1",{className:"d-block d-xl-none",children:null===a||void 0===a?void 0:a.title}),(0,L.jsxs)(u.c,{className:"flex-row-reverse justify-content-center",children:[null!=a&&a.photo&&(0,L.jsxs)(L.Fragment,{children:[(0,L.jsxs)(g.c,{xl:6,lg:12,className:"img-wrapper print-hidden",children:[(0,L.jsx)(Be.c,{height:66.67,width:100,children:(0,L.jsx)(qe,{children:(0,L.jsx)(Fe.c,{src:a.photo,alt:"",className:"img-responsive print-hidden"})})}),w]}),(0,L.jsx)(g.c,{sm:7,xs:12,className:"col-sm-push-5 print-only",children:(0,L.jsx)(Be.c,{height:66.67,width:100,className:"print-only print-image",children:(0,L.jsx)(qe,{children:(0,L.jsx)(Fe.c,{src:null!==(i=a.photoThumbnail)&&void 0!==i?i:a.photo,alt:""})})})})]}),null!=a&&!a.photo&&w,(0,L.jsxs)(g.c,{xl:6,lg:12,className:"info-wrapper",children:[(0,L.jsx)("h1",{className:"d-none d-xl-block",children:null===a||void 0===a?void 0:a.title}),(0,L.jsx)(p.c,{children:null===a||void 0===a?void 0:a.info}),(0,L.jsx)(S.c,{stars:null!==(n=null===a||void 0===a?void 0:a.rating)&&void 0!==n?n:0,showCount:!1}),N,C]})]})]}),(0,L.jsx)(R.c,{show:v,title:m($e.confirm_delete_title),acceptTitle:m($e.confirm_delete_accept),acceptButtonProps:{variant:"danger"},onAccept:b,onClose:_,className:"delete",children:m($e.confirm_delete_message)})]})};i(6504);var Ze=i(3745);const Xe=(0,l.Os)({directions:{id:"recipe.directions",description:"Directions",defaultMessage:"Directions"},no_directions:{id:"recipe.directions.no_directions",description:"No directions provided message",defaultMessage:"(This recipe has no directions.)"}}),et=e=>{let{directions:t,recipeMeta:i,ingredients:s}=e;const{formatMessage:n}=(0,d.c)(),a=i.pending,r=a===m.A.COMPLETED&&t.trim().length<=1,c=t.includes(":\n");return(0,L.jsxs)("article",{className:x()("directions-panel",{"multi-directions":c}),children:[(0,L.jsxs)("h2",{id:"directions-heading",children:[n(Xe.directions),(0,L.jsx)(H.c,{linkFor:"directions-heading"})]}),a===m.A.LOADING&&""===t&&(0,L.jsx)(oe.c,{}),r&&(0,L.jsx)(p.c,{className:"placeholder",children:n(Xe.no_directions)}),!r&&(0,L.jsx)("div",{className:"direction-groups",children:(0,L.jsx)(Ze.c,{directions:t,ingredients:s})})]})},tt=e=>{var t,i;let{recipe:s,recipeMeta:n,userId:a,editable:r,onEditRecipe:c,deleteRecipe:o}=e;return(0,L.jsxs)("div",{className:"recipe-details",children:[(0,L.jsx)(Je,{recipe:s,editable:r,onEditRecipe:c,deleteRecipe:o}),(0,L.jsx)("hr",{}),(0,L.jsxs)(u.c,{children:[(0,L.jsx)(g.c,{xl:4,lg:12,children:(0,L.jsx)(Oe,{recipe:s,recipeMeta:n,userId:a})}),(0,L.jsx)("hr",{className:"d-block d-xl-none"}),(0,L.jsx)(g.c,{xl:8,lg:12,children:(0,L.jsx)(et,{directions:null!==(t=null===s||void 0===s?void 0:s.directions)&&void 0!==t?t:"",recipeMeta:n,ingredients:null!==(i=null===s||void 0===s?void 0:s.ingredientGroups)&&void 0!==i?i:[]})})]})]})};var it=i(8836);const st=e=>{let{children:t}=e;const[i,n]=(0,s.useState)(!1),a=(0,s.useCallback)((e=>{n(e)}),[]),r=(0,s.useMemo)((()=>({cookingMode:i,setCookingMode:a})),[i]);return(0,L.jsx)(Ue.Provider,{value:r,children:t})};var nt=i(5296);const at=(0,l.Os)({activated_cooking_mode_toast:{id:"recipe.activated_cooking_mode_toast",description:"Toast displayed when activating the cooking mode button",defaultMessage:"Your display will stay awake now.\nHappy cooking!"},still_cooking_modal_title:{id:"recipe.still_cooking_modal_title",description:"Title of the modal to ask to continue keeping the display awake.",defaultMessage:"Still cooking?"},still_cooking_modal_text:{id:"recipe.still_cooking_modal_text",description:"Body text of the modal to ask to continue keeping the display awake.",defaultMessage:"Do you want to continue keeping the display awake?"},still_cooking_modal_yes:{id:"recipe.still_cooking_modal_yes",description:"Yes button.",defaultMessage:"Yes"},still_cooking_modal_no:{id:"recipe.still_cooking_modal_no",description:"no button.",defaultMessage:"No"}}),rt=()=>{var e;const{formatMessage:t}=(0,d.c)(),i=(0,s.useContext)(Ue),n=null!==(e=null===i||void 0===i?void 0:i.cookingMode)&&void 0!==e&&e;let a;const[r,c]=(0,s.useState)(!1),[o,l]=(0,s.useState)(!1),{isSupported:u,request:g,release:p,released:m}=Qe(),h=(0,nt.c)();(0,s.useEffect)((()=>{u&&n&&(h?g():!1===m&&p())}),[h]),(0,s.useEffect)((()=>{n?u&&g().then((()=>{v(),setTimeout((()=>{c(!0)}),1)})):(x(),!1===m&&p())}),[n]),(0,s.useEffect)((()=>()=>{x(!1),!1===m&&p()}),[]);const v=()=>{x(),a=setTimeout((()=>{p(),l(!0)}),18e5)},x=function(){(!(arguments.length>0&&void 0!==arguments[0])||arguments[0])&&(c(!1),l(!1)),null!=a&&(clearTimeout(a),a=void 0)},f=(0,s.useCallback)((()=>{g().then((()=>{v()}))}),[g,v]),b=(0,s.useCallback)((e=>{e||null===i||void 0===i||i.setCookingMode(!1)}),[null===i||void 0===i?void 0:i.setCookingMode]);return(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)(Ee.c,{show:n&&r,autoHide:1e4,anchorOrigin:{horizontal:"center",vertical:"bottom"},onClose:()=>c(!1),children:t(at.activated_cooking_mode_toast)}),(0,L.jsx)(R.c,{show:o,title:t(at.still_cooking_modal_title),acceptTitle:t(at.still_cooking_modal_yes),closeTitle:t(at.still_cooking_modal_no),onAccept:f,onClose:b,children:t(at.still_cooking_modal_text)})]})},ct=()=>{const e=(0,r.OY)(),t=(0,n.i6)(),i=(0,he.c)(),a=(0,r.w1)((e=>{var t;return null===(t=e.account.item)||void 0===t?void 0:t.id})),c=(0,r.w1)((e=>{var t;return null===(t=e.account.item)||void 0===t?void 0:t.role})),l=(0,r.w1)((e=>e.recipe)),d=l.item,u=l.meta,g=(0,s.useRef)(),[p,m]=(0,s.useState)(!1),h=(0,s.useCallback)((()=>{null!=d?e(it.Wm(d)):i("Invalid state: recipe may not be null")}),[d]),v=(0,s.useCallback)((()=>{null!=d?(m(!0),e(ce.Bh(d.id,d.slug))):i("Invalid state: recipe may not be null")}),[d]);return(0,s.useEffect)((()=>{null==g.current?g.current=d:p&&null!=g.current&&null==d&&t((0,G.sL)("/browser"))}),[d]),null!=d?(0,L.jsxs)(st,{children:[(0,L.jsx)(tt,{recipe:d,recipeMeta:u,userId:a,editable:d.author===a||c===o.c.STAFF||c===o.c.ADMIN,onEditRecipe:h,deleteRecipe:v}),(0,L.jsx)(rt,{})]}):(0,L.jsx)(oe.c,{message:"Loading"})},ot=()=>{var e,t,i,c;const o=(0,n.W4)(),l=(0,n.i6)(),d=(0,r.OY)(),u=(0,r.w1)((e=>e.recipe)),g=u.meta,p=o.recipe;(0,s.useEffect)((()=>{p&&d(ce.AJ(p))}),[p]),(0,s.useEffect)((()=>{404===a.c(g.error,"status")&&l((0,G.oB)("/NotFound"))}),[g.error]),(0,s.useEffect)((()=>()=>{d(ce.a_())}),[]);const h=(0,s.useMemo)((()=>(0,L.jsx)(ie,{})),[null===(e=u.item)||void 0===e?void 0:e.id,u.meta.pending]),v=(0,s.useMemo)((()=>(0,L.jsx)(re,{recipe:u.item})),[null===(t=u.item)||void 0===t?void 0:t.id,null===(i=u.item)||void 0===i?void 0:i.author]);return(0,L.jsxs)(se.c,{title:null===(c=u.item)||void 0===c?void 0:c.title,children:[(0,L.jsx)(ct,{}),u.meta.pending===m.A.COMPLETED&&h,u.meta.pending===m.A.COMPLETED&&v]})}},3988:(e,t,i)=>{i.d(t,{c:()=>R});var s=i(264),n=i.n(s),a=i(9060),r=i(3576),c=i(2496);const o=a.forwardRef(((e,t)=>{let{className:i,bsPrefix:s,as:a="div",...o}=e;return s=(0,r.Ky)(s,"card-body"),(0,c.jsx)(a,{ref:t,className:n()(i,s),...o})}));o.displayName="CardBody";const l=o,d=a.forwardRef(((e,t)=>{let{className:i,bsPrefix:s,as:a="div",...o}=e;return s=(0,r.Ky)(s,"card-footer"),(0,c.jsx)(a,{ref:t,className:n()(i,s),...o})}));d.displayName="CardFooter";const u=d;var g=i(5037);const p=a.forwardRef(((e,t)=>{let{bsPrefix:i,className:s,as:o="div",...l}=e;const d=(0,r.Ky)(i,"card-header"),u=(0,a.useMemo)((()=>({cardHeaderBsPrefix:d})),[d]);return(0,c.jsx)(g.c.Provider,{value:u,children:(0,c.jsx)(o,{ref:t,...l,className:n()(s,d)})})}));p.displayName="CardHeader";const m=p,h=a.forwardRef(((e,t)=>{let{bsPrefix:i,className:s,variant:a,as:o="img",...l}=e;const d=(0,r.Ky)(i,"card-img");return(0,c.jsx)(o,{ref:t,className:n()(a?"".concat(d,"-").concat(a):d,s),...l})}));h.displayName="CardImg";const v=h,x=a.forwardRef(((e,t)=>{let{className:i,bsPrefix:s,as:a="div",...o}=e;return s=(0,r.Ky)(s,"card-img-overlay"),(0,c.jsx)(a,{ref:t,className:n()(i,s),...o})}));x.displayName="CardImgOverlay";const f=x,b=a.forwardRef(((e,t)=>{let{className:i,bsPrefix:s,as:a="a",...o}=e;return s=(0,r.Ky)(s,"card-link"),(0,c.jsx)(a,{ref:t,className:n()(i,s),...o})}));b.displayName="CardLink";const _=b;var j=i(3024);const y=(0,j.c)("h6"),C=a.forwardRef(((e,t)=>{let{className:i,bsPrefix:s,as:a=y,...o}=e;return s=(0,r.Ky)(s,"card-subtitle"),(0,c.jsx)(a,{ref:t,className:n()(i,s),...o})}));C.displayName="CardSubtitle";const k=C,w=a.forwardRef(((e,t)=>{let{className:i,bsPrefix:s,as:a="p",...o}=e;return s=(0,r.Ky)(s,"card-text"),(0,c.jsx)(a,{ref:t,className:n()(i,s),...o})}));w.displayName="CardText";const S=w,N=(0,j.c)("h5"),M=a.forwardRef(((e,t)=>{let{className:i,bsPrefix:s,as:a=N,...o}=e;return s=(0,r.Ky)(s,"card-title"),(0,c.jsx)(a,{ref:t,className:n()(i,s),...o})}));M.displayName="CardTitle";const E=M,T=a.forwardRef(((e,t)=>{let{bsPrefix:i,className:s,bg:a,text:o,border:d,body:u=!1,children:g,as:p="div",...m}=e;const h=(0,r.Ky)(i,"card");return(0,c.jsx)(p,{ref:t,...m,className:n()(s,h,a&&"bg-".concat(a),o&&"text-".concat(o),d&&"border-".concat(d)),children:u?(0,c.jsx)(l,{children:g}):g})}));T.displayName="Card";const R=Object.assign(T,{Img:v,Title:E,Subtitle:k,Body:l,Link:_,Text:S,Header:m,Footer:u,ImgOverlay:f})},1752:(e,t,i)=>{i.d(t,{c:()=>o});var s=i(264),n=i.n(s),a=i(9060),r=i(3576),c=i(2496);const o=a.forwardRef(((e,t)=>{let{bsPrefix:i,className:s,striped:a,bordered:o,borderless:l,hover:d,size:u,variant:g,responsive:p,...m}=e;const h=(0,r.Ky)(i,"table"),v=n()(s,h,g&&"".concat(h,"-").concat(g),u&&"".concat(h,"-").concat(u),a&&"".concat(h,"-").concat("string"===typeof a?"striped-".concat(a):"striped"),o&&"".concat(h,"-bordered"),l&&"".concat(h,"-borderless"),d&&"".concat(h,"-hover")),x=(0,c.jsx)("table",{...m,className:v,ref:t});if(p){let e="".concat(h,"-responsive");return"string"===typeof p&&(e="".concat(e,"-").concat(p)),(0,c.jsx)("div",{className:e,children:x})}return x}))},4720:(e,t,i)=>{i.d(t,{c:()=>y});var s=i(9060),n=i(264),a=i.n(n),r=i(5664),c=i(8660),o=i(2451),l=i(2496);const d={[c.um]:"showing",[c.Qx]:"showing show"},u=s.forwardRef(((e,t)=>(0,l.jsx)(o.c,{...e,ref:t,transitionClasses:d})));u.displayName="ToastFade";const g=u;var p=i(2624),m=i(3576),h=i(6224);const v=s.createContext({onClose(){}}),x=s.forwardRef(((e,t)=>{let{bsPrefix:i,closeLabel:n="Close",closeVariant:r,closeButton:c=!0,className:o,children:d,...u}=e;i=(0,m.Ky)(i,"toast-header");const g=(0,s.useContext)(v),x=(0,p.c)((e=>{null==g||null==g.onClose||g.onClose(e)}));return(0,l.jsxs)("div",{ref:t,...u,className:a()(i,o),children:[d,c&&(0,l.jsx)(h.c,{"aria-label":n,variant:r,onClick:x,"data-dismiss":"toast"})]})}));x.displayName="ToastHeader";const f=x,b=s.forwardRef(((e,t)=>{let{className:i,bsPrefix:s,as:n="div",...r}=e;return s=(0,m.Ky)(s,"toast-body"),(0,l.jsx)(n,{ref:t,className:a()(i,s),...r})}));b.displayName="ToastBody";const _=b,j=s.forwardRef(((e,t)=>{let{bsPrefix:i,className:n,transition:c=g,show:o=!0,animation:d=!0,delay:u=5e3,autohide:p=!1,onClose:h,onEntered:x,onExit:f,onExiting:b,onEnter:_,onEntering:j,onExited:y,bg:C,...k}=e;i=(0,m.Ky)(i,"toast");const w=(0,s.useRef)(u),S=(0,s.useRef)(h);(0,s.useEffect)((()=>{w.current=u,S.current=h}),[u,h]);const N=(0,r.c)(),M=!(!p||!o),E=(0,s.useCallback)((()=>{M&&(null==S.current||S.current())}),[M]);(0,s.useEffect)((()=>{N.set(E,w.current)}),[N,E]);const T=(0,s.useMemo)((()=>({onClose:h})),[h]),R=!(!c||!d),A=(0,l.jsx)("div",{...k,ref:t,className:a()(i,n,C&&"bg-".concat(C),!R&&(o?"show":"hide")),role:"alert","aria-live":"assertive","aria-atomic":"true"});return(0,l.jsx)(v.Provider,{value:T,children:R&&c?(0,l.jsx)(c,{in:o,onEnter:_,onEntering:j,onEntered:x,onExit:f,onExiting:b,onExited:y,unmountOnExit:!0,children:A}):A})}));j.displayName="Toast";const y=Object.assign(j,{Body:_,Header:f})},144:()=>{}}]);
//# sourceMappingURL=976.7705fff0.chunk.js.map